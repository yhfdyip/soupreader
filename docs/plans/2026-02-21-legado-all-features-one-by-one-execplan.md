# 2026-02-21 legado 全功能逐项迁移 ExecPlan（One-by-One）

状态：`active`

## 背景与目标

### 背景
- 历史计划与进度记录已清空，需建立一份可持续执行的新主计划。
- 当前仓库已有 legado 菜单入口基线：`90` 个菜单文件、`410` 个功能入口（来源：`docs/migration/button-audit/legacy-button-ledger.md`）。
- 需求目标是“挨个处理所有功能”，因此执行粒度必须细化到单个功能入口。

### 目标
- 建立并使用统一的 410 项逐项跟踪台账，确保每个功能项都有状态与验证证据。
- 建立功能项（seq）级优先级队列，避免仅模块级排序造成执行粒度过粗。
- 在阅读域内执行“文字优先、漫画冻结”策略，先保障文字阅读链路可用性。
- 以 legado 为第一标准完成迁移级别收敛：交互路径、状态流转、边界处理、错误可观测、文案语义与菜单触发逻辑同义。
- 在单项推进过程中持续回填计划文档，避免无记录偏航。

### 范围
- 覆盖 legado `res/menu` 全量入口（410 项）及其对应业务链路。
- 覆盖 SoupReader 对应模块：主入口、搜索、发现、详情、目录、正文、书源、RSS、规则、设置及工具类入口。
- 覆盖验证证据：定向测试与手工回归路径。

### 非目标
- 不做与 legado 无关的新特性扩展。
- 不追求平台组件像素级一致（允许 Shadcn/Cupertino 与 Flutter 平台差异）。
- 非提交推送阶段不执行 `flutter analyze`。

### 成功标准
- `docs/plans/2026-02-21-legado-feature-item-tracker.csv` 中 410 项全部进入 `done`，且每项 `verify` 字段有可复现证据。
- 每个阶段（P1~P10）完成后都有阶段回归结论。
- 无未记录的偏差项；无法等价复现项必须记录为 `blocked` 并给出替代与回补计划。

## 差异点清单（执行前）

| ID | 文件位置 | 差异描述 | 原因 | 影响 |
|---|---|---|---|---|
| D-001 | `PLANS.md`（旧） | 旧计划包含多轮历史增量，缺少统一“单项执行主线” | 历史任务并行叠加 | 全量收敛路径不够直观 |
| D-002 | `docs/plans/2026-02-21-reader-density-overlay-legado-parity-execplan.md`（旧） | 聚焦阅读器 C5，无法覆盖全功能域 | 任务范围局部化 | 无法作为“所有功能逐项”总计划 |
| D-003 | 缺失文件（执行前） | 无统一 410 项逐项状态台账 | 历史上以模块清单为主 | 难以做到“挨个处理不漏项” |

## 逐项检查清单（每项必填）

1. 入口：所在页面/菜单/弹层入口是否与 legado 同义。  
2. 状态：默认/选中/禁用/加载/空态/错误是否同义。  
3. 异常：失败分支是否可观测（提示、日志、状态回退）。  
4. 文案：用户可见语义是否与 legado 同义。  
5. 排版：信息层级、间距节奏、热区触发是否同义。  
6. 交互触发：点击后路径、结果、取消/清理行为是否同义。  
7. 验证：至少一条定向验证（测试命令或手工路径）。

## 实施步骤（顺序执行）

### Step 0：重建执行基线（已完成）
- 动作：清理旧计划文件，重建主计划与逐项跟踪台账。  
- 输出：
  - `PLANS.md`
  - `docs/plans/2026-02-21-legado-feature-item-tracker.csv`
  - 本文档
- 验证：台账行数为 `411`（含表头；功能项 410）。

### Step 1：按 Phase 串行逐项推进（进行中）
- 执行顺序固定：`P1 -> P2 -> P3 -> P4 -> P5 -> P6 -> P8 -> P7 -> P10 -> P9`。
- 每个 Phase 内按功能项优先级队列推进（`priority_order`）；若同分再按 `seq` 升序（不可跳项，不可并项）。
- 用户约束（2026-02-21）：`book_manga.xml`（`seq46~63`）全部冻结为 `blocked`，不进入当前执行流。
- 用户约束（2026-02-21）：排序/文案/拷贝/日志/帮助/主题类项标记为 `detail_later`，默认后置到主功能完成后处理。
- 执行闸门（2026-02-21）：所有 `pending + detail_later` 项统一排在非 `detail_later` 的 `pending` 项之后；在前者未清零前不得启动后者。
- 每完成一项，立即更新 tracker 行状态与验证证据。

### Step 2：阶段收口
- 每个 Phase 完成时输出：
  - 已完成项数 / 阻塞项数 / 待处理项数
  - 阶段回归路径与结果
  - 差异项（若有）与回补计划

### Step 3：全量收口
- 条件：410 项全部 `done` 或已有明确 `blocked` 处置单。
- 输出：最终对照清单与风险结论。
- 提交前检查：仅执行一次 `flutter analyze`（仅在提交推送阶段）。

## 全量优先级模型（覆盖 410 项）

优先级分层：
- `S0`：核心五段链路直接相关功能（`P2 + P3`）。
- `S1`：核心链路关键依赖功能（`P4 + P5`）。
- `S2`：核心链路支撑能力（`P6 + P8`）。
- `S3`：独立业务域（`P7`）。
- `S4`：系统工具与外观收口（`P10 + P9`）。
- `HOLD`：用户冻结项（当前为漫画链路 `book_manga.xml`）。

优先级落地规则：
1. `P1` 保持 `done`，不回退。  
2. 未完成项统一按 `优先级层 -> Phase -> seq 升序` 执行。  
3. 同优先级层内不并行推进多个 Phase，避免跨域回归干扰。  
4. `HOLD` 层不执行，直到需求方明确解锁。  
5. `pending + detail_later` 统一全局后置，不在主功能链路中穿插执行。  

功能项级排序输出：
- 文件：`docs/plans/2026-02-21-legado-feature-priority-queue.csv`
- 覆盖：`410` 项（文件共 `411` 行，含表头）
- 字段：`priority_order, seq, phase, menu_file, item_id, title_zh, current_status, priority_tier, priority_score, priority_reason`
- 用法：执行时优先按 `priority_order` 取下一项；`priority_tier` 仅用于分层可视化，不替代 `priority_order`。
- 细节后置标记：`priority_reason` 含 `detail_later` 的项按“全局后置”执行（仅当主功能 `pending` 项清零后启动）。

## Phase 拆分（全量 410 项）

| Phase | 领域 | 项数 | 优先级层 | 状态 | 执行顺序 |
|---|---|---:|---|---|---:|
| P1 | 主入口与导航 | 21 | - | `done` | 1 |
| P2 | 搜索/详情/目录 | 38 | S0 | `active` | 2 |
| P3 | 阅读与朗读（文字） | 71 | S0 | `pending` | 3 |
| P3(book_manga) | 阅读与朗读（漫画） | 18 | HOLD | `blocked` | - |
| P4 | 书源管理与换源 | 85 | S1 | `pending` | 4 |
| P5 | 规则与净化 | 46 | S1 | `pending` | 5 |
| P6 | 书架/缓存/分组 | 31 | S2 | `pending` | 6 |
| P8 | 导入导出与备份 | 27 | S2 | `pending` | 7 |
| P7 | RSS | 47 | S3 | `pending` | 8 |
| P10 | 系统与工具 | 24 | S4 | `pending` | 9 |
| P9 | 主题与外观 | 2 | S4 | `pending` | 10 |

## 风险与回滚

- 风险 R1：单项数量大导致执行周期长。  
  - 缓解：Phase 串行 + 单项回填，确保中断可恢复。  
  - 回滚：按 tracker 回退到最近 `done` 项继续。

- 风险 R2：部分 legacy 行为无法在 Flutter 端完全等价。  
  - 缓解：标记 `blocked`，记录影响范围与替代方案。  
  - 回滚：不合并偏差实现，先完成确认流程。

- 风险 R3：多人并行导致同文件覆盖。  
  - 缓解：当前策略为单线串行，不启用并行分支。

- 风险 R4：验证不足导致“看似完成”。  
  - 缓解：每项必须填写 `verify`，每阶段必须有回归证据。

## 验收与证据

### 命令验证
- 逐项阶段：仅运行相关定向测试。
- 最终提交前：`flutter analyze` 执行且仅执行一次。

### 手工回归主路径
- 主入口（P1）：底栏四 Tab、重选行为、各页菜单入口。
- 核心五段链路（P2+P3）：`search -> explore -> bookInfo -> toc -> content`。
- 书源链路（P4）：源列表/编辑/登录/调试/换源。
- 规则链路（P5）：替换/字典/TXT 目录规则的入口与生效。
- 其余链路（P6~P10）：按 tracker 行逐项回归。

## Progress（动态）

- `2026-02-22`
  - 状态变更：完成 `P4-seq366`（`source_login.xml / @+id/menu_del_login_header / 删除登录头`）后，ExecPlan 保持 `active`。
  - 完成 `P4-seq366`（`source_login.xml / @+id/menu_del_login_header / 删除登录头`）：登录表单承载页“更多”菜单补齐 legado 同义“删除登录头”入口；点击后静默清理当前书源 `loginHeader_<sourceKey>` 缓存，并按书源 URL 作用域清理 Cookie，不触发保存、不跳转、不追加成功或失败提示。
  - `P4-seq366` 差异点清单（实施前）：
    - legado `SourceLoginDialog.menu_del_login_header` 点击后直接执行 `source.removeLoginHeader()`；`BaseSource.removeLoginHeader()` 同步删除 `loginHeader_<getKey()>` 缓存与该 key 对应 Cookie，属于静默状态清理动作。
    - Flutter `SourceLoginFormView` 此前“更多”菜单仅有“查看登录头”，缺少 `menu_del_login_header` 入口，无法在登录页内删除登录头缓存并清理登录态 Cookie。
  - `P4-seq366` 逐项对照清单（实施后）：
    - 入口：已同义（登录表单页“更多”菜单新增“删除登录头”）。
    - 状态：已同义（点击后删除 `loginHeader_<sourceKey>`，并按 `SourceCookieScopeResolver.resolveClearCandidates` 清理该书源 URL 作用域 Cookie）。
    - 异常：已同义（书源键为空或 Cookie 清理失败时静默返回，不追加扩展提示）。
    - 文案：已同义（动作文案固定“删除登录头”）。
    - 排版：已同义（入口承载在登录页右上角 `CupertinoActionSheet` 的“更多”层级，平台差异可接受）。
    - 交互触发：已同义（`书源管理/搜索/发现/阅读 -> 触发登录表单页 -> 右上角更多 -> 删除登录头`）。
    - 验证：手工路径 `书源管理 -> 新建或编辑任一书源 -> 右上角更多 -> 登录(表单) -> 右上角更多 -> 删除登录头 -> 查看登录头`（校验删除后“登录头”弹窗仅显示标题，且全流程无额外提示）。
  - 兼容影响：无旧书源兼容性破坏；本序号仅补齐 `menu_del_login_header` 的静默删除语义，不改动登录脚本执行、书源保存结构与其它菜单流程。
  - 下一项：按优先级继续推进 `P4-seq368`（`source_picker.xml / @+id/menu_change_source_delay / 换源间隔`；`P4-seq367` 属于 `detail_later` 后置项）。
  - 状态变更：完成 `P4-seq365`（`source_login.xml / @+id/menu_show_login_header / 查看登录头`）后，ExecPlan 保持 `active`。
  - 完成 `P4-seq365`（`source_login.xml / @+id/menu_show_login_header / 查看登录头`）：登录表单承载页补齐 legado 同义“更多 -> 查看登录头”入口；点击后按当前书源键读取登录头缓存并弹出“登录头”只读对话框，有缓存时展示原始文本并提供“复制文本”动作，无缓存时仅展示标题，不触发保存/登录/跳转副作用。
  - `P4-seq365` 差异点清单（实施前）：
    - legado `SourceLoginDialog` 在 `source_login.xml` 中提供 `menu_show_login_header`，点击后执行 `alert { title=login_header; source.getLoginHeader()?.let { setMessage(it); positiveButton(copy_text){sendToClip(it)} } }`，属于登录页内的只读查看动作。
    - Flutter `SourceLoginFormView` 之前仅有“完成”按钮，缺少与 `source_login.xml` 同层级的“查看更多动作”入口，无法在登录页内查看当前登录头缓存。
  - `P4-seq365` 逐项对照清单（实施后）：
    - 入口：已同义（登录表单页右上角补齐“更多”菜单并包含“查看登录头”）。
    - 状态：已同义（点击后弹出“登录头”对话框；有缓存展示原始文本并可复制，无缓存仅标题）。
    - 异常：已同义（书源键为空或缓存缺失时保持只读空态，不新增扩展错误提示）。
    - 文案：已同义（菜单文案“查看登录头”；对话框标题“登录头”；复制动作“复制文本”）。
    - 排版：已同义（入口位于登录表单页顶栏“更多”动作层级，承载为 `CupertinoActionSheet + CupertinoAlertDialog`，平台差异可接受）。
    - 交互触发：已同义（`书源管理/搜索/发现/阅读 -> 触发登录表单页 -> 右上角更多 -> 查看登录头`）。
    - 验证：手工路径 `书源管理 -> 新建或编辑任一书源 -> 右上角更多 -> 登录(表单) -> 右上角更多 -> 查看登录头`（校验弹窗标题“登录头”，有缓存时显示原始 JSON 且“复制文本”可写入剪贴板）；手工路径 `无登录头缓存时重复上述步骤`（校验仅显示标题且不触发额外提示）。
  - 兼容影响：无旧书源兼容性破坏；本序号仅补齐 `menu_show_login_header` 的查看与复制语义，不改动登录脚本执行、Cookie 持久化及书源保存结构。
  - 下一项：按优先级继续推进 `P4-seq366`（`source_login.xml / @+id/menu_del_login_header / 删除登录头`）。
  - 状态变更：完成 `P4-seq360`（`source_edit.xml / @+id/menu_qr_code_camera / 二维码导入`）后，ExecPlan 保持 `active`。
  - 完成 `P4-seq360`（`source_edit.xml / @+id/menu_qr_code_camera / 二维码导入`）：书源编辑页“更多”菜单收敛 legado 同义“二维码导入”动作；点击后进入扫码承载页并在识别成功后仅回填当前编辑表单，不触发保存、不重置已保存快照、不追加成功提示，对齐 legado `qrCodeResult.launch -> importSource -> upSourceView` 状态流。
  - `P4-seq360` 差异点清单（实施前）：
    - legado `BookSourceEditActivity.menu_qr_code_camera` 仅触发扫码合同 `qrCodeResult.launch()`；扫码回调成功后执行 `importSource(result) -> upSourceView(source)`，语义为“仅回填表单，不落库且不提示成功”。
    - Flutter 侧此前入口文案为“扫码导入”，且扫码导入成功后会同步更新 `_savedSource/_savedSnapshot` 并弹“已从扫码内容载入书源”，导致导入后退出不再触发未保存确认，状态边界偏离 legado。
  - `P4-seq360` 逐项对照清单（实施后）：
    - 入口：已同义（书源编辑页“更多”菜单文案收敛为“二维码导入”）。
    - 状态：已同义（扫码成功仅回填编辑表单；不触发保存，不重置已保存快照，退出时仍按未保存修改确认）。
    - 异常：已同义（扫码取消直接返回；解析失败提示沿用导入错误摘要，空摘要回落 `Error`）。
    - 文案：已同义（菜单文案“二维码导入”；扫码页标题“扫描二维码”）。
    - 排版：已同义（入口继续承载在 `CupertinoActionSheet` 的“更多”菜单层级，平台差异可接受）。
    - 交互触发：已同义（`书源管理 -> 新建/编辑书源 -> 右上角更多 -> 二维码导入`）。
    - 验证：手工路径 `书源管理 -> 新建或编辑任一书源 -> 右上角更多 -> 二维码导入 -> 扫码载入`（校验扫码成功仅回填表单且无成功提示）；手工路径 `扫码载入后直接返回上一页`（校验仍弹“存在未保存修改，确认退出吗？”）。
  - 兼容影响：无旧书源兼容性破坏；本序号仅收敛 `menu_qr_code_camera` 的入口文案与“仅回填不保存”状态边界，不改动书源导入解析器、存储结构与登录/Cookie 链路。
  - 下一项：按优先级继续推进 `P4-seq365`（`source_login.xml / @+id/menu_show_login_header / 查看登录头`）。
  - 状态变更：完成 `P4-seq354`（`source_edit.xml / @+id/menu_search / 搜索`）后，ExecPlan 保持 `active`。
  - 完成 `P4-seq354`（`source_edit.xml / @+id/menu_search / 搜索`）：书源编辑页“更多”菜单收敛 legado 同义“搜索”动作，点击后保持“先保存当前书源，再进入搜索页且范围锁定当前书源”的状态流；实现上将入口语义从“`SearchView.scoped(sourceUrls)` 间接推导范围”收敛为“先显式写入 `searchScope=SearchScope.fromSource(saved)` 再打开搜索页”，与 legado `SearchActivity(searchScope=SearchScope(source))` 对齐。
  - `P4-seq354` 差异点清单（实施前）：
    - legado `BookSourceEditActivity.menu_search` 明确执行 `save(getSource())` 成功后 `putExtra("searchScope", SearchScope(source).toString())` 跳转搜索页，scope 写入为入口侧显式行为。
    - Flutter 端此前虽然具备“先保存再跳转”主链路，但通过 `SearchView.scoped(sourceUrls)` 在搜索页内二次查库生成 scope，未在入口侧显式写入 `searchScope`，存在实现语义偏差。
  - `P4-seq354` 逐项对照清单（实施后）：
    - 入口：已同义（书源编辑页“更多”菜单保留“搜索”入口）。
    - 状态：已同义（点击“搜索”先保存；保存成功后显式写入 `searchScope` 并进入搜索页）。
    - 异常：已同义（保存失败时中断后续搜索跳转，不追加扩展提示）。
    - 文案：已同义（动作文案固定“搜索”）。
    - 排版：已同义（入口继续承载在 `CupertinoActionSheet` 的“更多”菜单层级，平台差异可接受）。
    - 交互触发：已同义（`书源管理 -> 新建/编辑书源 -> 右上角更多 -> 搜索`）。
    - 验证：手工路径 `书源管理 -> 新建或编辑任一书源 -> 修改书源名称/分组 -> 右上角更多 -> 搜索 -> 搜索页查看范围`（校验点击后先保存；进入搜索页范围显示为当前书源；返回编辑页后字段已保存）。
  - 兼容影响：无旧书源兼容性破坏；本序号仅收敛 `menu_search` 的 scope 写入触发语义，不改动搜索执行引擎、书源持久化结构与登录/Cookie 链路。
  - 下一项：按优先级继续推进 `P4-seq360`（`source_edit.xml / @+id/menu_qr_code_camera / 二维码导入`）。
  - 状态变更：完成 `P4-seq353`（`source_edit.xml / @+id/menu_login / 登录`）后，ExecPlan 保持 `active`。
  - 完成 `P4-seq353`（`source_edit.xml / @+id/menu_login / 登录`）：书源编辑页“更多”菜单收敛 legado 同义“登录”入口；入口显隐保持“仅 `loginUrl` 非空显示”，点击动作保持“先保存再进入登录承载页”，并将分流判定收敛为与 legado 一致的 `loginUi` 非空/空值双分支。
  - `P4-seq353` 差异点清单（实施前）：
    - legado `BookSourceEditActivity.onMenuOpened` 使用 `getSource().loginUrl` 控制 `menu_login` 显隐，`menu_login` 点击语义固定为 `save(getSource()) -> SourceLoginActivity`；Flutter 侧虽有对应入口，但登录承载分流依赖 `parseRows(loginUi).isNotEmpty`，与 legado 的 `loginUi.isNullOrEmpty()` 判定口径不完全一致。
    - 在 `loginUi` 非空但不可解析/空数组场景，Flutter 会回落网页登录；legado 仍进入表单登录承载并由登录页内部处理字段解析，存在状态边界偏差。
  - `P4-seq353` 逐项对照清单（实施后）：
    - 入口：已同义（书源编辑页“更多”菜单仅在 `loginUrl` 非空时显示“登录”）。
    - 状态：已同义（点击“登录”先保存，再按 `loginUi` 非空/空值分流到表单登录/网页登录承载页）。
    - 异常：已同义（保存失败中断后续登录流程；`loginUrl` 为空入口隐藏，无新增扩展提示）。
    - 文案：已同义（动作文案固定“登录”）。
    - 排版：已同义（入口维持在 `CupertinoActionSheet` 的“更多”菜单层级，平台差异可接受）。
    - 交互触发：已同义（`书源管理 -> 新建/编辑书源 -> 右上角更多 -> 登录`）。
    - 验证：手工路径 `书源管理 -> 新建或编辑任一书源 -> 填写/清空 loginUrl 与 loginUi -> 右上角更多 -> 登录`（校验 `loginUrl` 为空时入口隐藏；`loginUrl` 非空时点击先保存；`loginUi` 非空走表单承载页，空值走网页登录承载页）。
  - 兼容影响：无旧书源兼容性破坏；本序号仅收敛 `menu_login` 分流判定，不改动书源持久化结构、登录脚本执行与 Cookie 存储链路。
  - 下一项：按优先级继续推进 `P4-seq354`（`source_edit.xml / @+id/menu_search / 搜索`）。
  - 状态变更：完成 `P4-seq192`（`change_source.xml / @+id/menu_load_toc / 加载目录`）后，ExecPlan 保持 `active`。
  - 完成 `P4-seq192`（`change_source.xml / @+id/menu_load_toc / 加载目录`）：在阅读页“整书换源/单章换源”候选弹层补齐 legado 同义 `checkable` 入口“加载目录”；点击后仅切换全局开关 `changeSourceLoadToc` 并持久化，不自动刷新当前候选列表；候选刷新链路按该开关决定是否预加载目录并回填最新章节。
  - `P4-seq192` 差异点清单（实施前）：
    - legado `ChangeBookSourceDialog` 与 `ChangeChapterSourceDialog` 的 `menu_load_toc` 点击语义为“仅切换 `AppConfig.changeSourceLoadToc` + 勾选态”，不触发 `refresh/startSearch`；Flutter 候选弹层缺少同义入口。
    - Flutter 候选刷新链路此前固定为“只跑搜索候选”，无法表达 legado 的“开启加载目录后刷新候选时预加载目录信息”分支。
  - `P4-seq192` 逐项对照清单（实施后）：
    - 入口：已同义（候选弹层新增“更多 -> 加载目录”动作）。
    - 状态：已同义（点击仅翻转 `changeSourceLoadToc` 并持久化；当前候选列表保持不变）。
    - 异常：已同义（目录预加载失败按单源隔离，保留原候选结果且不追加提示）。
    - 文案：已同义（动作文案固定“加载目录”，勾选态通过 `✓` 表达）。
    - 排版：已同义（入口承载在候选弹层顶部“更多”动作内，平台差异可接受）。
    - 交互触发：已同义（`阅读页 -> 换源候选弹层 -> 更多 -> 加载目录`）。
    - 验证：手工路径 `阅读页(网络书) -> 顶部换源按钮点击或长按 -> 整书换源或单章换源 -> 候选弹层 -> 更多 -> 加载目录`（校验勾选态切换后立即持久化且不自动刷新；手动“刷新列表”后按开关决定是否预加载目录）。
  - 兼容影响：无旧书源兼容性破坏；本序号仅补齐 `menu_load_toc` 入口与候选刷新分支，不改动换源提交、目录匹配与正文替换主链路。
  - 下一项：按优先级继续推进 `P4-seq353`（`source_edit.xml / @+id/menu_login / 登录`）。
  - 状态变更：完成 `P4-seq188`（`change_source.xml / @+id/menu_refresh_list / 刷新列表`）后，ExecPlan 保持 `active`。
  - 完成 `P4-seq188`（`change_source.xml / @+id/menu_refresh_list / 刷新列表`）：在阅读页“整书换源”候选弹层补齐 legado 同义“刷新列表”动作；点击后按当前候选来源集合重新拉取候选结果并在弹层内热更新，刷新期间禁用“刷新列表/书源管理”避免并发触发，保持“刷新成功或失败均不追加提示”的状态边界。
  - `P4-seq188` 差异点清单（实施前）：
    - legado `ChangeBookSourceDialog.menu_refresh_list -> ChangeBookSourceViewModel.startRefreshList()` 是“基于当前候选列表逐项刷新”的独立动作，不等同于重新全量搜索；Flutter 候选弹层缺失该入口。
    - Flutter 候选列表此前是打开弹层时的静态快照，弹层内无法执行“刷新当前候选列表”并即时更新。
  - `P4-seq188` 逐项对照清单（实施后）：
    - 入口：已同义（整书换源候选弹层顶部新增“刷新列表”动作）。
    - 状态：已同义（点击后基于当前候选来源集合重拉结果并覆盖候选列表；不自动选中、不自动提交换源）。
    - 异常：已同义（单源刷新失败隔离处理；整体刷新失败保持当前候选列表且不弹扩展提示）。
    - 文案：已同义（动作文案固定“刷新列表”，刷新中态文案“刷新中”）。
    - 排版：已同义（动作位于候选弹层标题区，与“书源管理/取消”同层级承载，平台差异可接受）。
    - 交互触发：已同义（`阅读页(网络书) -> 顶部换源按钮长按 -> 整书换源 -> 候选弹层 -> 刷新列表`）。
    - 验证：手工路径 `阅读页(网络书) -> 顶部换源按钮长按 -> 整书换源 -> 刷新列表`（校验候选数量/内容会按当前候选来源集合刷新；刷新期间重复点击无效；无额外成功/失败提示）。
  - 兼容影响：无旧书源兼容性破坏；本序号仅补齐 `menu_refresh_list` 的候选刷新入口与弹层内状态更新，不改动整书/单章换源提交、目录匹配与正文替换链路。
  - 下一项：按优先级继续推进 `P4-seq192`（`change_source.xml / @+id/menu_load_toc / 加载目录`）。
  - 状态变更：完成 `P4-seq187`（`change_source.xml / @+id/menu_source_manage / 书源管理`）后，ExecPlan 保持 `active`。
  - 完成 `P4-seq187`（`change_source.xml / @+id/menu_source_manage / 书源管理`）：在阅读页“单章换源/整书换源”共享候选弹层补齐 legado 同义“书源管理”动作；点击后直接打开书源管理页，返回后保留候选弹层并继续换源流程，保持“仅跳转管理页、不提交换源结果”的状态边界。
  - `P4-seq187` 差异点清单（实施前）：
    - legado `change_source.xml` 同时在 `ChangeBookSourceDialog` 与 `ChangeChapterSourceDialog` 提供 `menu_source_manage`，点击动作统一 `startActivity<BookSourceActivity>()`；Flutter 候选弹层缺失该入口。
    - Flutter 端此前需先退出候选弹层再从其它入口进入书源管理，交互路径层级与 legado 不同。
  - `P4-seq187` 逐项对照清单（实施后）：
    - 入口：已同义（候选弹层顶部新增“书源管理”动作）。
    - 状态：已同义（点击后进入书源管理页；返回后候选弹层继续保留并可继续选源）。
    - 异常：已同义（跳转失败沿用现有路由异常边界，不新增扩展提示）。
    - 文案：已同义（动作文案固定“书源管理”）。
    - 排版：已同义（候选弹层标题区承载“书源管理 + 取消”动作，平台差异可接受）。
    - 交互触发：已同义（`阅读页 -> 换源 -> 候选弹层 -> 书源管理`）。
    - 验证：手工路径 `阅读页(网络书) -> 顶部换源按钮点击或长按 -> 单章换源/整书换源 -> 候选弹层 -> 书源管理 -> 返回`（校验可进入书源管理页；返回后候选弹层仍在且可继续选源）。
  - 兼容影响：无旧书源兼容性破坏；本序号仅补齐 `menu_source_manage` 的入口与路由触发，不改动换源候选匹配、目录加载与正文替换链路。
  - 下一项：按优先级继续推进 `P4-seq188`（`change_source.xml / @+id/menu_refresh_list / 刷新列表`）。
  - 状态变更：完成 `P4-seq158`（`book_source_sel.xml / @+id/menu_export_selection / 导出所选`）后，ExecPlan 保持 `active`。
  - 完成 `P4-seq158`（`book_source_sel.xml / @+id/menu_export_selection / 导出所选`）：书源管理多选菜单“导出所选”动作收敛 legado 同义边界，导出默认文件名调整为 `bookSource.json`，并将取消导出分支改为静默返回；成功分支继续展示“导出成功”路径弹窗并支持复制路径。
  - `P4-seq158` 差异点清单（实施前）：
    - legado `BookSourceActivity.menu_export_selection` 通过 `HandleFileContract.EXPORT` 固定导出名 `bookSource.json`；Flutter 端此前默认文件名是 `soupreader_sources_<timestamp>.json`，存在语义偏差。
    - legado 在 `HandleFileContract` 返回 `uri == null` 时不提示取消；Flutter 端此前会弹出“导出取消”提示，偏离 legado 静默边界。
  - `P4-seq158` 逐项对照清单（实施后）：
    - 入口：已同义（书源管理多选“更多”菜单保留“导出所选”入口并触发导出链路）。
    - 状态：已同义（导出集合维持“全选导出筛选集 / 低比例导出选中集 / 中高比例按筛选顺序过滤选中键”规则）。
    - 异常：已同义（导出失败提示错误摘要；取消导出静默返回）。
    - 文案：已同义（菜单文案“导出所选”，默认导出文件名 `bookSource.json`）。
    - 排版：已同义（继续使用 `CupertinoActionSheet` 与 `CupertinoAlertDialog` 承载，平台差异可接受）。
    - 交互触发：已同义（`书源管理 -> 多选 -> 省略号 -> 导出所选`）。
    - 验证：手工路径 `书源管理 -> 多选 -> 省略号 -> 导出所选`（校验默认文件名 `bookSource.json`；取消导出无提示；成功后显示导出路径并可复制）。
  - 兼容影响：无旧书源兼容性破坏；本序号仅收敛 `menu_export_selection` 的文件名与取消反馈边界，不改动书源解析、换源与登录流程。
  - 下一项：按优先级继续推进 `P4-seq150`（`book_source_sel.xml / @+id/menu_enable_selection / 启用所选`）。
  - 状态变更：完成 `P3-seq382`（`speak_engine_edit.xml / @+id/menu_paste_source / 粘贴源`）后，ExecPlan 保持 `active`。
  - 完成 `P3-seq382`（`speak_engine_edit.xml / @+id/menu_paste_source / 粘贴源`）：在朗读引擎编辑页“更多”菜单补齐 legado 同义“粘贴源”入口；点击后从剪贴板读取文本并按 legado 边界解析 JSON 对象/数组，成功时仅回填编辑表单（数组取首项），不自动保存、不跳转、不追加成功提示。
  - `P3-seq382` 差异点清单（实施前）：
    - legado `speak_engine_edit.xml` 已定义 `menu_paste_source`，并在 `HttpTtsEditDialog` 中绑定 `viewModel.importFromClip { initView(it) }`；Flutter 编辑页“更多”菜单缺少“粘贴源”入口。
    - legado `HttpTtsEditViewModel.importFromClip/importSource` 的关键语义是“剪贴板为空提示 `剪贴板为空`、仅接受 JSON 对象/数组、数组取首项、成功仅回填表单不落库”；Flutter 端此前缺少该状态链路。
  - `P3-seq382` 逐项对照清单（实施后）：
    - 入口：已同义（编辑页“更多”菜单新增“粘贴源”动作）。
    - 状态：已同义（粘贴成功后仅覆盖当前编辑表单字段，不触发保存与页面跳转）。
    - 异常：已同义（剪贴板为空提示“剪贴板为空”；非 JSON 对象/数组提示“格式不对”；解析异常展示错误摘要）。
    - 文案：已同义（菜单文案固定“粘贴源”，空剪贴板文案固定“剪贴板为空”）。
    - 排版：已同义（动作承载在编辑页 `CupertinoActionSheet` 的“更多”菜单中，平台差异可接受）。
    - 交互触发：已同义（`设置 -> 语音管理 -> 点击 HTTP 朗读引擎条目 -> 编辑页右上角更多 -> 粘贴源`）。
    - 验证：手工路径 `设置 -> 语音管理 -> 点击 HTTP 朗读引擎条目 -> 编辑页右上角更多 -> 粘贴源`（校验空剪贴板提示“剪贴板为空”；粘贴 JSON 对象/数组后表单被回填且未自动保存）。
  - 兼容影响：无旧书源兼容性破坏；本序号仅补齐 `speak_engine_edit/menu_paste_source` 入口与表单回填语义，不改动朗读规则存储结构、登录缓存与导入导出链路。
  - 下一项：按优先级继续推进 `P4-seq158`（`book_source_sel.xml / @+id/menu_export_selection / 导出所选`）。
  - 状态变更：完成 `P3-seq377`（`speak_engine_edit.xml / @+id/menu_save / 保存`）后，ExecPlan 保持 `active`。
  - 完成 `P3-seq377`（`speak_engine_edit.xml / @+id/menu_save / 保存`）：在朗读引擎编辑页顶栏补齐 legado 同义一级“保存”动作；点击后按当前表单显式保存 HTTP 朗读引擎规则并提示“保存成功”，保持“保存后停留编辑页、不触发登录流程”的状态流。
  - `P3-seq377` 差异点清单（实施前）：
    - legado `speak_engine_edit.xml` 定义 `menu_save` 为 `showAsAction=always`，由编辑页工具栏直接触发；Flutter 编辑页仅提供“更多”入口，缺少同层级一级“保存”动作。
    - legado `HttpTtsEditDialog.menu_save -> viewModel.save(dataFromView()) -> toastOnUi("保存成功")` 语义为“显式保存 + 成功提示 + 页面不关闭”；Flutter 端此前只有“更多->登录”会保存，缺失独立 `menu_save` 状态链路。
  - `P3-seq377` 逐项对照清单（实施后）：
    - 入口：已同义（编辑页顶栏新增一级“保存”动作，与“更多”并列）。
    - 状态：已同义（点击“保存”按当前表单落库，保存后仍停留当前编辑页）。
    - 异常：已同义（保存失败弹出 `保存失败：<错误>` 可观测提示，不触发登录/跳转）。
    - 文案：已同义（成功反馈固定“保存成功”）。
    - 排版：已同义（`保存 + 更多` 顶栏并列动作布局，对齐 legado action + overflow 结构）。
    - 交互触发：已同义（`设置 -> 语音管理 -> 点击 HTTP 朗读引擎条目 -> 编辑页右上角保存`）。
    - 验证：手工路径 `设置 -> 语音管理 -> 点击 HTTP 朗读引擎条目 -> 编辑页右上角保存`（校验保存后出现“保存成功”提示且页面不关闭；返回列表后规则内容已更新）。
  - 兼容影响：无旧书源兼容性破坏；本序号仅补齐 `speak_engine_edit/menu_save` 入口与显式保存语义，不改动导入导出格式、登录缓存与朗读执行链路。
  - 下一项：按优先级继续推进 `P3-seq382`（`speak_engine_edit.xml / @+id/menu_paste_source / 粘贴源`）。
  - 状态变更：完成 `P3-seq372`（`speak_engine.xml / @+id/menu_add / 添加`）后，ExecPlan 保持 `active`。
  - 完成 `P3-seq372`（`speak_engine.xml / @+id/menu_add / 添加`）：在语音管理页顶栏补齐 legado 同义一级“添加”入口；点击后创建空白 HTTP 朗读引擎草稿并进入编辑承载页，保持“仅进入编辑页、不自动保存”的状态流。
  - `P3-seq372` 差异点清单（实施前）：
    - legado `SpeakEngineDialog` 工具栏包含 `menu_add`（`showAsAction=always`），点击直接 `showDialogFragment<HttpTtsEditDialog>()`；Flutter 端语音管理页仅有“更多”入口，缺少同层级一级“添加”动作。
    - legado `menu_add` 只负责打开空白编辑页，不直接写库；Flutter 端缺少“新建草稿 + 打开编辑页”的独立触发链路。
  - `P3-seq372` 逐项对照清单（实施后）：
    - 入口：已同义（语音管理页右上角新增 `+` 一级入口，与 legacy action 层级一致）。
    - 状态：已同义（点击后进入空白编辑页；返回不自动新增规则，保持“未保存不落库”边界）。
    - 异常：已同义（导入/导出流程进行中禁用添加按钮，避免并发触发冲突）。
    - 文案：已同义（动作语义为“添加”；空态提示补充“添加或更多菜单导入默认规则”）。
    - 排版：已同义（顶栏 `添加 + 更多` 并列动作布局，对齐 legado “action + overflow”结构）。
    - 交互触发：已同义（`设置 -> 语音管理 -> 添加 -> 编辑朗读引擎`）。
    - 验证：手工路径 `设置 -> 语音管理 -> 右上角添加 -> 编辑朗读引擎 -> 返回`（校验可进入空白编辑页，返回后列表无自动新增项）。
  - 兼容影响：无旧书源兼容性破坏；本序号仅补齐 `speak_engine/menu_add` 入口与新建草稿跳转，不改动导入导出规则结构与朗读执行链路。
  - 下一项：按优先级继续推进 `P3-seq377`（`speak_engine_edit.xml / @+id/menu_save / 保存`）。
  - 状态变更：完成 `P3-seq256`（`keyboard_assists_config.xml / @+id/menu_add / 添加`）后，ExecPlan 保持 `active`。
  - 完成 `P3-seq256`（`keyboard_assists_config.xml / @+id/menu_add / 添加`）：在书源编辑页“编辑工具”动作面板补齐 legado 同义“辅助按键配置”入口；进入配置弹层后新增顶部“添加”动作，点击后弹出“辅助按键”双输入框（`key/value`），确认后按 `serialNo=max+1` 追加并持久化，返回编辑工具可直接点击新增项插入 `value`。
  - `P3-seq256` 差异点清单（实施前）：
    - legado `KeyboardToolPop.helpAlert` 固定将“辅助按键配置”作为一级入口，点击后进入 `KeyboardAssistsConfig`；Flutter 端 `SourceEditLegacyView` 的“编辑工具”缺失该入口。
    - legado `KeyboardAssistsConfig.menu_add -> editKey(null)` 要求“弹出 `key/value` 双输入框 + 确认后 `serialNo=max+1` 持久化”；Flutter 端缺失辅助按键配置存储与新增链路。
  - `P3-seq256` 逐项对照清单（实施后）：
    - 入口：已同义（“编辑工具”新增“辅助按键配置”入口并可打开配置弹层）。
    - 状态：已同义（点击“添加”后弹出 `key/value` 编辑框；确认后新项按 `serialNo` 追加并持久化，重新打开编辑工具可见）。
    - 异常：已同义（`key` 为空阻止保存并提示；取消不落盘）。
    - 文案：已同义（“辅助按键配置 / 辅助按键 / 添加 / 取消 / 确定 / key / value”）。
    - 排版：已同义（`CupertinoPopupSurface + CupertinoActionSheet + CupertinoAlertDialog` 承载弹层与动作，平台差异可接受）。
    - 交互触发：已同义（编辑工具 -> 辅助按键配置 -> 添加 -> 输入 key/value -> 确定；随后在编辑工具直接点击新增项插入 `value`）。
    - 验证：手工路径 `书源编辑页 -> 选中任意规则输入框 -> 右侧魔棒“编辑工具” -> 辅助按键配置 -> 添加 -> 输入 key/value -> 确定 -> 关闭 -> 再次打开编辑工具点击新增项`（校验新增项出现且可插入 value）。
  - 兼容影响：无旧书源兼容性破坏；本序号仅补齐 `keyboard_assists_config/menu_add` 的配置入口与新增持久化链路，不改动书源解析、搜索/目录/正文抓取主链路。
  - 下一项：按优先级继续推进 `P3-seq372`（`speak_engine.xml / @+id/menu_add / 添加`）。
  - 状态变更：完成 `P3-seq238`（`font_select.xml / @+id/menu_default / 默认字体`）后，ExecPlan 保持 `active`。
  - 完成 `P3-seq238`（`font_select.xml / @+id/menu_default / 默认字体`）：在阅读页“选择字体”弹层顶部补齐 legado `FontSelectDialog.menu_default` 入口；点击后弹出“系统内置字体样式”选项（系统默认字体/系统衬线字体/系统等宽字体），确认后执行“清空自定义字体路径 -> 应用系统字体 -> 关闭字体弹层”。
  - `P3-seq238` 差异点清单（实施前）：
    - legado `font_select.xml` 与 `FontSelectDialog.onMenuItemClick(menu_default)` 明确要求弹出 `system_typefaces` 三项列表；Flutter 字体弹层仅实现了“其它目录”，缺失 `menu_default` 同层入口。
    - legado 选择系统字体后执行 `AppConfig.systemTypefaces = i` 并调用 `onDefaultFontChange -> selectFont("")` 清空自定义字体，随后 `dismissAllowingStateLoss` 关闭弹层；Flutter 缺失该状态链路。
  - `P3-seq238` 逐项对照清单（实施后）：
    - 入口：已同义（字体弹层顶部新增“默认字体”入口，触发层级与 legado 一致）。
    - 状态：已同义（选择系统字体后清空自定义字体路径，并立即应用系统字体样式）。
    - 异常：已同义（取消系统字体选择时保持现状，不追加提示）。
    - 文案：已同义（入口文案固定“默认字体”；弹层标题“系统内置字体样式”；选项固定“系统默认字体/系统衬线字体/系统等宽字体”）。
    - 排版：已同义（`CupertinoButton + CupertinoActionSheet` 承载动作与选项，平台差异可接受）。
    - 交互触发：已同义（确认选项后依次完成“清空自定义字体 -> 应用系统字体 -> 关闭字体弹层”）。
    - 验证：`flutter test test/reader_top_menu_test.dart`、`flutter test test/reader_search_navigation_helper_test.dart` 通过；`flutter test test/simple_reader_view_compile_test.dart` 失败（现存编译问题：`simple_reader_view.dart:4968` 空安全报错、`reader_dict_lookup_sheet.dart:170` `SelectableText` 未定义）；手工路径 `阅读页 -> 样式弹层 -> 字体 -> 默认字体 -> 选择系统默认字体/系统衬线字体/系统等宽字体`（校验选择后弹层关闭且正文字体即时变化）。
  - 兼容影响：无旧书源兼容性破坏；本序号仅补齐 `menu_default` 系统字体选择与自定义字体清理语义，不改动书源解析、搜索/目录/正文抓取及换源链路。
  - 下一项：按优先级继续推进 `P3-seq256`（`keyboard_assists_config.xml / @+id/menu_add / 添加`）。
  - 状态变更：完成 `P3-seq212`（`content_select_action.xml / @+id/menu_share_str / 分享`）后，ExecPlan 保持 `active`。
  - 完成 `P3-seq212`（`content_select_action.xml / @+id/menu_share_str / 分享`）：在翻页阅读“文本操作”菜单补齐“分享”动作；点击后按 legado `TextActionMenu.menu_share_str -> Context.share(selectedText)` 同义调用系统文本分享。
  - `P3-seq212` 差异点清单（实施前）：
    - legado `content_select_action.xml` 已定义 `menu_share_str`，且 `TextActionMenu.onMenuItemSelected` 默认分支会执行 `context.share(callBack.selectedText)`；Flutter 端文本操作菜单缺失该入口。
    - Flutter 端尚未收敛该动作的失败边界；legado `Context.share` 采用 `runCatching` 静默吞错，不追加成功或失败提示。
  - `P3-seq212` 逐项对照清单（实施后）：
    - 入口：已同义（阅读页翻页模式长按正文后，“文本操作”菜单新增“分享”）。
    - 状态：已同义（点击后直接打开系统文本分享面板，分享内容为 `selectedText`）。
    - 异常：已同义（分享异常静默吞掉，不追加提示）。
    - 文案：已同义（动作文案固定“分享”）。
    - 排版：已同义（`CupertinoActionSheet` 承载文本动作，平台差异可接受）。
    - 交互触发：已同义（点击“分享”立即触发系统分享，不附加扩展链路）。
    - 验证：手工路径 `阅读页(翻页模式) -> 长按正文词句 -> 文本操作 -> 分享`；校验系统分享面板可打开、分享文本为选中内容，且无额外成功/失败提示。
  - 兼容影响：无旧书源兼容性破坏；本序号仅补齐 `menu_share_str` 入口与分享动作，不改动书源解析、目录抓取与正文请求主链路。
  - 下一项：按优先级继续推进 `P3-seq238`（`font_select.xml / @+id/menu_default / 默认字体`）。
  - 状态变更：完成 `P3-seq211`（`content_select_action.xml / @+id/menu_browser / 浏览器`）后，ExecPlan 保持 `active`。
  - 完成 `P3-seq211`（`content_select_action.xml / @+id/menu_browser / 浏览器`）：在翻页阅读“文本操作”菜单补齐“浏览器”动作；点击后按 legado `TextActionMenu.menu_browser` 同义分流，`selectedText` 为 `http/https` 时外部浏览器直开，非绝对网址时按关键词发起网页搜索。
  - `P3-seq211` 差异点清单（实施前）：
    - legado `content_select_action.xml` 已定义 `menu_browser`，且 `TextActionMenu.onMenuItemSelected` 要求按 `isAbsUrl` 分流 `ACTION_VIEW/ACTION_WEB_SEARCH`；Flutter 端文本操作菜单缺失该入口。
    - Flutter 端尚未收敛该动作的失败口径（异常优先展示错误消息，空消息回退 `ERROR`）。
  - `P3-seq211` 逐项对照清单（实施后）：
    - 入口：已同义（阅读页翻页模式长按正文后，“文本操作”菜单新增“浏览器”）。
    - 状态：已同义（`selectedText` 为 `http/https` 时外部浏览器直开；非绝对网址文本按关键词走网页搜索）。
    - 异常：已同义（打开失败提示 `ERROR`；抛错时优先展示错误消息，空消息回退 `ERROR`）。
    - 文案：已同义（动作文案固定“浏览器”）。
    - 排版：已同义（`CupertinoActionSheet` 承载文本动作，平台差异可接受）。
    - 交互触发：已同义（点击“浏览器”立即执行分流，不附加扩展提示分支）。
    - 验证：手工路径 `阅读页(翻页模式) -> 长按正文词句 -> 文本操作 -> 浏览器`；校验 URL 文本走外部浏览器、非 URL 文本走网页搜索，失败分支提示符合预期。
  - 兼容影响：无旧书源兼容性破坏；本序号仅补齐 `menu_browser` 入口与分流动作，不改动书源解析、目录抓取与正文请求主链路。
  - 下一项：按优先级继续推进 `P3-seq212`（`content_select_action.xml / @+id/menu_share_str / 分享`）。
  - 状态变更：完成 `P3-seq209`（`content_select_action.xml / @+id/menu_dict / 字典`）后，ExecPlan 保持 `active`。
  - 完成 `P3-seq209`（`content_select_action.xml / @+id/menu_dict / 字典`）：在翻页阅读“文本操作”菜单补齐“字典”动作；点击后按 legado 同义打开字典弹层，并以 `selectedText` 作为关键词执行词典规则查询，支持按启用规则切换后重新加载结果。
  - `P3-seq209` 差异点清单（实施前）：
    - legado `content_select_action.xml` 已定义 `menu_dict`，且 `ReadBookActivity.onMenuItemSelected` 需直接走 `showDialogFragment(DictDialog(selectedText))`；Flutter 端文本操作菜单缺失该入口。
    - Flutter 端缺失词典默认规则资产与查询承载层，无法等价复刻 legado `DictDialog` 的“规则 Tab -> 词典查询 -> 结果展示”状态流。
  - `P3-seq209` 逐项对照清单（实施后）：
    - 入口：已同义（阅读页翻页模式长按正文后，“文本操作”菜单新增“字典”）。
    - 状态：已同义（进入字典弹层默认加载首个启用规则；切换规则后重新发起查询）。
    - 异常：已同义（无选中文本时静默返回；查询失败在结果区展示错误文本，流程不中断）。
    - 文案：已同义（动作文案固定“字典”）。
    - 排版：已同义（`Cupertino` 弹层承载规则标签与查询结果，平台差异可接受）。
    - 交互触发：已同义（点击“字典”打开弹层并用 `selectedText` 查询；切换规则触发重新查询）。
    - 验证：手工路径 `阅读页(翻页模式) -> 长按正文词句 -> 文本操作 -> 字典 -> 切换规则`；校验弹层打开、首个规则自动查询、切换规则后结果刷新。
  - 兼容影响：无旧书源兼容性破坏；本序号仅补齐 `menu_dict` 入口、词典规则默认资产与词典弹层，不改动书源解析、目录抓取与正文请求主链路。
  - 下一项：按优先级继续推进 `P3-seq211`（`content_select_action.xml / @+id/menu_browser / 浏览器`）。
  - 状态变更：完成 `P3-seq208`（`content_select_action.xml / @+id/menu_aloud / 朗读`）后，ExecPlan 保持 `active`。
  - 完成 `P3-seq208`（`content_select_action.xml / @+id/menu_aloud / 朗读`）：在翻页阅读“文本操作”菜单补齐“朗读”动作；点击后按 legado 同义执行“朗读选择内容/从选择处开始一直朗读”双模式分流，长按文本操作菜单项可切换模式并持久化到 `contentSelectSpeakMod`。
  - `P3-seq208` 差异点清单（实施前）：
    - legado `content_select_action.xml` 已定义 `menu_aloud`，且 `ReadBookActivity.onMenuItemSelected` 需按 `contentSelectSpeakMod` 在“朗读选中文本 / 从选区起连续朗读”间分流；Flutter 端文本操作菜单缺失该入口。
    - Flutter 设置层缺失 `contentSelectSpeakMod` 同名键，无法等价复刻 legado 的“长按菜单项切换朗读模式并跨次保留”语义。
  - `P3-seq208` 逐项对照清单（实施后）：
    - 入口：已同义（阅读页翻页模式长按正文后，“文本操作”菜单新增“朗读”）。
    - 状态：已同义（默认模式朗读选中文本；切换后模式为“从选择处开始一直朗读”）。
    - 异常：已同义（Web 平台保持“当前平台暂不支持语音朗读”；无选中文本时静默返回）。
    - 文案：已同义（动作文案固定“朗读”；模式切换提示文案对齐 legado）。
    - 排版：已同义（`CupertinoActionSheet` 承载文本动作，平台差异可接受）。
    - 交互触发：已同义（点击“朗读”按当前模式执行；长按文本操作菜单项切换模式并持久化）。
    - 验证：手工路径 `阅读页(翻页模式) -> 长按正文词句 -> 文本操作 -> 朗读(点击/长按)`；校验点击按模式分流、长按后重进阅读页模式保持。
  - 兼容影响：无旧书源兼容性破坏；本序号仅补齐 `menu_aloud` 入口与模式持久化，不改动书源解析、目录抓取与正文请求协议。
  - 下一项：按优先级继续推进 `P3-seq209`（`content_select_action.xml / @+id/menu_dict / 字典`）。
  - 状态变更：完成 `P3-seq207`（`content_select_action.xml / @+id/menu_bookmark / 书签`）后，ExecPlan 保持 `active`。
  - 完成 `P3-seq207`（`content_select_action.xml / @+id/menu_bookmark / 书签`）：在翻页阅读“文本操作”菜单补齐“书签”动作；点击后按 legado 同义进入书签编辑弹窗，预填选中文本，取消不落库，确定后新增书签并刷新书签状态。
  - `P3-seq207` 差异点清单（实施前）：
    - legado `TextActionMenu` 已定义 `menu_bookmark`，并由 `ReadBookActivity.onMenuItemSelected` 走 `createBookmark() -> BookmarkDialog` 链路；Flutter 端文本操作菜单仅实现了 `menu_replace`，缺少同层级“书签”入口。
    - Flutter 端虽然已有阅读页书签编辑弹窗与落库链路（`_showBookmarkEditorDialog`），但未接入“长按选中文本”上下文，无法对齐 legado 的 `selectedText` 预填语义。
  - `P3-seq207` 逐项对照清单（实施后）：
    - 入口：已同义（阅读页翻页模式长按正文后，“文本操作”菜单新增“书签”）。
    - 状态：已同义（选中文本作为书签编辑弹窗的默认正文；章节标题/章节位点沿用当前阅读上下文草稿）。
    - 异常：已同义（无法构建书签草稿时提示“创建书签失败”；取消不写库）。
    - 文案：已同义（动作文案固定“书签”）。
    - 排版：已同义（`CupertinoActionSheet + CupertinoAlertDialog` 承载动作与编辑流程，平台差异可接受）。
    - 交互触发：已同义（点击“书签”进入编辑弹窗；确定后写库，取消后不写库）。
    - 验证：手工路径 `阅读页(翻页模式) -> 长按正文词句 -> 文本操作 -> 书签 -> 取消/确定`；校验取消后不新增书签、确定后目录书签页可见并可跳转。
  - 兼容影响：无旧书源兼容性破坏；本序号仅补齐文本动作菜单 `menu_bookmark` 与既有书签编辑链路的接线，不改动书源解析、目录抓取与正文请求协议。
  - 下一项：按优先级继续推进 `P3-seq208`（`content_select_action.xml / @+id/menu_aloud / 朗读`）。
  - 状态变更：`P3-seq205` 已按方案 A（先补选区基础设施）解除阻塞，ExecPlan 状态由 `blocked` 恢复为 `active`。
  - 完成 `P3-seq205`（`content_select_action.xml / @+id/menu_replace / 替换`）：补齐翻页阅读长按文本动作入口，长按正文后弹出“文本操作 -> 替换”；点击后按 legado 同义将 `selectedText` 逐行 `trim` 预填到替换规则 `pattern`，并将 `scope` 预填为 `bookName;bookSourceUrl`。
  - `P3-seq205` 差异点清单（实施前）：
    - Flutter `PagedReaderWidget` 仅支持点击分区动作，无“长按选中文本 -> 菜单动作”入口，缺失 legado `TextActionMenu` 触发前提。
    - Flutter 阅读页缺少 `menu_replace` 从 `selectedText` 跳转到替换规则编辑页的链路，无法复刻 `ReplaceEditActivity.startIntent(pattern, scope)` 语义。
  - `P3-seq205` 逐项对照清单（实施后）：
    - 入口：已同义（翻页阅读长按正文可进入文本操作菜单）。
    - 状态：已同义（按长按位置提取词级选中文本并作为本次动作上下文）。
    - 异常：已同义（无可用选中文本时静默不弹菜单；保存前不写库）。
    - 文案：已同义（动作文案固定“替换”）。
    - 排版：已同义（使用 `CupertinoActionSheet` 承载文本动作，平台差异可接受）。
    - 交互触发：已同义（`selectedText` 逐行 `trim` 后预填 `pattern`，`scope=bookName;bookSourceUrl`，保存后写入规则并刷新当前章节）。
    - 验证：手工路径 `阅读页(翻页模式) -> 长按正文词句 -> 文本操作 -> 替换 -> 保存规则`；校验默认 `pattern/scope` 预填正确且保存后正文刷新。
  - 兼容影响：无旧书源兼容性破坏；本序号仅补齐阅读页文本动作入口与 `menu_replace` 链路，不改动书源解析、目录抓取与正文请求协议。
  - 下一项：按优先级继续推进 `P3-seq207`（`content_select_action.xml / @+id/menu_bookmark / 书签`）。
  - 状态变更：ExecPlan 由 `active` 调整为 `blocked`，阻塞点为 `P3-seq205`（`content_select_action.xml / @+id/menu_replace / 替换`）。
  - `P3-seq205` 阻塞记录（差异点清单，实施前）：
    - legado `ReadBookActivity.onMenuItemSelected(menu_replace)` 的触发前提是 `TextActionMenu.selectedText` 已存在；动作会打开 `ReplaceEditActivity.startIntent(pattern=selectedText.trimLines, scope=bookName;bookSourceUrl)`。
    - Flutter 阅读正文当前实现（`paged_reader_widget.dart + simple_reader_view.dart`）为 `RichText` 分页渲染，尚无“文本选区 + 选中文本回调 + 文本操作菜单”基础设施，无法等价提供 `selectedText` 语义。
  - `P3-seq205` 阻塞记录（逐项检查）：
    - 入口：未通过（缺少选中文本菜单入口）。
    - 状态：未通过（缺少选区生命周期与菜单开闭状态流转）。
    - 异常：未通过（缺少选区取消/清理与失败可观测链路）。
    - 文案：未通过（缺少 `menu_replace` 同层级菜单承载）。
    - 排版：未通过（缺少文本操作菜单承载层）。
    - 交互触发：未通过（无法按选中文本触发替换编辑）。
  - `P3-seq205` 迁移例外记录：
    - 原因：缺失选中文本基础设施，`menu_replace` 无法按 legado 语义触发。
    - 影响范围：阻塞 `seq205`，且同文件后续依赖选区语义的 `seq206~209` 存在同类阻塞风险。
    - 替代方案：
      - A：先实现阅读页选区基础设施（选区、文本菜单、回调、清理）再迁移 `menu_replace`（推荐）。
      - B：需求方确认后采用临时降级“手动输入关键词后打开替换编辑”（非同义方案）。
    - 回补计划：待需求方确认后解除阻塞；选 A 则先补基础设施后回补 `menu_replace`；选 B 则在文档登记例外并排期补回同义链路。
  - 完成 `P3-seq204`（`content_search.xml / @+id/menu_enable_replace / 替换`）：对齐 legado `SearchContentActivity.menu_enable_replace` 的 `checkable` 语义，在阅读页全文搜索面板顶栏补齐“更多 -> 替换”入口；点击仅翻转搜索态开关，不自动重跑搜索。
  - `P3-seq204` 差异点清单（实施前）：
    - Flutter 全文搜索面板缺少 legado `content_search.xml` 对应菜单入口，无法表达“替换”勾选态。
    - Flutter 全文搜索链路固定按原始正文检索，缺少“按开关决定是否应用替换规则”的分支。
  - `P3-seq204` 逐项对照清单（实施后）：
    - 入口：已同义（全文搜索面板顶栏补齐“更多 -> 替换”入口）。
    - 状态：已同义（菜单项通过 `✓ 替换` 回显勾选态）。
    - 异常：已同义（仅本地状态切换；不新增异常提示分支）。
    - 文案：已同义（固定“替换”）。
    - 排版：已同义（`CupertinoActionSheet` 承载 checkable 入口，平台差异可接受）。
    - 交互触发：已同义（点击仅切换开关；下次搜索按“搜索替换开关 && 书籍替换净化开关”决定是否应用替换规则）。
    - 验证：手工路径 `阅读页 -> 搜索正文 -> 输入关键词搜索 -> 搜索面板顶栏更多 -> 替换 -> 再次搜索`（校验勾选态切换、切换后仅影响搜索链路）；手工路径 `阅读页 -> 搜索正文 -> 退出`（校验退出后开关恢复默认关闭）。
  - 兼容影响：无旧书源兼容性破坏；本序号仅补齐全文搜索菜单入口与搜索链路替换开关，不改动书源解析、目录与正文抓取链路。
  - 阻塞项：`seq205`（`content_select_action.xml / @+id/menu_replace / 替换`），待需求方确认方案后继续。
  - 完成 `P3-seq93`（`book_read_record.xml / @+id/menu_enable_record / 开启记录`）：对齐 legado `ReadRecordActivity.menu_enable_record` 的 `checkable` 语义，在“阅读记录”页右上角更多菜单补齐“开启记录”入口；菜单打开按 `enableReadRecord` 回显勾选，点击后仅翻转开关并持久化，不追加提示。
  - `P3-seq93` 差异点清单（实施前）：
    - Flutter “阅读记录”页缺少 legado `menu_enable_record` 入口，无法表达“开启记录”勾选态与切换动作。
    - 设置层缺少 `enableReadRecord` 同名键；阅读进度落盘始终刷新 `lastReadTime`，无法体现“关闭记录后不再累计阅读记录”的边界。
  - `P3-seq93` 逐项对照清单（实施后）：
    - 入口：已同义（阅读记录页补齐“更多 -> 开启记录”入口）。
    - 状态：已同义（菜单项按 `enableReadRecord` 显示 `✓` 勾选态）。
    - 异常：已同义（动作仅本地设置读写；未新增异常提示分支）。
    - 文案：已同义（固定“开启记录”）。
    - 排版：已同义（`CupertinoActionSheet` 承载 checkable 文案，平台差异可接受）。
    - 交互触发：已同义（点击即翻转开关并落盘，重进页面后勾选态保持）。
    - 验证：手工路径 `设置 -> 功能 & 设置 -> 阅读记录 -> 右上角更多 -> 开启记录`（校验勾选态切换与重进页面保持）；手工路径 `阅读页 -> 退出 -> 查看阅读记录列表`（校验关闭“开启记录”后仍保存章节进度但不刷新 `lastReadTime`）。
  - 兼容影响：无旧书源兼容性破坏；本序号仅补齐 `menu_enable_record` 入口与设置边界，不改动书源解析、目录与正文抓取链路。
  - 完成 `P3-seq9`（`audio_play.xml / @+id/menu_wake_lock / 音频服务唤醒锁`）：对齐 legado `AudioPlayActivity.menu_wake_lock` 的 `checkable` 语义，在阅读页“播放”菜单补齐“音频服务唤醒锁”入口；点击后仅翻转开关并持久化到 legado 同义键 `audioPlayWakeLock`，不追加成功提示。
  - `P3-seq9` 差异点清单（实施前）：
    - Flutter 播放菜单缺少 `menu_wake_lock` 入口，无法表达 legado 的 checkable 状态。
    - Flutter 设置层缺少 legado 同义键 `audioPlayWakeLock` 的读写能力，重进菜单无法恢复勾选态。
  - `P3-seq9` 逐项对照清单（实施后）：
    - 入口：已同义（播放菜单补齐“音频服务唤醒锁”动作）。
    - 状态：已同义（通过 `✓` 勾选态表达开关状态）。
    - 异常：已同义（动作仅写本地设置；未新增静默失败分支）。
    - 文案：已同义（固定“音频服务唤醒锁”）。
    - 排版：已同义（Cupertino ActionSheet 承载 checkable 文案，平台差异可接受）。
    - 交互触发：已同义（点击即翻转开关并落盘 `audioPlayWakeLock`，再次进入菜单保持状态）。
    - 验证：手工路径 `阅读页 -> 底部菜单长按朗读 -> 播放 -> 音频服务唤醒锁`（校验勾选态切换与重进保持）。
  - 兼容影响：无旧书源兼容性破坏；本序号仅补齐 `menu_wake_lock` 开关入口与持久化语义，不改动书源解析与正文链路。
  - 完成 `P3-seq380`（`speak_engine_edit.xml / @+id/menu_del_login_header / 删除登录头`）：对齐 legado `HttpTtsEditDialog.menu_del_login_header -> dataFromView().removeLoginHeader()` 语义，在 HTTP 朗读引擎编辑页“更多”菜单补齐“删除登录头”入口；点击后按当前规则 `id` 映射 `httpTts:<id>` 键删除登录头缓存，不触发保存与登录流程，也不追加成功提示。
  - 验证：手工路径 `设置 -> 语音管理 -> 点击 HTTP 朗读引擎条目 -> 编辑页右上角更多 -> 删除登录头 -> 查看登录头`（校验删除后“查看登录头”仅显示标题无缓存内容；删除动作无额外提示）。
  - 兼容影响：无旧书源兼容性破坏；本序号仅补齐 `menu_del_login_header` 的入口与缓存清理语义，不改动朗读执行链路与书源规则结构。
  - 完成 `P3-seq379`（`speak_engine_edit.xml / @+id/menu_show_login_header / 查看登录头`）：对齐 legado `HttpTtsEditDialog.menu_show_login_header` 语义，在 HTTP 朗读引擎编辑页“更多”菜单补齐“查看登录头”入口；点击后按当前规则 `id` 映射 `httpTts:<id>` 键读取登录头缓存并弹出“登录头”对话框，存在缓存时展示原始 JSON 文本，无缓存时仅显示标题；全流程不触发保存且不附加复制动作。
  - 验证：手工路径 `设置 -> 语音管理 -> 点击 HTTP 朗读引擎条目 -> 编辑页右上角更多 -> 查看登录头`（校验弹窗标题“登录头”、有缓存时展示 JSON 文本、无缓存时仅显示标题、不会触发保存与登录流程）。
  - 兼容影响：无旧书源兼容性破坏；本序号仅补齐 `menu_show_login_header` 的入口与展示语义，不改动朗读执行链路与书源规则结构。

- `2026-02-21`
  - 按“主功能绝对优先”再收紧队列：将全部 `pending + detail_later` 项统一下沉到主功能项之后，`pending` 队列中首个细节项从第 `52` 位下沉到第 `297` 位。
  - 接收约束“先主功能、细节靠后”：在优先级队列中对排序/文案/拷贝/日志/帮助/主题类项增加 `detail_later` 后置标记，并下调排序分数。
  - 接收约束“漫画相关功能先不做，先做文字阅读”：将 `book_manga.xml`（`seq46~63`，18项）标记为 `blocked` 并下沉到 `HOLD` 层；当前阅读域仅推进文字链路。
  - 按需求补齐“功能项级优先级排序”：新增 `docs/plans/2026-02-21-legado-feature-priority-queue.csv`，将全部 `410` 项下钻到 `seq` 级排序，避免仅按 Phase 粗排。
  - 按需求完成“全功能排优先级”重排：新增 `S0~S4` 全量优先级模型，覆盖 tracker 全部 `410` 项；Phase 执行顺序调整为 `P1 -> P2 -> P3 -> P4 -> P5 -> P6 -> P8 -> P7 -> P10 -> P9`。
  - 已完成 Step 0：重建计划体系与 410 项跟踪台账。
  - 当前推进：P1（主入口与导航）逐项处理中。
  - 已完成 `P1-seq257`：`main_bnv.xml / @+id/menu_bookshelf / 书架`。
  - `P1-seq257` 差异点清单（实施前）：
    - `legado MainActivity.onNavigationItemReselected` 对书架采用 `300ms` 双击窗口触发 `gotoTop`；当前 Flutter 实现为重选即触发回顶，触发阈值不一致。
  - `P1-seq257` 逐项对照清单（实施后）：
    - 入口：已同义（主底栏首项为“书架”）。
    - 状态：已同义（选中态与页面切换保持一致）。
    - 异常：已同义（无新增失败分支；不改变异常可观测路径）。
    - 文案：已同义（“书架”语义一致）。
    - 排版：已同义（Cupertino 底栏形态差异属于平台允许差异）。
    - 交互触发：已同义（改为 `300ms` 双击书架触发回顶）。
    - 验证：`flutter test test/widget_test.dart` 通过；手工路径 `启动应用 -> 底栏书架标签 -> 连续两次点击书架`。
  - 兼容影响：无旧书源兼容性影响。
  - 已完成 `P1-seq258`：`main_bnv.xml / @+id/menu_discovery / 发现`。
  - `P1-seq258` 差异点清单（实施前）：
    - `legado MainActivity.onNavigationItemReselected` 对发现采用 `300ms` 双击窗口触发 `compressExplore`；当前 Flutter 实现为重选即触发压缩，触发阈值不一致。
  - `P1-seq258` 逐项对照清单（实施后）：
    - 入口：已同义（主底栏“发现”入口与 legado 同层级）。
    - 状态：已同义（选中态切换与可见性策略一致）。
    - 异常：已同义（无新增失败分支；发现页错误提示链路不变）。
    - 文案：已同义（“发现”语义一致）。
    - 排版：已同义（Cupertino 底栏形态差异属于平台允许差异）。
    - 交互触发：已同义（改为 `300ms` 双击发现触发压缩/回顶）。
    - 验证：`flutter test test/discovery_view_compile_test.dart test/widget_test.dart` 通过；手工路径 `启动应用 -> 切换到发现 -> 连续两次点击发现标签`。
  - 兼容影响：无旧书源兼容性影响。
  - 已完成 `P1-seq259`：`main_bnv.xml / @+id/menu_rss / 订阅`。
  - `P1-seq259` 差异点清单（实施前）：
    - Flutter 底栏文案为 `RSS`，legado 菜单文案语义为“订阅”；存在用户可见语义偏差。
  - `P1-seq259` 逐项对照清单（实施后）：
    - 入口：已同义（底栏订阅入口可见性受 `showRss` 控制，与 legado `showRSS` 同义）。
    - 状态：已同义（选中态与切换路径一致）。
    - 异常：已同义（无新增失败分支）。
    - 文案：已同义（改为“订阅”）。
    - 排版：已同义（Cupertino 底栏形态差异属于平台允许差异）。
    - 交互触发：已同义（点击切换到订阅页；重选无额外动作）。
    - 验证：`flutter test test/widget_test.dart test/discovery_view_compile_test.dart test/rss_subscription_view_compile_test.dart` 通过；手工路径 `启动应用 -> 点击底栏订阅标签`。
  - 兼容影响：无旧书源兼容性影响。
  - 已完成 `P1-seq260`：`main_bnv.xml / @+id/menu_my_config / 我的`。
  - `P1-seq260` 差异点清单（实施前）：
    - 未发现语义差异；需完成逐项核验并留存证据。
  - `P1-seq260` 逐项对照清单（实施后）：
    - 入口：已同义（底栏“我的”入口与 legado 同层级）。
    - 状态：已同义（选中态与切换路径一致）。
    - 异常：已同义（无新增失败分支）。
    - 文案：已同义（“我的”语义一致）。
    - 排版：已同义（Cupertino 底栏形态差异属于平台允许差异）。
    - 交互触发：已同义（点击切换到“我的”页；重选无额外动作）。
    - 验证：`flutter test test/widget_test.dart test/discovery_view_compile_test.dart test/rss_subscription_view_compile_test.dart` 通过；手工路径 `启动应用 -> 点击底栏我的标签`。
  - 兼容影响：无旧书源兼容性影响。
  - 已完成 `P1-seq261`：`main_bookshelf.xml / @+id/menu_search / 搜索`。
  - `P1-seq261` 差异点清单（实施前）：
    - 未发现语义差异；需确认入口层级与触发路径是否保持 legado `menu_search -> SearchActivity` 同义。
  - `P1-seq261` 逐项对照清单（实施后）：
    - 入口：已同义（书架顶栏常驻搜索入口，非“更多菜单”二级入口）。
    - 状态：已同义（入口常驻可用，不受书架空态/列表态影响）。
    - 异常：已同义（无新增失败分支；导航失败仍由 Flutter 路由异常链路可观测）。
    - 文案：已同义（入口语义为“搜索”）。
    - 排版：已同义（平台图标样式差异属于 `Shadcn + Cupertino` 允许差异）。
    - 交互触发：已同义（点击搜索图标打开 `SearchView`，等价 legado 启动 `SearchActivity`）。
    - 验证：`flutter test test/widget_test.dart` 通过；手工路径 `启动应用 -> 书架顶栏搜索按钮 -> 进入搜索页`。
  - 兼容影响：无旧书源兼容性影响。
  - 已完成 `P1-seq262`：`main_bookshelf.xml / @+id/menu_update_toc / 更新目录`。
  - `P1-seq262` 差异点清单（实施前）：
    - 未发现入口层级差异；需确认“更多菜单 -> 更新目录”触发与空数据反馈是否保持 legado 同义。
  - `P1-seq262` 逐项对照清单（实施后）：
    - 入口：已同义（位于书架“更多”菜单，层级与 legado `main_bookshelf` 菜单一致）。
    - 状态：已同义（非进行中显示“更新目录”，进行中显示“更新目录（进行中）”用于可观测状态提示）。
    - 异常：已同义（无可更新网络书籍时提示“当前书架没有可更新的网络书籍”）。
    - 文案：已同义（动作语义保持“更新目录”）。
    - 排版：已同义（平台 ActionSheet 差异属于 `Shadcn + Cupertino` 允许差异）。
    - 交互触发：已同义（点击后进入目录更新链路，空书架场景走同义失败提示）。
    - 验证：`flutter test test/widget_test.dart` 通过；手工路径 `启动应用 -> 书架更多菜单 -> 更新目录`。
  - 兼容影响：无旧书源兼容性影响。
  - 已完成 `P1-seq263`：`main_bookshelf.xml / @+id/menu_add_local / 添加本地`。
  - `P1-seq263` 差异点清单（实施前）：
    - Flutter 书架更多菜单文案为“本机导入”，与 legado `book_local=添加本地` 用户可见语义不一致。
  - `P1-seq263` 逐项对照清单（实施后）：
    - 入口：已同义（位于书架“更多”菜单，层级与 legado `main_bookshelf` 菜单一致）。
    - 状态：已同义（入口常驻可点击，不依赖书架内容状态）。
    - 异常：已同义（沿用既有本地导入异常提示链路，无新增静默失败分支）。
    - 文案：已同义（由“本机导入”收敛为“添加本地”）。
    - 排版：已同义（平台 ActionSheet 差异属于 `Shadcn + Cupertino` 允许差异）。
    - 交互触发：已同义（点击后触发本地导入流程，等价 legado `menu_add_local -> ImportBookActivity` 入口语义）。
    - 验证：`flutter test test/widget_test.dart` 通过；手工路径 `启动应用 -> 书架更多菜单 -> 添加本地`。
  - 兼容影响：无旧书源兼容性影响。
  - 已完成 `P1-seq264`：`main_bookshelf.xml / @+id/menu_remote / 远程书籍`。
  - `P1-seq264` 差异点清单（实施前）：
    - Flutter 书架更多菜单文案为“远程导入”，与 legado `add_remote_book=远程书籍` 用户可见语义不一致。
    - 当前点击仅走“暂未实现”提示，未形成与 legado `menu_remote -> RemoteBookActivity` 同义的页面导航路径。
  - `P1-seq264` 逐项对照清单（实施后）：
    - 入口：已同义（位于书架“更多”菜单，层级与 legado `main_bookshelf` 菜单一致）。
    - 状态：已同义（入口常驻可点击，不依赖书架内容状态）。
    - 异常：已同义（移除静默占位提示，进入远程书籍承载页后可见当前迁移状态说明）。
    - 文案：已同义（由“远程导入”收敛为“远程书籍”）。
    - 排版：已同义（平台页面容器差异属于 `Shadcn + Cupertino` 允许差异）。
    - 交互触发：已同义（点击后进入远程书籍页，等价 legado 进入 `RemoteBookActivity` 的入口语义）。
    - 验证：`flutter test test/widget_test.dart` 通过；手工路径 `启动应用 -> 书架更多菜单 -> 远程书籍`。
  - 兼容影响：无旧书源兼容性影响；远程书籍页内菜单能力按后续 `seq101~107` 继续收敛。
  - 已完成 `P1-seq265`：`main_bookshelf.xml / @+id/menu_add_url / 添加网址`。
  - `P1-seq265` 差异点清单（实施前）：
    - Flutter 书架更多菜单文案为“URL 导入”，与 legado `add_url=添加网址` 用户可见语义不一致。
    - 当前点击仅走占位提示，缺少 legado `添加书籍网址` 输入弹窗与网址加书触发链路。
  - `P1-seq265` 逐项对照清单（实施后）：
    - 入口：已同义（位于书架“更多”菜单，层级与 legado `main_bookshelf` 菜单一致）。
    - 状态：已同义（入口常驻可点击；加书过程中展示“添加中...（计数）”，并支持取消中断与清理）。
    - 异常：已同义（未成功匹配/导入时统一反馈“添加网址失败”，与 legado 失败语义一致）。
    - 文案：已同义（由“URL 导入”收敛为“添加网址”；弹窗标题为“添加书籍网址”）。
    - 排版：已同义（Cupertino 对话框与平台输入控件差异属于 `Shadcn + Cupertino` 允许差异）。
    - 交互触发：已同义（点击后弹出 URL 输入框，确认后按 `baseUrl -> bookUrlPattern` 规则匹配书源并执行加书链路；过程支持取消）。
    - 验证：`flutter test test/widget_test.dart` 通过；手工路径 `启动应用 -> 书架更多菜单 -> 添加网址 -> 输入 URL -> 确定`。
  - 兼容影响：无旧书源兼容性影响。
  - 已完成 `P1-seq266`：`main_bookshelf.xml / @+id/menu_bookshelf_manage / 书架管理`。
  - `P1-seq266` 差异点清单（实施前）：
    - Flutter 书架更多菜单“书架管理”仅弹占位提示，缺少 legado `menu_bookshelf_manage -> BookshelfManageActivity` 页面导航路径。
  - `P1-seq266` 逐项对照清单（实施后）：
    - 入口：已同义（位于书架“更多”菜单，层级与 legado `main_bookshelf` 菜单一致）。
    - 状态：已同义（入口常驻可点击，不依赖书架内容状态）。
    - 异常：已同义（从占位提示改为页面承载，当前迁移状态可见且不静默失败）。
    - 文案：已同义（“书架管理”语义保持一致）。
    - 排版：已同义（平台页面容器差异属于 `Shadcn + Cupertino` 允许差异）。
    - 交互触发：已同义（点击后进入书架管理页，等价 legado 进入 `BookshelfManageActivity` 的入口语义）。
    - 验证：`flutter test test/widget_test.dart` 通过；手工路径 `启动应用 -> 书架更多菜单 -> 书架管理`。
  - 兼容影响：无旧书源兼容性影响；页内批量管理动作按后续对应序号逐项迁移。
  - 已完成 `P1-seq267`：`main_bookshelf.xml / @+id/menu_download / 缓存/导出`。
  - `P1-seq267` 差异点清单（实施前）：
    - Flutter 书架更多菜单文案为“缓存导出”，与 legado `cache_export=缓存/导出` 用户可见语义不一致。
    - 当前点击仅走占位提示，缺少 legado `menu_download -> CacheActivity` 页面导航路径。
  - `P1-seq267` 逐项对照清单（实施后）：
    - 入口：已同义（位于书架“更多”菜单，层级与 legado `main_bookshelf` 菜单一致）。
    - 状态：已同义（入口常驻可点击，不依赖书架内容状态）。
    - 异常：已同义（从占位提示改为页面承载，当前迁移状态可见且不静默失败）。
    - 文案：已同义（由“缓存导出”收敛为“缓存/导出”）。
    - 排版：已同义（平台页面容器差异属于 `Shadcn + Cupertino` 允许差异）。
    - 交互触发：已同义（点击后进入缓存/导出页，等价 legado 进入 `CacheActivity` 的入口语义）。
    - 验证：`flutter test test/widget_test.dart` 通过；手工路径 `启动应用 -> 书架更多菜单 -> 缓存/导出`。
  - 兼容影响：无旧书源兼容性影响；缓存下载与导出页内菜单动作按后续对应序号逐项迁移。
  - 已完成 `P1-seq268`：`main_bookshelf.xml / @+id/menu_group_manage / 分组管理`。
  - `P1-seq268` 差异点清单（实施前）：
    - Flutter 书架更多菜单“分组管理”点击后仅弹占位提示，缺少 legado `menu_group_manage -> GroupManageDialog` 的对话框层级触发语义。
  - `P1-seq268` 逐项对照清单（实施后）：
    - 入口：已同义（位于书架“更多”菜单，层级与 legado `main_bookshelf` 菜单一致）。
    - 状态：已同义（入口常驻可点击，不依赖书架内容状态）。
    - 异常：已同义（移除占位提示；改为弹窗承载并明确当前迁移状态，避免静默失败）。
    - 文案：已同义（保留“分组管理”语义，与 legado 一致）。
    - 排版：已同义（改为对话框层级承载；Cupertino 对话框视觉差异属于 `Shadcn + Cupertino` 允许差异）。
    - 交互触发：已同义（点击后弹出分组管理弹窗，等价 legado `showDialogFragment<GroupManageDialog>()` 的入口语义）。
    - 验证：`flutter test test/widget_test.dart` 通过；手工路径 `启动应用 -> 书架更多菜单 -> 分组管理 -> 弹出分组管理对话框`。
  - 兼容影响：无旧书源兼容性影响；分组新增/编辑/排序等页内动作按后续对应序号逐项迁移。
  - 已完成 `P1-seq269`：`main_bookshelf.xml / @+id/menu_bookshelf_layout / 书架布局`。
  - `P1-seq269` 差异点清单（实施前）：
    - Flutter 书架布局入口为 `ActionSheet` 即时选择，缺少 legado `configBookshelf` 的“确认式弹窗 + 统一提交”交互语义。
    - Flutter 仅支持“图墙/列表 + 4 种排序”，缺少 legado 入口内“分组样式、未读数量、最新更新时间、待更新计数、快速滚动条、5 档布局、6 档排序”配置项。
    - AppSettings 缺少 legado 对应配置字段（`bookGroupStyle/bookshelfLayout/bookshelfSort/showUnread/showLastUpdateTime/showWaitUpCount/showBookshelfFastScroller`）的持久化映射。
  - `P1-seq269` 逐项对照清单（实施后）：
    - 入口：已同义（书架“更多”菜单点击“书架布局”后进入配置弹窗）。
    - 状态：已同义（改为“取消不生效、确定统一提交”的确认式状态流转，匹配 legado `okButton/cancelButton` 语义）。
    - 异常：已同义（配置数据统一落盘；非法索引在解析时归一到合法区间，避免异常值导致 UI 崩溃）。
    - 文案：已同义（配置项采用 legado 语义：分组样式、显示未读数量、显示最新更新时间、显示待更新计数、显示快速滚动条、视图、排序）。
    - 排版：已同义（采用 `CupertinoAlertDialog` + 分区选项承载；视觉差异属于 `Shadcn + Cupertino` 平台允许差异）。
    - 交互触发：已同义（确定后应用布局索引/排序索引并刷新书架；未读/更新时间/快速滚动条/待更新计数开关即时反映在书架页表现层）。
    - 验证：`flutter test test/widget_test.dart test/app_settings_test.dart` 通过；手工路径 `启动应用 -> 书架更多菜单 -> 书架布局 -> 修改选项 -> 确定`。
  - 兼容影响：无旧书源兼容性影响；新增配置字段已兼容 legacy key 读写（`bookshelfLayout/bookshelfSort/showUnread/...`），对旧配置文件回放无破坏性。
  - 已完成 `P1-seq270`：`main_bookshelf.xml / @+id/menu_export_bookshelf / 导出书单`。
  - `P1-seq270` 差异点清单（实施前）：
    - Flutter 书架更多菜单文案为“导出书架”，与 legado `export_bookshelf=导出书单` 用户可见语义不一致。
    - Flutter 成功路径仅弹出“导出成功：路径”文案，缺少 legado `export_success` 成功弹窗中的路径可复制交互语义。
  - `P1-seq270` 逐项对照清单（实施后）：
    - 入口：已同义（位于书架“更多”菜单，层级与 legado `main_bookshelf` 菜单一致）。
    - 状态：已同义（用户取消文件保存时不提示成功；保存成功后弹出导出成功确认弹窗）。
    - 异常：已同义（导出异常统一反馈“导出书籍出错\n错误摘要”，保持可观测失败分支）。
    - 文案：已同义（由“导出书架”收敛为“导出书单”）。
    - 排版：已同义（采用 `CupertinoAlertDialog` 承载成功提示与复制动作；视觉差异属于 `Shadcn + Cupertino` 平台允许差异）。
    - 交互触发：已同义（点击后进入保存路径选择；成功后展示路径并支持“复制”，等价 legado 导出成功弹窗可复制 URI 的语义）。
    - 验证：`flutter test test/widget_test.dart` 通过；手工路径 `启动应用 -> 书架更多菜单 -> 导出书单 -> 选择保存路径 -> 导出成功弹窗 -> 点击复制`。
  - 兼容影响：无旧书源兼容性影响；导出 JSON 仍保持 legado 同义字段 `name/author/intro`。
  - 已完成 `P1-seq271`：`main_bookshelf.xml / @+id/menu_import_bookshelf / 导入书单`。
  - `P1-seq271` 差异点清单（实施前）：
    - Flutter 书架更多菜单文案为“导入书架”，与 legado `import_bookshelf=导入书单` 用户可见语义不一致。
    - Flutter 入口点击后直接选择文件，缺少 legado `importBookshelfAlert` 的 `url/json` 输入弹窗与“选择文件”并存入口。
    - Flutter 解析口径支持“文件 JSON/对象容错”，但缺少 legado 同义的 `http/https 链接 -> 拉取文本 -> 按 url/json 递归解析` 路径与“非 JSON 数组即格式不对”语义。
  - `P1-seq271` 逐项对照清单（实施后）：
    - 入口：已同义（位于书架“更多”菜单，层级与 legado `main_bookshelf` 菜单一致）。
    - 状态：已同义（点击后弹出“导入书单”对话框，支持输入框与文件选择双入口；导入过程中展示进度弹窗）。
    - 异常：已同义（空输入或非数组 JSON 统一反馈“格式不对”；URL 请求失败可见 `HTTP/网络请求失败` 错误摘要）。
    - 文案：已同义（由“导入书架”收敛为“导入书单”；输入框提示为 `url/json`）。
    - 排版：已同义（采用 `CupertinoAlertDialog` 承载输入与三按钮动作；视觉差异属于 `Shadcn + Cupertino` 平台允许差异）。
    - 交互触发：已同义（“确定”按 `url/json` 语义导入；“选择文件”仅允许 `txt/json` 并复用同一解析链路，等价 legado `okButton + neutralButton(select_file)`）。
    - 验证：`flutter test test/widget_test.dart` 通过；手工路径 `启动应用 -> 书架更多菜单 -> 导入书单 -> 输入 url/json 或点击选择文件 -> 确定进入导入流程`。
  - 兼容影响：无旧书源兼容性影响；仅调整书架入口与导入解析口径，不改变既有书源数据结构。
  - 已完成 `P1-seq272`：`main_bookshelf.xml / @+id/menu_log / 日志`。
  - `P1-seq272` 差异点清单（实施前）：
    - Flutter 书架“日志”入口跳转的是 `ExceptionLogsView` 页面，触发层级与 legado `showDialogFragment<AppLogDialog>()` 的弹层语义不一致。
    - Flutter 日志页标题为“异常日志”，与 legado 菜单动作文案“日志”存在用户可见语义偏差。
  - `P1-seq272` 逐项对照清单（实施后）：
    - 入口：已同义（位于书架“更多”菜单，层级与 legado `main_bookshelf` 菜单一致）。
    - 状态：已同义（点击后弹出“日志”对话框；日志为空时展示“暂无日志”）。
    - 异常：已同义（无新增静默失败分支；日志为空与清空后状态均可见）。
    - 文案：已同义（入口与弹层标题统一为“日志”，并提供“清空”动作）。
    - 排版：已同义（改为对话框层级承载；Cupertino 弹层视觉差异属于 `Shadcn + Cupertino` 平台允许差异）。
    - 交互触发：已同义（点击菜单弹出日志弹层；点击“清空”立即清空列表；点击含堆栈条目可打开详情弹窗）。
    - 验证：`flutter test test/widget_test.dart` 通过；手工路径 `启动应用 -> 书架更多菜单 -> 日志 -> 弹出日志对话框 -> 清空`。
  - 兼容影响：无旧书源兼容性影响；仅调整日志入口承载形态与文案语义，不变更书源链路。
  - 已完成 `P1-seq273`：`main_explore.xml / @+id/menu_group / 分组`。
  - `P1-seq273` 差异点清单（实施前）：
    - Flutter 发现页分组入口为 `OptionPickerSheet`，与 legado `main_explore/menu_group` 的工具栏动态子菜单触发形态不一致。
    - Flutter 分组排序使用默认 `sort()`，与 legado `BookSourceDao.dealGroups -> cnCompare` 的中文排序语义不一致。
    - Flutter `group:` 查询分支采用“拆分后 contains”匹配，未对齐 legado `flowGroupExplore` 的逗号边界匹配语义。
  - `P1-seq273` 逐项对照清单（实施后）：
    - 入口：已同义（发现页右上角“分组”动作保留为一级入口，点击后展示动态分组动作列表）。
    - 状态：已同义（分组为空时入口不额外弹错误提示；分组存在时可直接选择并应用筛选）。
    - 异常：已同义（无新增静默失败分支；分组筛选为空结果时保持发现页原有空列表表现）。
    - 文案：已同义（入口与动作文案均为“分组/分组名”，保持 legado 业务语义）。
    - 排版：已同义（采用 `CupertinoActionSheet` 承载动态分组动作；平台视觉差异属于 `Shadcn + Cupertino` 允许差异）。
    - 交互触发：已同义（点击分组后写入 `group:<分组>` 并即时筛选，等价 legado `setQuery(\"group:...\", true)` 触发路径；筛选匹配规则收敛为 legado `flowGroupExplore` 逗号边界语义）。
    - 验证：`flutter test test/discovery_view_compile_test.dart test/widget_test.dart` 通过；手工路径 `启动应用 -> 发现页 -> 右上角分组 -> 选择分组 -> 查询框显示 group:分组 且列表即时筛选`。
  - 兼容影响：无旧书源兼容性影响；仅收敛发现页分组入口与筛选语义。
  - 已完成 `P1-seq274`：`main_my.xml / @+id/menu_help / 帮助`。
  - `P1-seq274` 差异点清单（实施前）：
    - Flutter “我的”页未提供 `main_my/menu_help` 对应的顶栏帮助入口，触发层级与 legado `MyFragment` 右上角帮助按钮不一致。
    - Flutter 无 `appHelp` 资产与加载链路，缺失 legado `showHelp("appHelp") -> assets/web/help/md/appHelp.md` 帮助文档展示语义。
    - 现有页面未提供帮助弹层承载，无法等价 legado `TextDialog(Mode.MD)` 的“同页弹层查看帮助”交互路径。
  - `P1-seq274` 逐项对照清单（实施后）：
    - 入口：已同义（“我的”页顶栏新增右上角“帮助”动作，层级与 legado `main_my/menu_help` 一致）。
    - 状态：已同义（帮助按钮常驻可点击；加载中显示活动指示器，避免重复触发）。
    - 异常：已同义（资源加载失败时弹窗提示“帮助文档加载失败”，保持失败分支可观测）。
    - 文案：已同义（入口语义为“帮助”；弹层标题为“帮助”，文档内容来自 legado 同源 `appHelp.md`）。
    - 排版：已同义（采用 `CupertinoPopupSurface` + 可滚动正文承载长文档；平台视觉差异属于 `Shadcn + Cupertino` 允许差异）。
    - 交互触发：已同义（点击后读取 `assets/web/help/md/appHelp.md` 并弹层展示，等价 legado `showHelp("appHelp")` 触发路径）。
    - 验证：`flutter test test/widget_test.dart` 通过；手工路径 `启动应用 -> 底栏我的 -> 右上角帮助 -> 弹出帮助文档弹层`。
  - 兼容影响：无旧书源兼容性影响；仅补齐“我的”页帮助入口与本地帮助文档资产。
  - 已完成 `P1-seq275`：`main_rss.xml / @+id/menu_rss_star / 收藏`。
  - `P1-seq275` 差异点清单（实施前）：
    - tracker 中 `seq275` 仍为 `pending`，缺少可复现验证证据，无法闭环该项迁移记录。
    - 需确认 Flutter 订阅页顶栏星标入口保持 legado `menu_rss_star -> RssFavoritesActivity` 的一级触发语义。
  - `P1-seq275` 逐项对照清单（实施后）：
    - 入口：已同义（订阅页顶栏星标“收藏”入口保持一级动作层级）。
    - 状态：已同义（入口常驻可点击，不依赖订阅源列表与筛选状态）。
    - 异常：已同义（无新增静默失败分支；导航异常仍由现有路由错误链路可观测）。
    - 文案：已同义（目标承载页标题为“收藏”，与 legado 业务语义一致）。
    - 排版：已同义（顶栏动作与页面容器视觉差异属于 `Shadcn + Cupertino` 平台允许差异）。
    - 交互触发：已同义（点击星标进入收藏承载页，等价 legado 打开 `RssFavoritesActivity` 的入口语义）。
    - 验证：`flutter test test/widget_test.dart` 通过；手工路径 `启动应用 -> 底栏订阅 -> 顶栏星标收藏 -> 进入收藏页`。
  - 兼容影响：无旧书源兼容性影响；仅收敛 RSS 顶栏收藏入口，收藏页内分组/删除等动作按 `P7-seq307~309` 继续迁移。
  - 已完成 `P1-seq276`：`main_rss.xml / @+id/menu_group / 分组`。
  - `P1-seq276` 差异点清单（实施前）：
    - Flutter 订阅页“分组”入口使用通用 `OptionPickerSheet`，并额外提供 legado 无对应能力的“全部”扩展项，菜单结构与触发语义不一致。
    - 缺少 `main_rss/menu_group` 的独立可复现验证证据，tracker 仍为 `pending`。
  - `P1-seq276` 逐项对照清单（实施后）：
    - 入口：已同义（订阅页顶栏保留一级“分组”入口，层级与 legado `main_rss/menu_group` 一致）。
    - 状态：已同义（仅在存在启用分组时弹出动态分组菜单；分组为空时不引入额外提示分支）。
    - 异常：已同义（无新增静默失败分支；筛选结果为空时保持订阅页原有空态语义）。
    - 文案：已同义（移除“全部”扩展项，仅展示分组名称列表并保持 `group:<分组>` 业务语义）。
    - 排版：已同义（改为 `CupertinoActionSheet` 承载动态分组菜单；视觉差异属于 `Shadcn + Cupertino` 平台允许差异）。
    - 交互触发：已同义（点击分组后查询写入 `group:<分组>` 并即时筛选，等价 legado `searchView.setQuery(\"group:...\", true)`）。
    - 验证：`flutter test test/rss_subscription_view_group_menu_test.dart test/widget_test.dart` 通过；手工路径 `启动应用 -> 底栏订阅 -> 顶栏分组 -> 选择分组 -> 查询文案显示 group:分组 且列表按启用分组筛选`。
  - 兼容影响：无旧书源兼容性影响；仅收敛订阅页分组入口形态与筛选触发语义。
  - 已完成 `P1-seq277`：`main_rss.xml / @+id/menu_rss_config / 设置`。
  - `P1-seq277` 差异点清单（实施前）：
    - tracker 中 `seq277` 仍为 `pending`，缺少可复现验证证据，无法闭环该项迁移记录。
    - 需确认 Flutter 订阅页顶栏设置入口保持 legado `menu_rss_config -> RssSourceActivity` 的一级触发语义。
  - `P1-seq277` 逐项对照清单（实施后）：
    - 入口：已同义（订阅页顶栏“设置”入口保持一级动作层级）。
    - 状态：已同义（入口常驻可点击，不依赖订阅源列表与筛选状态）。
    - 异常：已同义（无新增静默失败分支；导航异常仍由现有路由错误链路可观测）。
    - 文案：已同义（入口语义为“设置”，与 legado 菜单动作一致）。
    - 排版：已同义（顶栏动作视觉差异属于 `Shadcn + Cupertino` 平台允许差异）。
    - 交互触发：已同义（点击设置后进入 `RssSourceManageView`，等价 legado 打开 `RssSourceActivity` 的入口语义）。
    - 验证：`flutter test test/widget_test.dart --plain-name "RSS settings action opens source manage page"`、`flutter test test/rss_subscription_view_group_menu_test.dart` 通过；手工路径 `启动应用 -> 底栏订阅 -> 顶栏设置 -> 进入订阅源管理页`。
  - 兼容影响：无旧书源兼容性影响；仅补齐 `main_rss/menu_rss_config` 的独立验证证据，不改变书源数据结构与同步链路。
  - 阶段收口：`P1` 共 `21/21` 项完成，`blocked=0`。
  - 当前推进：P2（搜索/详情/目录）逐项处理中。
  - 已完成 `P2-seq30`：`book_info.xml / @+id/menu_edit / 编辑`。
  - `P2-seq30` 差异点清单（实施前）：
    - tracker 中 `seq30` 仍为 `pending`，缺少可复现验证证据，无法闭环该项迁移记录。
    - 需确认 Flutter 详情页编辑入口可见性是否对齐 legado `BookInfoActivity.upTvBookshelf -> editMenuItem.isVisible = inBookshelf` 语义。
    - 需补充“点击编辑后进入编辑页”的页面级回归用例，避免仅凭代码阅读宣称同义。
  - `P2-seq30` 逐项对照清单（实施后）：
    - 入口：已同义（详情页顶栏保留一级编辑动作入口）。
    - 状态：已同义（仅当书籍在书架中时显示编辑入口；不在书架时隐藏，与 legado 同义）。
    - 异常：已同义（非书架书籍不会暴露编辑入口，避免误触发；既有失败提示链路保持可观测）。
    - 文案：已同义（编辑页标题与字段语义保持“编辑书籍信息/书名/作者”）。
    - 排版：已同义（顶栏图标与编辑页表单采用 `Shadcn + Cupertino` 承载，平台视觉差异属于允许范围）。
    - 交互触发：已同义（点击编辑进入 `SearchBookInfoEditView`，等价 legado `menu_edit -> BookInfoEditActivity` 触发语义，保存回写链路保持不变）。
    - 验证：`flutter test test/search_book_info_edit_helper_test.dart test/search_book_info_menu_helper_test.dart test/search_book_info_view_edit_action_test.dart` 通过；手工路径 `书架 -> 书籍详情 -> 顶栏编辑 -> 进入编辑书籍信息页`。
  - 兼容影响：无旧书源兼容性影响；仅补齐 `menu_edit` 的迁移证据与页面级回归用例，不改变书源/目录数据结构。
  - 已完成 `P2-seq31`：`book_info.xml / @+id/menu_share_it / 分享`。
  - `P2-seq31` 差异点清单（实施前）：
    - Flutter 详情页分享入口点击后进入 `SourceQrShareView` 中间页，触发路径与 legado `menu_share_it -> shareWithQr` 的“直接系统分享”语义不一致。
    - Flutter 分享载荷为定制字段集合（`name/author/sourceName/...`），未对齐 legado `bookUrl#bookJson` 拼接规则。
    - Flutter 二维码生成失败时回退为文本分享，未对齐 legado `text_too_long_qr_error` 的失败提示语义。
  - `P2-seq31` 逐项对照清单（实施后）：
    - 入口：已同义（详情页顶栏保留一级分享动作入口）。
    - 状态：已同义（点击后直接进入系统分享流程，不再经过二维码预览中间页）。
    - 异常：已同义（二维码生成失败时提示“文字太多，生成二维码失败”，与 legado `text_too_long_qr_error` 语义一致）。
    - 文案：已同义（分享主题优先使用书名；失败文案收敛为 legado 同义中文语义）。
    - 排版：已同义（分享仍由系统面板承载；平台分享面板视觉差异属于 `Shadcn + Cupertino` 允许差异）。
    - 交互触发：已同义（点击分享后生成二维码图片并调用系统分享，载荷收敛为 `bookUrl#bookJson`，等价 legado `shareWithQr("$bookUrl#$bookJson", name)`）。
    - 验证：`flutter test test/search_book_info_edit_helper_test.dart test/search_book_info_menu_helper_test.dart test/search_book_info_share_helper_test.dart test/search_book_info_view_compile_test.dart test/search_book_info_view_edit_action_test.dart` 通过；手工路径 `书架 -> 书籍详情 -> 顶栏分享 -> 系统分享面板`。
  - 兼容影响：无旧书源兼容性影响；仅收敛详情页分享入口语义与载荷格式，不变更书源解析链路。
  - 已完成 `P2-seq32`：`book_info.xml / @+id/menu_upload / 上传 WebDav`。
  - `P2-seq32` 差异点清单（实施前）：
    - Flutter 详情页更多菜单文案为“上传到远程”，与 legado `upload_to_remote=上传 WebDav` 用户可见语义不一致。
    - Flutter 确认弹窗标题/文案为“提示 + 远程 WebDav 链接已存在，是否继续上传？”，并附带远程 URL，偏离 legado `draw/sure_upload` 的固定提醒语义。
    - Flutter 上传等待态仅展示无文案的活动指示器，缺少 legado `WaitDialog("上传中.....")` 的可见状态文案。
  - `P2-seq32` 逐项对照清单（实施后）：
    - 入口：已同义（详情页“更多”菜单保留一级“上传 WebDav”动作入口）。
    - 状态：已同义（仅本地书籍显示上传入口；已有远程链接时先确认，取消则不进入上传流程）。
    - 异常：已同义（上传失败沿用错误摘要提示；取消确认不产生副作用）。
    - 文案：已同义（入口文案收敛为“上传 WebDav”；确认弹窗收敛为“提醒 / 远程webDav链接已存在，是否继续”）。
    - 排版：已同义（继续使用 `CupertinoActionSheet + CupertinoAlertDialog + CupertinoPopupSurface`；视觉差异属于 `Shadcn + Cupertino` 允许差异）。
    - 交互触发：已同义（存在远程链接时先弹确认，确认后进入上传并显示“上传中.....”等待态，等价 legado `menu_upload -> sure_upload -> upLoadBook` 状态流转）。
    - 验证：`flutter test test/search_book_info_view_upload_action_test.dart test/search_book_info_view_edit_action_test.dart test/search_book_info_menu_helper_test.dart test/search_book_info_share_helper_test.dart test/search_book_info_view_compile_test.dart` 通过；手工路径 `书架 -> 本地书籍详情 -> 右上角更多 -> 上传 WebDav -> 已有远程链接时弹确认 -> 取消`。
  - 兼容影响：无旧书源兼容性影响；仅收敛详情页上传入口文案与交互语义，不变更书源解析或目录链路。
  - 已完成 `P2-seq33`：`book_info.xml / @+id/menu_refresh / 刷新`。
  - `P2-seq33` 差异点清单（实施前）：
    - Flutter 详情页 `menu_refresh` 在书架内默认走“刷新目录”链路，本地书籍会被“缺少详情链接，无法刷新目录”直接拦截，与 legado `menu_refresh -> refreshBook()` 的统一刷新语义不一致。
    - Flutter 刷新链路缺少本地 TXT/EPUB 重解析与章节回写能力，无法对齐 legado 本地书籍刷新后“详情/目录同步更新”的状态流转。
    - 当前测试基线缺少本地刷新链路的定向验证，tracker 无法闭环该项迁移证据。
  - `P2-seq33` 逐项对照清单（实施后）：
    - 入口：已同义（详情页“更多”菜单仍保留一级“刷新”动作）。
    - 状态：已同义（书架内本地书籍走本地重解析链路；书架内网络书籍维持详情+目录刷新链路；非书架场景维持详情重载）。
    - 异常：已同义（本地路径缺失/文件不存在/不支持格式时给出可观测错误提示；网络刷新失败沿用现有可观测提示）。
    - 文案：已同义（入口文案保持“刷新”，未新增扩展入口与扩展文案）。
    - 排版：已同义（继续使用 `CupertinoActionSheet` 与既有提示弹层承载，平台视觉差异属于 `Shadcn + Cupertino` 允许差异）。
    - 交互触发：已同义（点击刷新后收敛为 legado `refreshBook` 语义：刷新详情/目录并回写书架缓存）。
    - 验证：`flutter test test/search_book_info_refresh_helper_test.dart test/search_book_info_view_upload_action_test.dart test/search_book_info_view_edit_action_test.dart test/search_book_info_menu_helper_test.dart test/search_book_info_share_helper_test.dart test/search_book_info_view_compile_test.dart` 通过；手工路径 `书架 -> 本地书籍详情 -> 右上角更多 -> 刷新`。
  - 兼容影响：无旧书源兼容性影响；新增本地刷新 helper 仅作用于详情页刷新链路，不改变既有书源规则解析接口。
  - 已完成 `P2-seq34`：`book_info.xml / @+id/menu_login / 登录`。
  - `P2-seq34` 差异点清单（实施前）：
    - tracker 中 `seq34` 仍为 `pending`，缺少可复现验证证据，无法闭环该项迁移记录。
    - 需确认 Flutter 详情页“登录”入口可见性是否严格对齐 legado `BookInfoActivity.onMenuOpened -> !bookSource.loginUrl.isNullOrBlank()` 语义。
    - 需确认点击“登录”后的分支优先级保持 legado 同义：有 `loginUi` 走表单登录，无 `loginUi` 走网页登录。
  - `P2-seq34` 逐项对照清单（实施后）：
    - 入口：已同义（详情页“更多”菜单保留一级“登录”动作入口）。
    - 状态：已同义（仅当 `bookSource.loginUrl` 非空时展示登录入口；`loginUrl` 为空即隐藏，即使 `loginUi` 非空也不展示）。
    - 异常：已同义（无书源或登录入口不可见时不会触发登录流程；保留现有可观测提示链路）。
    - 文案：已同义（入口文案为“登录”，与 legado `@string/login` 语义一致）。
    - 排版：已同义（沿用 `CupertinoActionSheet` 菜单承载；视觉差异属于 `Shadcn + Cupertino` 平台允许差异）。
    - 交互触发：已同义（点击登录时优先进入 `loginUi` 表单登录页，否则进入网页登录流程；触发语义对齐 legado `menu_login -> SourceLoginActivity(type=bookSource, key=bookSourceUrl)`）。
    - 验证：`flutter test test/search_book_info_menu_helper_test.dart test/search_book_info_view_login_action_test.dart` 通过；手工路径 `书架 -> 书籍详情 -> 右上角更多 -> 登录`（校验 `loginUrl` 为空隐藏入口、`loginUrl` 非空且 `loginUi` 存在时进入表单登录页）。
  - 兼容影响：无旧书源兼容性影响；本次仅补齐 `menu_login` 的页面级回归与台账证据，不改变书源解析与 Cookie 存储链路。
  - 已完成 `P2-seq35`：`book_info.xml / @+id/menu_top / 置顶`。
  - `P2-seq35` 差异点清单（实施前）：
    - Flutter 详情页 `menu_top` 在执行前新增了“当前书籍不在书架，无法置顶/书架记录不存在，无法置顶”的前置拦截提示，触发语义偏离 legado `menu_top -> topBook()` 的“点击即写库”路径。
    - 缺少 `menu_top` 的独立可复现验证证据，tracker 仍为 `pending`，无法闭环该项迁移记录。
  - `P2-seq35` 逐项对照清单（实施后）：
    - 入口：已同义（详情页“更多”菜单保留一级“置顶”动作入口）。
    - 状态：已同义（入口常驻可点击，不新增前置拦截弹窗分支）。
    - 异常：已同义（当书架记录缺失时静默返回，不引入扩展失败文案；保持 legado 同义无阻断语义）。
    - 文案：已同义（保留“置顶”业务语义，不新增扩展入口文案）。
    - 排版：已同义（沿用 `CupertinoActionSheet` 菜单承载；视觉差异属于 `Shadcn + Cupertino` 允许差异）。
    - 交互触发：已同义（点击后直接执行置顶写库，更新书架时间戳用于排序可见性；触发语义对齐 legado `menu_top -> topBook`）。
    - 验证：`flutter test test/search_book_info_top_helper_test.dart test/search_book_info_view_top_action_test.dart test/search_book_info_menu_helper_test.dart test/search_book_info_view_login_action_test.dart` 通过；手工路径 `书架 -> 书籍详情 -> 右上角更多 -> 置顶`（确认点击后无前置拦截，书籍置顶可见）。
  - 兼容影响：无旧书源兼容性影响；仅收敛 `menu_top` 触发语义与置顶写库测试证据，不改变书源解析与目录链路。
  - 已完成 `P2-seq36`：`book_info.xml / @+id/menu_set_source_variable / 设置源变量`。
  - `P2-seq36` 差异点清单（实施前）：
    - Flutter `SourceVariableStore.putVariable` 将空字符串视为删除，而 legado `BaseSource.setVariable(variable)` 仅在 `variable == null` 时删除，空字符串应被保留。
    - Flutter 详情页保存源变量后会额外提示“源变量已保存”，legado `BookInfoActivity.setVariable` 仅回写变量不追加成功提示，存在扩展文案偏差。
    - Flutter 源变量兜底错误文案为“书源不存在，无法设置源变量”，legado 原始文案为“书源不存在”，存在可见语义偏差。
  - `P2-seq36` 逐项对照清单（实施后）：
    - 入口：已同义（详情页“更多”菜单保留一级“设置源变量”动作入口）。
    - 状态：已同义（仅在 `bookSource` 存在时展示入口，与 legado `onMenuOpened -> menu_set_source_variable.isVisible = bookSource != null` 同义）。
    - 异常：已同义（书源缺失时提示收敛为“书源不存在”，保留可观测失败分支）。
    - 文案：已同义（入口文案“设置源变量”与注释默认文案 `源变量可在js中通过source.getVariable()获取` 保持 legado 语义）。
    - 排版：已同义（沿用 `CupertinoActionSheet + CupertinoAlertDialog` 承载输入弹窗，视觉差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（点击后读取 `sourceVariable_<bookSourceUrl>` 当前值；保存时调用 `setVariable` 同义逻辑，空字符串写入不删除，且不追加扩展成功提示）。
    - 验证：`flutter test test/source_variable_store_test.dart test/search_book_info_view_source_variable_action_test.dart` 通过；手工路径 `书架 -> 书籍详情 -> 右上角更多 -> 设置源变量 -> 清空后保存并再次打开弹窗`（确认空串可回读且无额外“已保存”提示）。
  - 兼容影响：无旧书源兼容性影响；仅收敛 `menu_set_source_variable` 的存储边界与提示文案语义，不改变书源解析/目录链路。
  - 已完成 `P2-seq37`：`book_info.xml / @+id/menu_set_book_variable / 设置书籍变量`。
  - `P2-seq37` 差异点清单（实施前）：
    - Flutter `BookVariableStore.putVariable` 将空字符串/空白字符串视为删除，而 legado `Book.putCustomVariable -> RuleDataInterface.putVariable` 仅在 `value == null` 时删除，空字符串应被保留。
    - Flutter 详情页保存书籍变量后会额外提示“书籍变量已保存”，legado `BookInfoActivity.setVariable` 仅回写变量不追加成功提示，存在扩展文案偏差。
    - Flutter 书籍变量兜底错误文案为“书源不存在，无法设置书籍变量”，legado 原始文案为“书源不存在”，存在可见语义偏差。
  - `P2-seq37` 逐项对照清单（实施后）：
    - 入口：已同义（详情页“更多”菜单保留一级“设置书籍变量”动作入口）。
    - 状态：已同义（仅在 `bookSource` 存在时展示入口，与 legado `onMenuOpened -> menu_set_book_variable.isVisible = bookSource != null` 同义）。
    - 异常：已同义（书源缺失时提示收敛为“书源不存在”；书籍链接缺失时静默返回，不引入扩展失败文案）。
    - 文案：已同义（入口文案“设置书籍变量”与注释默认文案 `书籍变量可在js中通过book.getVariable("custom")获取` 保持 legado 语义）。
    - 排版：已同义（沿用 `CupertinoActionSheet + CupertinoAlertDialog` 承载输入弹窗，视觉差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（点击后读取 `bookVariable_<bookUrl>` 当前值；保存时调用 `setVariable` 同义逻辑，空字符串写入不删除，且不追加扩展成功提示）。
    - 验证：`flutter test test/book_variable_store_test.dart test/search_book_info_view_book_variable_action_test.dart` 通过；手工路径 `书架 -> 书籍详情 -> 右上角更多 -> 设置书籍变量 -> 清空后保存并再次打开弹窗`（确认空串可回读且无额外“已保存”提示）。
  - 兼容影响：无旧书源兼容性影响；仅收敛 `menu_set_book_variable` 的存储边界与提示文案语义，不改变书源解析/目录链路。
  - 已完成 `P2-seq38`：`book_info.xml / @+id/menu_copy_book_url / 拷贝书籍 URL`。
  - `P2-seq38` 差异点清单（实施前）：
    - Flutter 详情页菜单文案为“复制书籍链接”，与 legado `copy_book_url=拷贝书籍 URL` 存在用户可见语义偏差。
    - Flutter 成功提示为“已复制书籍链接”且 `bookUrl` 为空时提示“当前书籍链接为空”，而 legado `menu_copy_book_url -> sendToClip(bookUrl)` 统一反馈“复制完成”，空字符串也按复制链路执行。
  - `P2-seq38` 逐项对照清单（实施后）：
    - 入口：已同义（详情页“更多”菜单保留一级“拷贝书籍 URL”动作入口）。
    - 状态：已同义（入口常驻可点击，不依赖书架/非书架状态切换）。
    - 异常：已同义（复制流程不新增扩展失败文案；空字符串场景按 legado 语义走复制完成链路）。
    - 文案：已同义（菜单文案收敛为“拷贝书籍 URL”，复制反馈收敛为“复制完成”）。
    - 排版：已同义（沿用 `CupertinoActionSheet` 菜单承载与现有提示弹窗，视觉差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（点击后将 `_resolveBookUrl()` 结果写入剪贴板，包含空字符串场景，不再拦截为“链接为空”）。
    - 验证：`flutter test test/search_book_info_view_copy_book_url_action_test.dart test/search_book_info_view_compile_test.dart` 通过；手工路径 `书架 -> 书籍详情 -> 右上角更多 -> 拷贝书籍 URL`（确认剪贴板已更新且反馈“复制完成”）。
  - 兼容影响：无旧书源兼容性影响；仅收敛 `menu_copy_book_url` 的菜单文案与复制反馈语义，不影响书源解析与目录链路。
  - 已完成 `P2-seq39`：`book_info.xml / @+id/menu_copy_toc_url / 拷贝目录 URL`。
  - `P2-seq39` 差异点清单（实施前）：
    - Flutter 详情页菜单文案为“复制目录链接”，与 legado `copy_toc_url=拷贝目录 URL` 存在用户可见语义偏差。
    - Flutter `tocUrl` 为空时会提示“当前目录链接为空”并中断复制，成功提示为“已复制目录链接”；而 legado `menu_copy_toc_url -> sendToClip(tocUrl)` 不做空值拦截，统一反馈“复制完成”。
  - `P2-seq39` 逐项对照清单（实施后）：
    - 入口：已同义（详情页“更多”菜单保留一级“拷贝目录 URL”动作入口）。
    - 状态：已同义（入口常驻可点击，不依赖书架/非书架状态切换）。
    - 异常：已同义（复制流程不再追加“目录链接为空”扩展提示；空字符串场景按 legado 语义走复制完成链路）。
    - 文案：已同义（菜单文案收敛为“拷贝目录 URL”，复制反馈收敛为“复制完成”）。
    - 排版：已同义（沿用 `CupertinoActionSheet` 菜单承载与现有提示弹窗，视觉差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（点击后将 `_resolveTocUrl()` 结果写入剪贴板，包含空字符串场景，不再拦截）。
    - 验证：`flutter test test/search_book_info_view_copy_toc_url_action_test.dart test/search_book_info_view_copy_book_url_action_test.dart` 通过；手工路径 `书架 -> 书籍详情 -> 右上角更多 -> 拷贝目录 URL`（确认剪贴板已更新且反馈“复制完成”）。
  - 兼容影响：无旧书源兼容性影响；仅收敛 `menu_copy_toc_url` 的菜单文案与复制反馈语义，不影响书源解析与目录链路。
  - 已完成 `P2-seq40`：`book_info.xml / @+id/menu_can_update / 允许更新`。
  - `P2-seq40` 差异点清单（实施前）：
    - Flutter 详情页将该菜单实现为“允许更新：开/关”文案，并在切换后弹出“已开启/已关闭允许更新”提示；legado 为 `checkable` 菜单项，标题固定“允许更新”，点击只切换状态不追加成功提示。
    - Flutter 菜单缺少勾选标记语义，无法对齐 legado `onMenuOpened -> menu_can_update.isChecked = book.canUpdate` 的可视状态反馈。
  - `P2-seq40` 逐项对照清单（实施后）：
    - 入口：已同义（详情页“更多”菜单保留一级“允许更新”动作入口，仅在存在书源时可见）。
    - 状态：已同义（标题固定“允许更新”，开启时展示勾选标记，关闭时移除勾选标记；对齐 legado checkable 菜单语义）。
    - 异常：已同义（不新增扩展失败分支；切换后不弹“已开启/已关闭”提示，保持 legado 同义静默切换）。
    - 文案：已同义（移除“允许更新：开/关”扩展文案，收敛为固定“允许更新”）。
    - 排版：已同义（沿用 `CupertinoActionSheet`，以勾选图标表达 checkable 状态；视觉差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（点击切换 `_allowUpdate`，并保持 legado 边界：仅在书架内书籍且 `bookId` 有效时持久化写入）。
    - 验证：`flutter test test/search_book_info_view_allow_update_action_test.dart test/search_book_info_view_compile_test.dart` 通过；手工路径 `书架 -> 书籍详情 -> 右上角更多 -> 允许更新 -> 重新打开更多菜单`（确认勾选态随开关变化且无扩展提示）。
  - 兼容影响：无旧书源兼容性影响；仅收敛 `menu_can_update` 的展示与提示语义，不改变目录更新筛选逻辑。
  - 已完成 `P2-seq41`：`book_info.xml / @+id/menu_split_long_chapter / 拆分超长章节`。
  - `P2-seq41` 差异点清单（实施前）：
    - Flutter 详情页切换“分割长章节”仅保存设置并重载上下文，未确保本地 TXT 章节缓存即时重解析；与 legado `menu_split_long_chapter -> loadBookInfo` 的“切换即生效”语义不一致。
    - `TxtParser.reparseFromFile` 之前未接收 `splitLongChapter` 参数，解析层无法感知开关状态，导致“开/关”无法驱动长正文拆分策略。
    - Reader 与详情页虽共享同一设置项，但重解析调用未显式传递开关，存在“状态已改、解析未跟随”的语义漂移风险。
  - `P2-seq41` 逐项对照清单（实施后）：
    - 入口：已同义（仅本地 TXT 书籍在详情页“更多”菜单显示“分割长章节”）。
    - 状态：已同义（切换后立即刷新本地章节缓存；成功后展示“已开启/已关闭”提示，关闭分支保留“重新加载可能更慢”文案）。
    - 异常：已同义（重解析失败时保留可观测错误提示，并避免误报成功提示）。
    - 文案：已同义（菜单标题与提示语义保持 legado `split_long_chapter` 业务语义）。
    - 排版：已同义（沿用 `CupertinoActionSheet` 与勾选图标表达开关状态，平台视觉差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（保存设置后详情页强制触发本地重解析并回写 `ChapterRepository/BookRepository`；Reader 侧重解析同样传入开关，确保同一 `bookId` 行为一致）。
    - 验证：`flutter test test/txt_parser_charset_override_test.dart test/search_book_info_refresh_helper_test.dart test/search_book_info_view_compile_test.dart test/simple_reader_view_compile_test.dart` 通过；手工路径 `书架 -> 打开本地 TXT 详情 -> 更多 -> 分割长章节 -> 切换后进入目录确认章节即时变化`。
  - 兼容影响：无旧书源兼容性影响；仅收敛本地 TXT 的 `menu_split_long_chapter` 开关传递与即时重解析路径，不改变网络书籍目录链路。
  - 已完成 `P2-seq42`：`book_info.xml / @+id/menu_delete_alert / 删除提醒`。
  - `P2-seq42` 差异点清单（实施前）：
    - Flutter 详情页将该菜单实现为“删除提醒：开/关”文案，legado 为 `checkable` 菜单项，标题固定“删除提醒”并通过勾选态表达状态，存在状态表达偏差。
    - Flutter 切换“删除提醒”后会弹“已开启/已关闭删除提醒”扩展提示；legado 仅切换持久化状态，不追加成功提示。
  - `P2-seq42` 逐项对照清单（实施后）：
    - 入口：已同义（详情页“更多”菜单保留一级“删除提醒”动作入口）。
    - 状态：已同义（标题固定“删除提醒”，开启时展示勾选标记，关闭时移除勾选标记；默认值与持久化均对齐 `bookInfoDeleteAlert`）。
    - 异常：已同义（`SettingsService` 不可用时仅回退会话内状态，不新增崩溃与静默失败分支）。
    - 文案：已同义（移除“删除提醒：开/关”与“已开启/已关闭删除提醒”扩展文案，收敛为 legado checkable 语义）。
    - 排版：已同义（沿用 `CupertinoActionSheet` 并以勾选图标表达 checkable 状态；视觉差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（点击后仅切换删除提醒状态并持久化；移出书架确认流程继续读取该开关，保持 legado 同义控制边界）。
    - 验证：`flutter test test/search_book_info_view_delete_alert_action_test.dart test/search_book_info_view_allow_update_action_test.dart` 通过；手工路径（待回归）`书架 -> 书籍详情 -> 右上角更多 -> 删除提醒 -> 重新打开更多菜单确认勾选态变化 -> 点击移出书架确认开关生效`。
  - 兼容影响：无旧书源兼容性影响；仅收敛 `menu_delete_alert` 的 checkable 状态表达与提示文案语义，不改变书架删除数据链路。
  - 已完成 `P2-seq43`：`book_info.xml / @+id/menu_clear_cache / 清理缓存`。
  - `P2-seq43` 差异点清单（实施前）：
    - Flutter 详情页 `menu_clear_cache` 仅允许书架内 `bookId` 非空场景触发，非书架场景会提示“当前书籍不在书架，无法清理缓存”；legado `BookInfoActivity.menu_clear_cache -> viewModel.clearCache` 不依赖 `inBookshelf`，点击即执行清理。
    - Flutter 清理后按章节数分支提示“暂无可清理的章节缓存 / 已清理缓存：x 章”，与 legado `clear_cache_success=成功清理缓存` 的统一成功反馈语义不一致。
    - Flutter `Chapter.copyWith` 采用 `content ?? this.content`，导致清理缓存时无法显式将 `content` 置空，出现“已清理但内存正文仍残留”的语义偏差风险。
  - `P2-seq43` 逐项对照清单（实施后）：
    - 入口：已同义（详情页“更多”菜单保留一级“清理缓存”动作入口）。
    - 状态：已同义（不再依赖书架状态拦截；书架与非书架详情均可触发清理）。
    - 异常：已同义（清理异常统一提示“清理缓存出错\n<摘要>”，保持可观测失败分支）。
    - 文案：已同义（清理成功统一提示“成功清理缓存”，移除“无法清理/暂无缓存/已清理 x 章”等扩展文案）。
    - 排版：已同义（沿用 `CupertinoActionSheet + ShadDialog` 承载动作与反馈，视觉差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（点击后按当前书籍 `bookId` 清理；当 `bookId` 缺失时使用 `ephemeral` 会话 ID 回退执行清理，保持 legado “点击即清理”语义）。
    - 验证：`flutter test test/search_book_info_view_clear_cache_action_test.dart test/search_book_info_view_compile_test.dart` 通过；手工路径 `书架 -> 书籍详情 -> 右上角更多 -> 清理缓存`（确认反馈“成功清理缓存”且不再出现“无法清理缓存/暂无可清理/已清理 x 章”扩展提示），以及 `非书架详情 -> 更多 -> 清理缓存`（确认无书架拦截）。
  - 兼容影响：无旧书源解析兼容性影响；仅收敛 `menu_clear_cache` 触发与反馈语义，并修复章节缓存模型 `content` 可显式置空能力，避免清理后内存残留。
  - 已完成 `P2-seq44`：`book_info.xml / @+id/menu_log / 日志`。
  - `P2-seq44` 差异点清单（实施前）：
    - Flutter 详情页 `menu_log` 触发 `_openExceptionLogs` 页面跳转到 `ExceptionLogsView`，而 legado `BookInfoActivity` 为 `menu_log -> showDialogFragment<AppLogDialog>()`，触发层级存在偏差。
    - Flutter 日志页标题/空态文案为“异常日志 / 暂无异常日志”，与 legado `@string/log` 菜单语义及 `AppLogDialog` 的“日志 / 暂无日志”可见文案不一致。
    - tracker `seq44` 仍为 `pending`，缺少页面级回归证据与手工路径记录，无法闭环本序号迁移。
  - `P2-seq44` 逐项对照清单（实施后）：
    - 入口：已同义（详情页“更多”菜单保留一级“日志”动作入口）。
    - 状态：已同义（点击后弹出日志对话框，保留“清空”动作与空态可见反馈）。
    - 异常：已同义（无日志时展示“暂无日志”；不新增静默失败分支）。
    - 文案：已同义（收敛为“日志 / 暂无日志”，移除“异常日志”页面级文案偏差）。
    - 排版：已同义（沿用 `CupertinoActionSheet + CupertinoDialog` 承载菜单与日志弹层；视觉差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（动作路径收敛为 `menu_log -> showAppLogDialog` 弹层语义，对齐 legado `menu_log -> AppLogDialog`）。
    - 验证：`flutter test test/search_book_info_view_log_action_test.dart test/search_book_info_view_compile_test.dart` 通过；手工路径 `书架 -> 书籍详情 -> 右上角更多 -> 日志`（确认弹出日志对话框，显示“清空/暂无日志”且不出现“异常日志”）。
  - 兼容影响：无旧书源兼容性影响；仅收敛 `menu_log` 入口触发层级与可见文案语义，不变更搜索/详情/目录请求链路。
  - 已完成 `P2-seq45`：`book_info_edit.xml / @+id/menu_save / 保存`。
  - `P2-seq45` 差异点清单（实施前）：
    - Flutter 编辑页保存后会额外提示“书籍信息已保存”，而 legado `BookInfoEditActivity.menu_save -> saveData` 仅写库并返回上一页，不追加成功提示。
    - Flutter `SearchBookInfoEditHelper.applyDraft` 在作者输入为空白时回退旧值，偏离 legado `saveData` 直接按输入写入（可保存空字符串）的语义。
    - Flutter 编辑保存链路缺少写库失败可观测分支；若落库异常，当前路径会静默失败，不符合迁移期“异常可观测”要求。
  - `P2-seq45` 逐项对照清单（实施后）：
    - 入口：已同义（编辑页右上角保留一级“保存”动作，文案为“保存”）。
    - 状态：已同义（点击保存后直接返回详情页并回写书籍信息，不追加扩展成功提示）。
    - 异常：已同义（落库失败时输出“保存失败\n<摘要>”提示，失败分支可观测）。
    - 文案：已同义（保存按钮文案固定“保存”，移除“书籍信息已保存”扩展提示）。
    - 排版：已同义（沿用 `AppCupertinoPageScaffold` 顶栏保存按钮承载；视觉差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（保存时字段按输入值落库，作者空白输入不回退旧值；对齐 legado `menu_save -> saveData -> finish` 的提交语义）。
    - 验证：`flutter test test/search_book_info_edit_helper_test.dart test/search_book_info_view_edit_action_test.dart test/search_book_info_view_compile_test.dart` 通过；手工路径 `书架 -> 书籍详情 -> 点击编辑 -> 编辑页右上角保存`（确认保存后返回详情页且无“书籍信息已保存”扩展提示）。
  - 兼容影响：无旧书源兼容性影响；仅收敛 `menu_save` 的保存反馈与字段覆盖语义，不改书源请求与阅读链路。
  - 已完成 `P2-seq101`：`book_remote.xml / @+id/menu_refresh / 刷新`。
  - `P2-seq101` 差异点清单（实施前）：
    - Flutter 远程书籍页仍为静态占位文案，缺少 legado `menu_refresh -> upPath()` 的“重载当前目录”行为。
    - 当前远程页无目录路径状态，无法对齐 legado 刷新时的“路径栏 + 返回上级 + 当前目录数据重拉”联动语义。
    - 缺少 WebDav 目录拉取链路与失败可观测输出，无法满足 legado `loadRemoteBookList` 的错误可见边界。
  - `P2-seq101` 逐项对照清单（实施后）：
    - 入口：已同义（书架更多菜单进入“远程书籍”后，顶栏提供独立“刷新”动作）。
    - 状态：已同义（刷新时清空当前目录列表并显示加载态，完成后更新“最近刷新时间”）。
    - 异常：已同义（WebDav 配置缺失或请求失败时，统一可观测输出“获取webDav书籍出错\n<原因>”）。
    - 文案：已同义（刷新动作标题语义保持“刷新”，错误口径与 legado `获取webDav书籍出错` 语义一致）。
    - 排版：已同义（采用 `AppCupertinoPageScaffold` 顶栏刷新按钮 + 路径栏 + 列表区结构，平台视觉差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（点击刷新会重载当前目录；进入子目录/返回上级后再次刷新仍以“当前目录”为目标重拉数据）。
    - 验证：`flutter test test/remote_books_service_test.dart test/remote_books_placeholder_view_test.dart test/widget_test.dart` 通过；手工路径 `书架 -> 更多 -> 远程书籍 -> 点击右上角刷新`（确认列表重载、路径状态保持、失败分支可见）。
  - 兼容影响：无旧书源兼容性影响；新增能力仅作用于 WebDav 远程目录列表读取与刷新，不影响五段链路与本地书架数据结构。
  - 已完成 `P2-seq102`：`book_remote.xml / @+id/menu_sort / 排序`。
  - `P2-seq102` 差异点清单（实施前）：
    - Flutter 远程书籍页仅有刷新按钮，缺少 legado `menu_sort` 的独立排序入口，入口层级与交互热区不一致。
    - Flutter 远程书籍页缺少 `menu_sort` 对应的排序子菜单承载，无法进入 legado 同义的“排序菜单”路径。
    - 现有页面级回归仅覆盖 `menu_refresh`，缺少 `menu_sort` 可复现证据，tracker 无法闭环该序号。
  - `P2-seq102` 逐项对照清单（实施后）：
    - 入口：已同义（远程书籍页顶栏补齐一级“排序”入口，与 legado `menu_sort` 同层级）。
    - 状态：已同义（非加载态可点击排序入口；加载态禁用，避免与刷新并发触发）。
    - 异常：已同义（仅补齐入口承载，不新增静默失败分支与扩展错误文案）。
    - 文案：已同义（排序弹层标题“排序”，菜单项文案“名称排序/更新时间排序”对齐 legado 字符串语义）。
    - 排版：已同义（采用 `CupertinoActionSheet` 承载排序子菜单，视觉差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（点击顶栏排序可弹出子菜单；具体排序行为按 `seq103/seq104` 逐项收敛，未跨序号并项实现）。
    - 验证：`flutter test test/remote_books_placeholder_view_test.dart test/remote_books_service_test.dart test/widget_test.dart` 通过；手工路径 `书架 -> 更多 -> 远程书籍 -> 点击右上角排序`（确认弹出“排序/名称排序/更新时间排序”菜单）。
  - 兼容影响：无旧书源兼容性影响；本序号仅补齐 `menu_sort` 入口层级与菜单承载，不改动 WebDav 拉取与书架数据结构。
  - 已完成 `P2-seq103`：`book_remote.xml / @+id/menu_sort_name / 名称排序`。
  - `P2-seq103` 差异点清单（实施前）：
    - Flutter 排序弹层中“名称排序”仅关闭弹层，不触发排序状态变更，与 legado `menu_sort_name -> sortCheck(RemoteBookSort.Name) -> upPath()` 不同义。
    - Flutter 远程书籍页缺少 `sortKey/sortAscending` 状态流，无法复刻 legado 的“首次点击名称升序、再次点击同项切换升降序”语义。
    - Flutter 远程书籍页缺少 legado `AlphanumComparator` 等价比较，文件名会退化为普通字符串序或时间序，出现 `b10`/`b2` 顺序偏差风险。
  - `P2-seq103` 逐项对照清单（实施后）：
    - 入口：已同义（远程书籍页“排序”子菜单保留一级“名称排序”入口）。
    - 状态：已同义（首次点击“名称排序”切换为名称升序；再次点击同项在升/降序间切换，保持 legado `sortCheck` 语义）。
    - 异常：已同义（排序切换沿用既有刷新链路；WebDav 异常仍统一可观测输出“获取webDav书籍出错\n<原因>”）。
    - 文案：已同义（动作文案保持“名称排序”，不新增扩展文案）。
    - 排版：已同义（沿用 `CupertinoActionSheet` 承载排序子菜单；视觉差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（点击“名称排序”后按 legado 同义链路重载当前目录；目录始终优先，文件名比较按 `AlphanumComparator` 等价规则执行）。
    - 验证：`flutter test test/remote_books_placeholder_view_test.dart test/remote_books_service_test.dart test/widget_test.dart` 通过；手工路径 `书架 -> 更多 -> 远程书籍 -> 右上角排序 -> 名称排序（再点击一次名称排序）`（确认首次名称升序、再次切换降序且均触发目录重载）。
  - 兼容影响：无旧书源兼容性影响；本序号仅收敛远程书籍页 `menu_sort_name` 排序状态流与文件名比较语义，不改动 WebDav 认证与导入链路。
  - 已完成 `P2-seq104`：`book_remote.xml / @+id/menu_sort_time / 更新时间排序`。
  - `P2-seq104` 差异点清单（实施前）：
    - Flutter 排序弹层中“更新时间排序”仅关闭弹层，不触发排序状态变更，与 legado `menu_sort_time -> sortCheck(RemoteBookSort.Default) -> upPath()` 不同义。
    - Flutter 缺少更新时间排序的状态切换逻辑，无法复刻 legado “若已是时间排序则重复点击切换升降序；若从其它排序切回则先设为升序”的 `sortCheck` 语义。
    - 远程书籍页当前仅覆盖名称排序回归，缺少“更新时间排序切换 + 目录重载次数”可复现证据，tracker 无法闭环 `seq104`。
  - `P2-seq104` 逐项对照清单（实施后）：
    - 入口：已同义（远程书籍页“排序”子菜单保留一级“更新时间排序”入口）。
    - 状态：已同义（从名称排序切换到更新时间排序时先进入时间升序；再次点击“更新时间排序”在升/降序间切换，对齐 legado `sortCheck(RemoteBookSort.Default)`）。
    - 异常：已同义（排序切换沿用刷新链路；WebDav 异常仍统一可观测输出“获取webDav书籍出错\n<原因>”）。
    - 文案：已同义（动作文案保持“更新时间排序”，不新增扩展文案）。
    - 排版：已同义（沿用 `CupertinoActionSheet` 承载排序子菜单；视觉差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（点击“更新时间排序”后按 legado 同义链路重载当前目录；目录始终优先，文件按更新时间升/降序切换）。
    - 验证：`flutter test test/remote_books_placeholder_view_test.dart test/remote_books_service_test.dart test/widget_test.dart` 通过；手工路径 `书架 -> 更多 -> 远程书籍 -> 右上角排序 -> 更新时间排序（再点击一次更新时间排序）`（确认首次时间升序、再次切换降序且均触发目录重载）。
  - 兼容影响：无旧书源兼容性影响；本序号仅收敛远程书籍页 `menu_sort_time` 排序状态流，不改动 WebDav 认证与导入链路。
  - 已完成 `P2-seq105`：`book_remote.xml / @+id/menu_server_config / 服务器配置`。
  - `P2-seq105` 差异点清单（实施前）：
    - Flutter 远程书籍页仅提供“刷新/排序”操作，缺少 legado `menu_server_config` 的一级入口，入口层级与热区不一致。
    - Flutter 远程书籍页无独立服务器配置承载路径；WebDav 字段仅散落在“备份与恢复”页面，无法满足 legado “从远程书籍页直接进入服务器配置”的语义。
    - Flutter 在配置返回后不会自动重载远程目录，缺少 legado `onDialogDismiss -> initData -> upPath` 的回调刷新语义。
  - `P2-seq105` 逐项对照清单（实施后）：
    - 入口：已同义（远程书籍页顶栏补齐“更多”入口，弹层内提供一级“服务器配置”动作）。
    - 状态：已同义（配置页展示并可编辑 WebDav 地址/账号/密码/同步目录，保存后即时持久化）。
    - 异常：已同义（测试连接失败时保留可观测错误摘要；不新增静默失败分支）。
    - 文案：已同义（入口文案固定“服务器配置”，配置页标题与字段语义对齐 legado `server_config`）。
    - 排版：已同义（采用 `CupertinoActionSheet + AppCupertinoPageScaffold` 承载菜单与配置页；视觉差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（`服务器配置` 返回后强制重载当前目录，收敛为 legado `onDialogDismiss -> upPath` 语义）。
    - 验证：`flutter test test/remote_books_placeholder_view_test.dart`、`flutter test test/widget_test.dart --plain-name "Bookshelf remote action opens remote books page"` 通过；手工路径 `书架 -> 更多 -> 远程书籍 -> 右上角更多 -> 服务器配置 -> 返回远程书籍页`（确认返回后自动重载目录）。
  - 兼容影响：无旧书源兼容性影响；本序号仅收敛远程书籍页 `menu_server_config` 入口与回调刷新语义，不改动 WebDav 拉取与导入链路。
  - 已完成 `P2-seq106`：`book_remote.xml / @+id/menu_help / 帮助`。
  - `P2-seq106` 差异点清单（实施前）：
    - Flutter 远程书籍页“更多”菜单仅有“服务器配置”，缺少 legado `menu_help` 一级入口，入口层级不一致。
    - Flutter 项目仅接入 `appHelp.md`，缺少 legado 同源 `webDavBookHelp.md` 资产，无法还原 `showHelp("webDavBookHelp")` 文档语义。
    - 远程书籍页缺少 `menu_help` 定向回归，tracker 无法提供该序号可复现证据。
  - `P2-seq106` 逐项对照清单（实施后）：
    - 入口：已同义（远程书籍页“更多”菜单补齐一级“帮助”动作，层级与 legado `menu_help` 一致）。
    - 状态：已同义（非加载态可点击“帮助”；加载态禁用更多菜单，避免与刷新并发触发）。
    - 异常：已同义（帮助文档加载失败时弹出“帮助文档加载失败：<原因>”可观测提示，不新增静默失败分支）。
    - 文案：已同义（动作文案固定“帮助”，弹层标题“帮助”与 legado 语义一致）。
    - 排版：已同义（菜单使用 `CupertinoActionSheet`，帮助内容复用现有帮助弹层承载；视觉差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（点击“帮助”后读取 `assets/web/help/md/webDavBookHelp.md` 并弹层展示，对齐 legado `showHelp("webDavBookHelp")` 触发链路）。
    - 验证：`flutter test test/remote_books_placeholder_view_test.dart` 通过；手工路径 `书架 -> 更多 -> 远程书籍 -> 右上角更多 -> 帮助`（确认弹层展示 “WebDav 书籍简明使用教程”）。
  - 兼容影响：无旧书源兼容性影响；本序号仅收敛远程书籍页 `menu_help` 入口与帮助文档展示链路，不改动 WebDav 拉取、排序与导入逻辑。
  - 已完成 `P2-seq107`：`book_remote.xml / @+id/menu_log / 日志`。
  - `P2-seq107` 差异点清单（实施前）：
    - Flutter 远程书籍页“更多”菜单仅提供“服务器配置/帮助”，缺少 legado `menu_log` 一级入口，入口层级不一致。
    - Flutter 远程书籍页缺少 `menu_log -> AppLogDialog` 触发链路，无法在当前页面就地查看/清空日志。
    - `test/remote_books_placeholder_view_test.dart` 缺少 `menu_log` 定向回归，tracker 无法提供本序号可复现证据。
  - `P2-seq107` 逐项对照清单（实施后）：
    - 入口：已同义（远程书籍页“更多”菜单补齐一级“日志”动作，层级与 legado `menu_log` 一致）。
    - 状态：已同义（非加载态可点击“日志”；进入日志弹层后保留“清空”动作与空态展示）。
    - 异常：已同义（沿用现有日志服务，不新增静默失败分支；无日志时可观测提示“暂无日志”）。
    - 文案：已同义（动作文案固定“日志”，移除“异常日志”扩展文案口径）。
    - 排版：已同义（菜单使用 `CupertinoActionSheet`，日志内容使用现有 `showAppLogDialog` 弹层承载；视觉差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（点击“日志”后直接弹出 `AppLogDialog`，对齐 legado `menu_log -> showDialogFragment<AppLogDialog>()` 链路）。
    - 验证：`flutter test test/remote_books_placeholder_view_test.dart` 通过；手工路径 `书架 -> 更多 -> 远程书籍 -> 右上角更多 -> 日志`（确认可见“清空/暂无日志”，且不出现“异常日志”文案）。
  - 兼容影响：无旧书源兼容性影响；本序号仅收敛远程书籍页 `menu_log` 入口与弹层触发语义，不改动 WebDav 拉取、排序与导入逻辑。
  - 已完成 `P2-seq108`：`book_search.xml / @+id/menu_precision_search / 精准搜索`。
  - `P2-seq108` 差异点清单（实施前）：
    - Flutter 搜索设置中“精准搜索”以“开启/关闭”值文本展示，未对齐 legado `menu_precision_search` 的 `checkable` 勾选态语义。
    - Flutter 切换精准搜索时仅在输入框非空才触发 `_search()`，空输入时会走本地重排分支，与 legado `setQuery(..., true)` 的统一重提交流程不一致。
    - tracker `seq108` 仍为 `pending`，缺少“勾选态切换 + 持久化”定向回归证据，无法闭环本序号。
  - `P2-seq108` 逐项对照清单（实施后）：
    - 入口：已同义（搜索页设置弹层保留一级“精准搜索”入口，层级与 legado `book_search.xml` 一致）。
    - 状态：已同义（“精准搜索”改为勾选态显示，开启时展示 `check_mark`，关闭时无勾选）。
    - 异常：已同义（切换后复用既有搜索链路的错误可观测输出，不新增静默失败分支）。
    - 文案：已同义（菜单标题固定“精准搜索”，移除“开启/关闭”扩展值文本）。
    - 排版：已同义（仍使用 `CupertinoActionSheet` 承载，平台视觉差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（切换后统一触发 `_search()`，收敛为 legado `menu_precision_search -> setQuery(..., true)` 的同义重提交流程）。
    - 验证：`flutter test test/search_view_precision_search_action_test.dart test/search_view_compile_test.dart` 通过；手工路径 `书架 -> 搜索 -> 右上角设置 -> 精准搜索 -> 再次打开设置`（确认勾选态随开关变化且配置持久化）。
  - 兼容影响：无旧书源兼容性影响；仅收敛 `menu_precision_search` 的展示与触发语义，不改动搜索源解析链路与缓存结构。
  - 已完成 `P2-seq109`：`book_search.xml / @+id/menu_source_manage / 书源管理`。
  - `P2-seq109` 差异点清单（实施前）：
    - 需确认当前搜索页“设置 -> 书源管理”入口是否与 legado `menu_source_manage -> startActivity<BookSourceActivity>()` 的一级跳转语义同义，并补齐迁移证据。
    - 定向回归时发现进入 `SourceListView` 会在 Linux/测试环境触发 QuickJS 动态库缺失（`libquickjs_c_bridge_plugin.so`）异常，导致入口崩溃并无法闭环该序号验证。
    - `tracker seq109` 仍为 `pending`，缺少页面级回归证据与兼容记录。
  - `P2-seq109` 逐项对照清单（实施后）：
    - 入口：已同义（搜索页设置弹层保留一级“书源管理”入口，层级与 legado `book_search.xml` 一致）。
    - 状态：已同义（入口常驻可点击，不依赖搜索关键字与结果状态）。
    - 异常：已同义（`js_runtime_native` 改为惰性初始化并在 QuickJS 动态库缺失时降级为空运行时，避免进入书源管理页即崩溃）。
    - 文案：已同义（入口文案固定“书源管理”，与 legado `@string/book_source_manage` 一致）。
    - 排版：已同义（设置弹层与页面跳转承载保持 `Shadcn + Cupertino`，视觉差异属于平台允许范围）。
    - 交互触发：已同义（点击“书源管理”后直接进入 `SourceListView`，对齐 legado `menu_source_manage -> BookSourceActivity` 的页面跳转语义）。
    - 验证：`flutter test test/search_view_source_manage_action_test.dart test/search_view_compile_test.dart` 通过；手工路径 `书架 -> 搜索 -> 右上角设置 -> 书源管理`（确认可进入书源管理页且无崩溃）。
  - 兼容影响：无旧书源兼容性影响；本序号仅收敛 `menu_source_manage` 入口与运行时兼容边界，不改动书源数据结构与五段链路。
  - 已完成 `P2-seq110`：`book_search.xml / @+id/menu_search_scope / 多分组/书源`。
  - `P2-seq110` 差异点清单（实施前）：
    - Flutter 搜索设置中该入口文案为“搜索范围”，与 legado `@string/groups_or_source=多分组/书源` 不一致。
    - 点击入口后先进入自定义 quick sheet，再二次点击“多分组/单源模式…”才进入范围选择页；与 legado `menu_search_scope -> showDialogFragment<SearchScopeDialog>()` 的直达触发链路不一致。
    - 当书源列表为空时，Flutter 会提前提示“没有可用书源。”并阻断进入范围页；legado 在空数据场景仍允许进入 `SearchScopeDialog` 并通过空列表态交互。
  - `P2-seq110` 逐项对照清单（实施后）：
    - 入口：已同义（搜索页设置弹层保留一级“多分组/书源”入口，层级与 legado `book_search.xml` 一致）。
    - 状态：已同义（点击入口后直接进入 `SearchScopePickerView`，不再经过扩展 quick sheet；范围保存后仍按现有同义规则自动重搜）。
    - 异常：已同义（移除“无书源即阻断”扩展分支；空书源场景可进入范围页并保持可取消返回）。
    - 文案：已同义（入口文案由“搜索范围”收敛为“多分组/书源”，移除“多分组/单源模式…”扩展文案入口）。
    - 排版：已同义（继续使用 `Shadcn + Cupertino` 页面承载范围选择，平台视觉差异属于允许范围）。
    - 交互触发：已同义（点击“多分组/书源”后直接打开范围页，对齐 legado `menu_search_scope` 的一级触发语义）。
    - 验证：`flutter test test/search_view_precision_search_action_test.dart test/search_view_source_manage_action_test.dart test/search_view_search_scope_action_test.dart test/search_scope_picker_view_compile_test.dart` 通过；手工路径 `书架 -> 搜索 -> 右上角设置 -> 多分组/书源`（确认直接进入范围页）。
  - 兼容影响：无旧书源兼容性影响；本序号仅收敛 `menu_search_scope` 入口文案与触发链路，不改动搜索数据结构与缓存键规则。
  - 已完成 `P2-seq111`：`book_search.xml / @+id/menu_log / 日志`。
  - `P2-seq111` 差异点清单（实施前）：
    - Flutter 搜索设置“日志”动作触发的是页面跳转 `ExceptionLogsView`，与 legado `menu_log -> showDialogFragment(AppLogDialog())` 的弹层语义不一致。
    - Flutter 日志页面标题语义为“异常日志”，与 legado 菜单文案“日志”存在用户可见语义偏差。
    - tracker `seq111` 仍为 `pending`，缺少“搜索设置日志入口 -> 日志弹层”定向回归证据。
  - `P2-seq111` 逐项对照清单（实施后）：
    - 入口：已同义（搜索页设置弹层保留一级“日志”入口，层级与 legado `book_search.xml` 一致）。
    - 状态：已同义（点击后直接弹出日志对话框；日志为空时展示“暂无日志”，并提供“清空”动作）。
    - 异常：已同义（沿用现有日志存储与弹层承载，不新增静默失败分支；清空后状态即时可见）。
    - 文案：已同义（入口与弹层标题均为“日志”，移除“异常日志”页面级文案偏差）。
    - 排版：已同义（`CupertinoActionSheet` 入口 + `showAppLogDialog` 弹层承载，视觉差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（点击“日志”后直接触发 `AppLogDialog`，对齐 legado `menu_log` 弹层触发链路）。
    - 验证：`flutter test test/search_view_log_action_test.dart test/search_view_precision_search_action_test.dart test/search_view_source_manage_action_test.dart test/search_view_search_scope_action_test.dart test/search_view_compile_test.dart` 通过；手工路径 `书架 -> 搜索 -> 右上角设置 -> 日志`（确认弹出日志弹层且可见“清空/暂无日志”）。
  - 兼容影响：无旧书源兼容性影响；本序号仅收敛 `menu_log` 触发承载与文案语义，不改动搜索链路与书源数据结构。
  - 已完成 `P2-seq112`：`book_search_scope.xml / @+id/menu_screen / 筛选`。
  - `P2-seq112` 差异点清单（实施前）：
    - Flutter 搜索范围页将筛选输入放在内容区，未对齐 legado `menu_screen` 作为工具栏 actionView 的入口层级语义。
    - Flutter 虽然仅在“书源”模式显示筛选框，但缺少“顶栏菜单位显隐”这一 legacy 触发形态，`menu_screen` 对照证据不足。
    - tracker `seq112` 仍为 `pending`，缺少“分组模式隐藏 / 书源模式显示 / 输入后筛选生效”的页面级定向回归。
  - `P2-seq112` 逐项对照清单（实施后）：
    - 入口：已同义（筛选入口迁移到导航栏 `trailing`，对应 legacy `menu_screen` 顶栏动作位）。
    - 状态：已同义（分组模式隐藏筛选入口；切换到书源模式后显示筛选输入）。
    - 异常：已同义（筛选仅作用于本地列表过滤，不新增静默失败分支；无匹配时保持现有空态提示）。
    - 文案：已同义（入口文案统一“筛选”，不追加扩展标题）。
    - 排版：已同义（采用 `CupertinoNavigationBar` trailing 搜索框承载；平台视觉差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（输入后即时按书源名/分组/URL/备注过滤，且模式切换后保留筛选词以对齐 legacy `screenText` 持续语义）。
    - 验证：`flutter test test/search_scope_picker_view_menu_screen_test.dart test/search_scope_picker_helper_test.dart test/search_scope_picker_view_compile_test.dart test/search_view_search_scope_action_test.dart` 通过；手工路径 `书架 -> 搜索 -> 右上角设置 -> 多分组/书源 -> 切换书源 -> 顶栏输入筛选词`。
  - 兼容影响：无旧书源兼容性影响；本序号仅收敛 `menu_screen` 入口承载与筛选触发形态，不改动搜索范围保存格式。
  - 已完成 `P2-seq113`：`book_source.xml / @+id/action_sort / 排序`。
  - `P2-seq113` 差异点清单（实施前）：
    - Flutter 书源管理页排序弹层标题为“排序选项”，与 legado `action_sort` 的父级标题语义“排序”不一致。
    - `tracker seq113` 仍为 `pending`，缺少“顶栏排序入口 -> 打开排序菜单”的定向回归证据。
  - `P2-seq113` 逐项对照清单（实施后）：
    - 入口：已同义（书源管理页顶栏保留一级排序入口 `CupertinoIcons.arrow_up_arrow_down`，层级与 legado `action_sort` 一致）。
    - 状态：已同义（点击排序入口后可打开排序菜单，后续子项动作保持待 `seq114~121` 逐项收敛）。
    - 异常：已同义（仅收敛父级标题与回归证据，不新增静默失败分支）。
    - 文案：已同义（排序弹层父级标题由“排序选项”收敛为 legado 同义“排序”）。
    - 排版：已同义（继续使用 `CupertinoActionSheet` 承载父级排序菜单；视觉差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（点击顶栏排序入口即可弹出排序菜单，对齐 legado `action_sort` 一级触发语义）。
    - 验证：`flutter test test/source_list_view_sort_action_test.dart` 通过；手工路径 `书架 -> 搜索 -> 右上角设置 -> 书源管理 -> 顶栏排序`（确认弹出标题“排序”的排序菜单）。
  - 兼容影响：无旧书源兼容性影响；本序号仅收敛 `action_sort` 父级入口文案与触发证据，不改动排序子项比较逻辑与书源数据结构。
  - 已完成 `P2-seq114`：`book_source.xml / @+id/menu_sort_desc / 反序`。
  - `P2-seq114` 差异点清单（实施前）：
    - Flutter 排序菜单子项使用动态文案“切换为降序/升序”，与 legado `menu_sort_desc` 的固定“反序” checkable 语义不一致。
    - `tracker seq114` 仍为 `pending`，缺少“反序勾选态切换”定向回归证据。
  - `P2-seq114` 逐项对照清单（实施后）：
    - 入口：已同义（位于排序菜单一级子项，层级与 legado `menu_sort_desc` 一致）。
    - 状态：已同义（默认未勾选；点击后切换为勾选态并同步反转排序方向）。
    - 异常：已同义（仅切换本地排序状态，不新增静默失败分支）。
    - 文案：已同义（由“切换为降序/升序”收敛为固定“反序”）。
    - 排版：已同义（使用 `CupertinoActionSheet` 子项并通过前缀 `✓` 呈现 checkable 勾选态，平台视觉差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（点击“反序”后仅执行 `sortAscending` 翻转并关闭菜单，对齐 legado `menu_sort_desc` 触发语义）。
    - 验证：`flutter test test/source_list_view_sort_action_test.dart` 通过；手工路径 `书架 -> 搜索 -> 右上角设置 -> 书源管理 -> 顶栏排序 -> 反序`（再次打开排序菜单确认“反序”勾选态切换）。
  - 兼容影响：无旧书源兼容性影响；本序号仅收敛 `menu_sort_desc` 展示与状态语义，不改动排序算法与书源数据结构。
  - 已完成 `P2-seq115`：`book_source.xml / @+id/menu_sort_manual / 手动排序`。
  - `P2-seq115` 差异点清单（实施前）：
    - legado `menu_sort_manual` 属于 `menu_group_sort` 单选组中的 checkable 子项；语义要求为“切回手动排序后该子项独占勾选态，并恢复默认排序模式”。
    - Flutter 端虽已有“手动排序”菜单项与 `sortMode=manual` 切换能力，但缺少“先切到其它排序再切回手动”的独立可复现回归证据。
    - tracker `seq115` 仍为 `pending`，缺少页面级定向验证记录，无法闭环迁移证据。
  - `P2-seq115` 逐项对照清单（实施后）：
    - 入口：已同义（位于排序菜单一级子项，层级与 legado `menu_sort_manual` 一致）。
    - 状态：已同义（从其它排序切回后“手动排序”独占勾选态；再次打开菜单可见勾选结果）。
    - 异常：已同义（仅切换本地排序模式，不新增静默失败分支）。
    - 文案：已同义（菜单项文案保持“手动排序”，与 legado `@string/sort_manual` 一致）。
    - 排版：已同义（使用 `CupertinoActionSheet` 子项并通过前缀 `✓` 呈现单选勾选态，平台视觉差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（点击“手动排序”后仅切换 `_sortMode=manual` 并关闭菜单，对齐 legado `menu_sort_manual -> sort=Default -> upBookSource(...)` 触发语义）。
    - 验证：`flutter test test/source_list_view_sort_action_test.dart` 通过；手工路径 `书架 -> 搜索 -> 右上角设置 -> 书源管理 -> 顶栏排序 -> 智能排序 -> 再次顶栏排序 -> 手动排序`（确认切回后仅“手动排序”带勾选）。
  - 兼容影响：无旧书源兼容性影响；本序号仅补齐 `menu_sort_manual` 的单选勾选态回归证据，不改动书源排序算法与持久化结构。
  - 已完成 `P2-seq116`：`book_source.xml / @+id/menu_sort_auto / 智能排序`。
  - `P2-seq116` 差异点清单（实施前）：
    - legado `menu_sort_auto` 文案为“智能排序”，且属于 `menu_group_sort` 单选组 checkable 子项；Flutter 端当前文案为“权重”，存在用户可见语义偏差。
    - Flutter 端虽已存在 `_SourceSortMode.weight` 排序逻辑，但缺少以“智能排序”文案触发并保持单选勾选态的定向回归证据。
    - tracker `seq116` 仍为 `pending`，缺少可复现验证记录，无法闭环迁移证据。
  - `P2-seq116` 逐项对照清单（实施后）：
    - 入口：已同义（位于排序菜单一级子项，层级与 legado `menu_sort_auto` 一致）。
    - 状态：已同义（点击后切换到 `_SourceSortMode.weight`，再次打开菜单仅“智能排序”保留勾选态）。
    - 异常：已同义（仅切换本地排序模式，不新增静默失败分支）。
    - 文案：已同义（菜单项文案由“权重”收敛为 legado 同义“智能排序”）。
    - 排版：已同义（使用 `CupertinoActionSheet` 子项并通过前缀 `✓` 呈现单选勾选态，平台视觉差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（点击“智能排序”后仅切换 `_sortMode=weight` 并关闭菜单，对齐 legado `menu_sort_auto -> sort=Weight -> upBookSource(...)` 触发语义）。
    - 验证：`flutter test test/source_list_view_sort_action_test.dart` 通过；手工路径 `书架 -> 搜索 -> 右上角设置 -> 书源管理 -> 顶栏排序 -> 智能排序 -> 再次顶栏排序`（确认“智能排序”勾选态保持）。
  - 兼容影响：无旧书源兼容性影响；本序号仅收敛 `menu_sort_auto` 文案与勾选态证据，不改动排序算法与持久化结构。
  - 已完成 `P2-seq117`：`book_source.xml / @+id/menu_sort_name / 名称排序`。
  - `P2-seq117` 差异点清单（实施前）：
    - legado `menu_sort_name` 文案为“名称排序”，且属于 `menu_group_sort` 单选组 checkable 子项；Flutter 端当前文案为“名称”，存在用户可见语义偏差。
    - Flutter 端虽已存在 `_SourceSortMode.name` 排序逻辑，但缺少以“名称排序”文案触发并保持单选勾选态的定向回归证据。
    - tracker `seq117` 仍为 `pending`，缺少可复现验证记录，无法闭环迁移证据。
  - `P2-seq117` 逐项对照清单（实施后）：
    - 入口：已同义（位于排序菜单一级子项，层级与 legado `menu_sort_name` 一致）。
    - 状态：已同义（点击后切换到 `_SourceSortMode.name`，再次打开菜单仅“名称排序”保留勾选态）。
    - 异常：已同义（仅切换本地排序模式，不新增静默失败分支）。
    - 文案：已同义（菜单项文案由“名称”收敛为 legado 同义“名称排序”）。
    - 排版：已同义（使用 `CupertinoActionSheet` 子项并通过前缀 `✓` 呈现单选勾选态，平台视觉差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（点击“名称排序”后仅切换 `_sortMode=name` 并关闭菜单，对齐 legado `menu_sort_name -> sort=Name -> upBookSource(...)` 触发语义）。
    - 验证：`flutter test test/source_list_view_sort_action_test.dart` 通过；手工路径 `书架 -> 搜索 -> 右上角设置 -> 书源管理 -> 顶栏排序 -> 名称排序 -> 再次顶栏排序`（确认“名称排序”勾选态保持）。
  - 兼容影响：无旧书源兼容性影响；本序号仅收敛 `menu_sort_name` 文案与勾选态证据，不改动排序算法与持久化结构。
  - 已完成 `P2-seq118`：`book_source.xml / @+id/menu_sort_url / 地址排序`。
  - `P2-seq118` 差异点清单（实施前）：
    - legado `menu_sort_url` 文案为“地址排序”，且属于 `menu_group_sort` 单选组 checkable 子项；Flutter 端当前文案为“地址”，存在用户可见语义偏差。
    - Flutter 端虽已存在 `_SourceSortMode.url` 排序逻辑，但缺少以“地址排序”文案触发并保持单选勾选态的定向回归证据。
    - tracker `seq118` 仍为 `pending`，缺少可复现验证记录，无法闭环迁移证据。
  - `P2-seq118` 逐项对照清单（实施后）：
    - 入口：已同义（位于排序菜单一级子项，层级与 legado `menu_sort_url` 一致）。
    - 状态：已同义（点击后切换到 `_SourceSortMode.url`，再次打开菜单仅“地址排序”保留勾选态）。
    - 异常：已同义（仅切换本地排序模式，不新增静默失败分支）。
    - 文案：已同义（菜单项文案由“地址”收敛为 legado 同义“地址排序”）。
    - 排版：已同义（使用 `CupertinoActionSheet` 子项并通过前缀 `✓` 呈现单选勾选态，平台视觉差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（点击“地址排序”后仅切换 `_sortMode=url` 并关闭菜单，对齐 legado `menu_sort_url -> sort=Url -> upBookSource(...)` 触发语义）。
    - 验证：`flutter test test/source_list_view_sort_action_test.dart` 通过；手工路径 `书架 -> 搜索 -> 右上角设置 -> 书源管理 -> 顶栏排序 -> 地址排序 -> 再次顶栏排序`（确认“地址排序”勾选态保持）。
  - 兼容影响：无旧书源兼容性影响；本序号仅收敛 `menu_sort_url` 文案与勾选态证据，不改动排序算法与持久化结构。
  - 已完成 `P2-seq119`：`book_source.xml / @+id/menu_sort_time / 更新时间排序`。
  - `P2-seq119` 差异点清单（实施前）：
    - legado `menu_sort_time` 文案为“更新时间排序”，且属于 `menu_group_sort` 单选组 checkable 子项；Flutter 端当前文案为“更新时间”，存在用户可见语义偏差。
    - Flutter 端虽已存在 `_SourceSortMode.update` 排序逻辑，但缺少以“更新时间排序”文案触发并保持单选勾选态的定向回归证据。
    - tracker `seq119` 仍为 `pending`，缺少可复现验证记录，无法闭环迁移证据。
  - `P2-seq119` 逐项对照清单（实施后）：
    - 入口：已同义（位于排序菜单一级子项，层级与 legado `menu_sort_time` 一致）。
    - 状态：已同义（点击后切换到 `_SourceSortMode.update`，再次打开菜单仅“更新时间排序”保留勾选态；切换“反序”后该勾选态保持）。
    - 异常：已同义（仅切换本地排序模式与方向，不新增静默失败分支）。
    - 文案：已同义（菜单项文案由“更新时间”收敛为 legado 同义“更新时间排序”）。
    - 排版：已同义（使用 `CupertinoActionSheet` 子项并通过前缀 `✓` 呈现单选勾选态，平台视觉差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（点击“更新时间排序”后仅切换 `_sortMode=update` 并关闭菜单，对齐 legado `menu_sort_time -> sort=Update -> upBookSource(...)` 触发语义）。
    - 验证：`flutter test test/source_list_view_sort_action_test.dart` 通过；手工路径（待回归）`书架 -> 搜索 -> 右上角设置 -> 书源管理 -> 顶栏排序 -> 更新时间排序 -> 反序 -> 再次顶栏排序`（确认“更新时间排序”“反序”勾选态保持）。
  - 兼容影响：无旧书源兼容性影响；本序号仅收敛 `menu_sort_time` 文案与勾选态证据，不改动排序算法与持久化结构。
  - 已完成 `P2-seq120`：`book_source.xml / @+id/menu_sort_respondTime / 响应时间排序`。
  - `P2-seq120` 差异点清单（实施前）：
    - legado `menu_sort_respondTime` 文案为“响应时间排序”，且属于 `menu_group_sort` 单选组 checkable 子项；Flutter 端当前文案为“响应时间”，存在用户可见语义偏差。
    - Flutter 端虽已存在 `_SourceSortMode.respond` 排序逻辑，但缺少以“响应时间排序”文案触发并保持单选勾选态的定向回归证据。
    - tracker `seq120` 仍为 `pending`，缺少可复现验证记录，无法闭环迁移证据。
  - `P2-seq120` 逐项对照清单（实施后）：
    - 入口：已同义（位于排序菜单一级子项，层级与 legado `menu_sort_respondTime` 一致）。
    - 状态：已同义（点击后切换到 `_SourceSortMode.respond`，再次打开菜单仅“响应时间排序”保留勾选态）。
    - 异常：已同义（仅切换本地排序模式，不新增静默失败分支）。
    - 文案：已同义（菜单项文案由“响应时间”收敛为 legado 同义“响应时间排序”）。
    - 排版：已同义（使用 `CupertinoActionSheet` 子项并通过前缀 `✓` 呈现单选勾选态，平台视觉差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（点击“响应时间排序”后仅切换 `_sortMode=respond` 并关闭菜单，对齐 legado `menu_sort_respondTime -> sort=Respond -> upBookSource(...)` 触发语义）。
    - 验证：`flutter test test/source_list_view_sort_action_test.dart` 通过；手工路径 `书架 -> 搜索 -> 右上角设置 -> 书源管理 -> 顶栏排序 -> 响应时间排序 -> 再次顶栏排序`（确认“响应时间排序”勾选态保持）。
  - 兼容影响：无旧书源兼容性影响；本序号仅收敛 `menu_sort_respondTime` 文案与勾选态证据，不改动排序算法与持久化结构。
  - 已完成 `P2-seq121`：`book_source.xml / @+id/menu_sort_enable / 是否启用`。
  - `P2-seq121` 差异点清单（实施前）：
    - legado `menu_sort_enable` 文案为“是否启用”，且属于 `menu_group_sort` 单选组 checkable 子项；Flutter 端当前文案为“启用状态”，存在用户可见语义偏差。
    - legado 在 `BookSourceSort.Enable` 反序场景的边界是“仅反转启用分组，同组名称仍按正序比较”；Flutter 端当前实现按通用 `-compare` 反转，导致同组名称被反序，存在排序语义偏差。
    - tracker `seq121` 仍为 `pending`，缺少“是否启用勾选态 + 反序边界排序”定向回归证据，无法闭环迁移证据。
  - `P2-seq121` 逐项对照清单（实施后）：
    - 入口：已同义（位于排序菜单一级子项，层级与 legado `menu_sort_enable` 一致）。
    - 状态：已同义（点击后切换到 `_SourceSortMode.enabled`，再次打开菜单仅“是否启用”保留勾选态）。
    - 异常：已同义（仅切换本地排序模式与方向，不新增静默失败分支）。
    - 文案：已同义（菜单项文案由“启用状态”收敛为 legado 同义“是否启用”）。
    - 排版：已同义（继续使用 `CupertinoActionSheet` 子项并通过前缀 `✓` 呈现单选勾选态，平台视觉差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（点击“是否启用”后仅切换 `_sortMode=enabled` 并关闭菜单，对齐 legado `menu_sort_enable -> sort=Enable -> upBookSource(...)` 触发语义；反序时仅反转启用分组，同组名称保持正序）。
    - 验证：`flutter test test/source_list_view_sort_action_test.dart` 通过；手工路径 `书架 -> 搜索 -> 右上角设置 -> 书源管理 -> 顶栏排序 -> 是否启用 -> 反序 -> 观察列表顺序`（确认“禁用组在前，且同组名称保持正序”）。
  - 兼容影响：无旧书源兼容性影响；本序号仅收敛 `menu_sort_enable` 文案与排序边界语义，不改动书源数据结构与持久化字段。
  - 已完成 `P2-seq122`：`book_source.xml / @+id/menu_group / 分组`。
  - `P2-seq122` 差异点清单（实施前）：
    - legado `menu_group` 为顶栏一级 action（`showAsAction=always`），图标语义为分组（`ic_groups`）；Flutter 端当前入口使用 `folder` 图标，存在入口图标语义偏差。
    - 现有回归仅覆盖排序菜单，缺少 `menu_group` 入口触发与动态分组 `group:<组名>` 筛选链路的页面级证据，tracker `seq122` 仍为 `pending`。
    - 搜索页进入书源管理的回归仍断言旧图标，无法反映 `menu_group` 入口语义收敛结果。
  - `P2-seq122` 逐项对照清单（实施后）：
    - 入口：已同义（书源管理顶栏保留一级“分组”入口，图标收敛为 `CupertinoIcons.square_grid_2x2` 以对齐 legado 分组动作语义）。
    - 状态：已同义（点击入口后弹出“分组”动作面板，保持静态分组动作与动态分组列表同层级承载）。
    - 异常：已同义（分组菜单为空时不新增额外失败分支，继续由页面现有空态承载）。
    - 文案：已同义（分组菜单标题保持“分组”，与 legado `@string/menu_action_group` 语义一致）。
    - 排版：已同义（使用 `CupertinoActionSheet` 承载分组菜单，平台视觉差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（点击动态分组项后写入 `group:<组名>` 并即时筛选，等价 legado `searchView.setQuery("group:${item.title}", true)`）。
    - 验证：`flutter test test/source_list_view_sort_action_test.dart test/search_view_source_manage_action_test.dart` 通过；手工路径 `书架 -> 搜索 -> 右上角设置 -> 书源管理 -> 顶栏分组 -> 选择分组`（确认菜单弹出且列表按 `group:` 即时筛选）。
  - 兼容影响：无旧书源兼容性影响；本序号仅收敛 `menu_group` 顶栏入口图标语义并补齐回归证据，不改动书源数据结构与筛选算法。
  - 已完成 `P2-seq123`：`book_source.xml / @+id/menu_group_manage / 分组管理`。
  - `P2-seq123` 差异点清单（实施前）：
    - Flutter 端分组菜单虽已提供“分组管理”入口，但缺少与 legado `menu_group_manage -> showDialogFragment<GroupManageDialog>()` 的逐项对照记录，tracker `seq123` 仍为 `pending`。
    - 分组管理弹层文案存在细节偏差（“新增分组/重命名分组/输入分组名”），与 legado `GroupManageDialog` 的“添加分组/编辑分组/分组名称”语义不一致。
    - 现有回归证据仅覆盖分组入口与动态分组筛选，缺少 `menu_group_manage` 的入口触发与“新增分组输入弹窗”页面级证据。
  - `P2-seq123` 逐项对照清单（实施后）：
    - 入口：已同义（书源管理顶栏“分组”菜单内保留一级“分组管理”入口，点击后直接打开分组管理弹层）。
    - 状态：已同义（分组管理弹层标题固定“分组管理”，头部保留新增分组按钮；分组行保留“编辑/删除”操作入口）。
    - 异常：已同义（无分组时不新增扩展提示，保持空列表承载；不引入静默失败分支）。
    - 文案：已同义（弹层与输入弹窗文案收敛为 legado 语义：`添加分组/编辑分组/分组名称`）。
    - 排版：已同义（使用 `CupertinoPopupSurface` 承载分组管理弹层，列表行信息结构与操作热区保持 legado 同层级语义；视觉差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（`menu_group_manage` 触发分组管理弹层；新增按钮触发输入弹窗，分组行保留编辑/删除入口，不提前并入 `seq124~129` 的筛选子项语义）。
    - 验证：`flutter test test/source_list_view_sort_action_test.dart test/search_view_source_manage_action_test.dart` 通过；手工路径 `书架 -> 搜索 -> 右上角设置 -> 书源管理 -> 顶栏分组 -> 分组管理`（确认弹层打开，且可见“添加分组”输入弹窗与分组行“编辑/删除”入口）。
  - 兼容影响：无旧书源兼容性影响；本序号仅收敛 `menu_group_manage` 入口层级、弹层文案与回归证据，不改动书源数据结构与筛选算法。
  - 已完成 `P2-seq124`：`book_source.xml / @+id/menu_enabled_group / 已启用`。
  - `P2-seq124` 差异点清单（实施前）：
    - legado 在 `menu_enabled_group` 点击后执行 `searchView.setQuery(getString(R.string.enabled), true)`，查询词为“已启用”；Flutter 端当前分组菜单文案与查询词均为“启用”，存在用户可见语义偏差。
    - Flutter 端过滤逻辑仅识别“启用”关键字，无法与 legado 的“已启用”查询词完全同义，存在迁移语义断层。
    - tracker `seq124` 仍为 `pending`，缺少“已启用入口文案 + enabled 过滤结果”的定向回归证据。
  - `P2-seq124` 逐项对照清单（实施后）：
    - 入口：已同义（书源管理顶栏“分组”菜单保留一级“已启用”筛选项，层级与 legado `menu_enabled_group` 一致）。
    - 状态：已同义（点击后写入查询词“已启用”，列表即时收敛为 `enabled=true` 书源集合）。
    - 异常：已同义（仅切换查询词与筛选结果，不新增静默失败分支）。
    - 文案：已同义（筛选项文案由“启用”收敛为 legado 同义“已启用”）。
    - 排版：已同义（继续使用 `CupertinoActionSheet` 承载分组筛选项，平台视觉差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（点击“已启用”后走 `_applySearchQuery('已启用')`，等价 legado `setQuery('已启用', true)` 的即时筛选语义；并保留“启用”旧词兼容匹配，避免历史输入失效）。
    - 验证：`flutter test test/source_list_view_sort_action_test.dart test/search_view_source_manage_action_test.dart` 通过；手工路径 `书架 -> 搜索 -> 右上角设置 -> 书源管理 -> 顶栏分组 -> 已启用`（确认仅显示启用书源）。
  - 兼容影响：无旧书源兼容性影响；本序号仅收敛 `menu_enabled_group` 文案与查询词语义，不改动书源数据结构与启用状态存储字段。
  - 已完成 `P2-seq125`：`book_source.xml / @+id/menu_disabled_group / 已禁用`。
  - `P2-seq125` 差异点清单（实施前）：
    - legado 在 `menu_disabled_group` 点击后执行 `searchView.setQuery(getString(R.string.disabled), true)`，查询词为“已禁用”；Flutter 端当前分组菜单文案与查询词均为“禁用”，存在用户可见语义偏差。
    - Flutter 端过滤逻辑仅识别“禁用”关键字，无法与 legado 的“已禁用”查询词完全同义，存在迁移语义断层。
    - tracker `seq125` 仍为 `pending`，缺少“已禁用入口文案 + disabled 过滤结果”的定向回归证据。
  - `P2-seq125` 逐项对照清单（实施后）：
    - 入口：已同义（书源管理顶栏“分组”菜单保留一级“已禁用”筛选项，层级与 legado `menu_disabled_group` 一致）。
    - 状态：已同义（点击后写入查询词“已禁用”，列表即时收敛为 `enabled=false` 书源集合）。
    - 异常：已同义（仅切换查询词与筛选结果，不新增静默失败分支）。
    - 文案：已同义（筛选项文案由“禁用”收敛为 legado 同义“已禁用”）。
    - 排版：已同义（继续使用 `CupertinoActionSheet` 承载分组筛选项，平台视觉差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（点击“已禁用”后走 `_applySearchQuery('已禁用')`，等价 legado `setQuery('已禁用', true)` 的即时筛选语义；并保留“禁用”旧词兼容匹配，避免历史输入失效）。
    - 验证：`flutter test test/source_list_view_sort_action_test.dart test/search_view_source_manage_action_test.dart` 通过；手工路径 `书架 -> 搜索 -> 右上角设置 -> 书源管理 -> 顶栏分组 -> 已禁用`（确认仅显示禁用书源）。
  - 兼容影响：无旧书源兼容性影响；本序号仅收敛 `menu_disabled_group` 文案与查询词语义，不改动书源数据结构与启用状态存储字段。
  - 已完成 `P2-seq126`：`book_source.xml / @+id/menu_group_login / 需要登录`。
  - `P2-seq126` 差异点清单（实施前）：
    - legado 在 `menu_group_login` 点击后执行 `searchView.setQuery(getString(R.string.need_login), true)`，中文语义为“需要登录”；Flutter 端当前分组菜单文案与查询词均为“需登录”，存在用户可见语义偏差。
    - Flutter 端过滤逻辑仅识别“需登录”，无法与 legado 的“需要登录”查询词完全同义，存在入口文案与过滤触发解耦风险。
    - tracker `seq126` 仍为 `pending`，缺少“需要登录入口文案 + loginUrl 非空筛选结果”的定向回归证据。
  - `P2-seq126` 逐项对照清单（实施后）：
    - 入口：已同义（书源管理顶栏“分组”菜单保留一级“需要登录”筛选项，层级与 legado `menu_group_login` 一致）。
    - 状态：已同义（点击后写入查询词“需要登录”，列表即时收敛为 `loginUrl` 非空书源集合）。
    - 异常：已同义（仅切换查询词与筛选结果，不新增静默失败分支）。
    - 文案：已同义（筛选项文案由“需登录”收敛为 legado 同义“需要登录”）。
    - 排版：已同义（继续使用 `CupertinoActionSheet` 承载分组筛选项，平台视觉差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（点击“需要登录”后走 `_applySearchQuery('需要登录')`，等价 legado `setQuery('需要登录', true)` 的即时筛选语义；并保留“需登录”旧词兼容匹配，避免历史输入失效）。
    - 验证：`flutter test test/source_list_view_sort_action_test.dart --plain-name "书源管理顶栏分组入口会打开分组菜单"`、`flutter test test/source_list_view_sort_action_test.dart --plain-name "书源管理分组菜单需要登录项写入需要登录查询并即时筛选"`、`flutter test test/search_view_source_manage_action_test.dart` 通过；手工路径 `书架 -> 搜索 -> 右上角设置 -> 书源管理 -> 顶栏分组 -> 需要登录`（确认仅显示存在登录地址的书源）。
  - 兼容影响：无旧书源兼容性影响；本序号仅收敛 `menu_group_login` 文案与查询词语义，不改动书源数据结构与登录字段持久化逻辑。
  - 已完成 `P2-seq127`：`book_source.xml / @+id/menu_group_null / 未分组`。
  - `P2-seq127` 差异点清单（实施前）：
    - legado 在 `menu_group_null` 点击后执行 `searchView.setQuery(getString(R.string.no_group), true)`，中文语义为“未分组”；Flutter 端当前分组菜单文案与查询词为“无分组”，存在用户可见语义偏差。
    - Flutter 端过滤逻辑仅识别“无分组”，无法与 legado 的“未分组”查询词完全同义，存在入口文案与过滤触发解耦风险。
    - tracker `seq127` 仍为 `pending`，缺少“未分组入口文案 + no_group 筛选结果”的定向回归证据。
  - `P2-seq127` 逐项对照清单（实施后）：
    - 入口：已同义（书源管理顶栏“分组”菜单保留一级“未分组”筛选项，层级与 legado `menu_group_null` 一致）。
    - 状态：已同义（点击后写入查询词“未分组”，列表即时收敛为 `bookSourceGroup` 为空或包含“未分组”的书源集合）。
    - 异常：已同义（仅切换查询词与筛选结果，不新增静默失败分支）。
    - 文案：已同义（筛选项文案由“无分组”收敛为 legado 同义“未分组”）。
    - 排版：已同义（继续使用 `CupertinoActionSheet` 承载分组筛选项，平台视觉差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（点击“未分组”后走 `_applySearchQuery('未分组')`，等价 legado `setQuery('未分组', true)` 的即时筛选语义；并保留“无分组”旧词兼容匹配，避免历史输入失效）。
    - 验证：`flutter test test/source_list_view_sort_action_test.dart --plain-name "书源管理顶栏分组入口会打开分组菜单"`、`flutter test test/source_list_view_sort_action_test.dart --plain-name "书源管理分组菜单未分组项写入未分组查询并即时筛选"`、`flutter test test/search_view_source_manage_action_test.dart` 通过；手工路径 `书架 -> 搜索 -> 右上角设置 -> 书源管理 -> 顶栏分组 -> 未分组`（确认仅显示分组为空或包含“未分组”的书源）。
  - 兼容影响：无旧书源兼容性影响；本序号仅收敛 `menu_group_null` 文案与查询词语义，不改动书源数据结构与分组字段持久化逻辑。
  - 已完成 `P2-seq128`：`book_source.xml / @+id/menu_enabled_explore_group / 已启用发现`。
  - `P2-seq128` 差异点清单（实施前）：
    - legado 在 `menu_enabled_explore_group` 点击后执行 `searchView.setQuery(getString(R.string.enabled_explore), true)`，中文语义为“已启用发现”；Flutter 端当前分组菜单文案与查询词为“启用发现”，存在用户可见语义偏差。
    - Flutter 端过滤逻辑仅识别“启用发现”，无法与 legado 的“已启用发现”查询词完全同义，存在入口文案与过滤触发解耦风险。
    - tracker `seq128` 仍为 `pending`，缺少“已启用发现入口文案 + enabledExplore=true 筛选结果”的定向回归证据。
  - `P2-seq128` 逐项对照清单（实施后）：
    - 入口：已同义（书源管理顶栏“分组”菜单保留一级“已启用发现”筛选项，层级与 legado `menu_enabled_explore_group` 一致）。
    - 状态：已同义（点击后写入查询词“已启用发现”，列表即时收敛为 `enabledExplore=true` 书源集合）。
    - 异常：已同义（仅切换查询词与筛选结果，不新增静默失败分支）。
    - 文案：已同义（筛选项文案由“启用发现”收敛为 legado 同义“已启用发现”）。
    - 排版：已同义（继续使用 `CupertinoActionSheet` 承载分组筛选项，平台视觉差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（点击“已启用发现”后走 `_applySearchQuery('已启用发现')`，等价 legado `setQuery('已启用发现', true)` 的即时筛选语义；并保留“启用发现”旧词兼容匹配，避免历史输入失效）。
    - 验证：`flutter test test/source_list_view_sort_action_test.dart --plain-name "书源管理顶栏分组入口会打开分组菜单"`、`flutter test test/source_list_view_sort_action_test.dart --plain-name "书源管理分组菜单已启用发现项写入已启用发现查询并即时筛选"` 通过；手工路径 `书架 -> 搜索 -> 右上角设置 -> 书源管理 -> 顶栏分组 -> 已启用发现`（确认仅显示启用发现的书源）。
  - 兼容影响：无旧书源兼容性影响；本序号仅收敛 `menu_enabled_explore_group` 文案与查询词语义，不改动书源数据结构与发现开关持久化逻辑。
  - 已完成 `P2-seq129`：`book_source.xml / @+id/menu_disabled_explore_group / 已禁用发现`。
  - `P2-seq129` 差异点清单（实施前）：
    - legado 在 `menu_disabled_explore_group` 点击后执行 `searchView.setQuery(getString(R.string.disabled_explore), true)`，中文语义为“已禁用发现”；Flutter 端当前分组菜单文案与查询词为“禁用发现”，存在用户可见语义偏差。
    - Flutter 端过滤逻辑仅识别“禁用发现”，无法与 legado 的“已禁用发现”查询词完全同义，存在入口文案与过滤触发解耦风险。
    - tracker `seq129` 仍为 `pending`，缺少“已禁用发现入口文案 + enabledExplore=false 筛选结果”的定向回归证据。
  - `P2-seq129` 逐项对照清单（实施后）：
    - 入口：已同义（书源管理顶栏“分组”菜单保留一级“已禁用发现”筛选项，层级与 legado `menu_disabled_explore_group` 一致）。
    - 状态：已同义（点击后写入查询词“已禁用发现”，列表即时收敛为 `enabledExplore=false` 书源集合）。
    - 异常：已同义（仅切换查询词与筛选结果，不新增静默失败分支）。
    - 文案：已同义（筛选项文案由“禁用发现”收敛为 legado 同义“已禁用发现”）。
    - 排版：已同义（继续使用 `CupertinoActionSheet` 承载分组筛选项，平台视觉差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（点击“已禁用发现”后走 `_applySearchQuery('已禁用发现')`，等价 legado `setQuery('已禁用发现', true)` 的即时筛选语义；并保留“禁用发现”旧词兼容匹配，避免历史输入失效）。
    - 验证：`flutter test test/source_list_view_sort_action_test.dart --plain-name "书源管理顶栏分组入口会打开分组菜单"`、`flutter test test/source_list_view_sort_action_test.dart --plain-name "书源管理分组菜单已禁用发现项写入已禁用发现查询并即时筛选"` 通过；手工路径 `书架 -> 搜索 -> 右上角设置 -> 书源管理 -> 顶栏分组 -> 已禁用发现`（确认仅显示禁用发现的书源）。
  - 兼容影响：无旧书源兼容性影响；本序号仅收敛 `menu_disabled_explore_group` 文案与查询词语义，不改动书源数据结构与发现开关持久化逻辑。
  - 已完成 `P2-seq130`：`book_source.xml / @+id/menu_add_book_source / 新建书源`。
  - `P2-seq130` 差异点清单（实施前）：
    - legado `menu_add_book_source` 位于书源管理溢出菜单，点击后直接进入 `BookSourceEditActivity`；Flutter 端虽已存在“更多 -> 新建书源”入口，但当前序号缺少逐项迁移证据闭环。
    - tracker `seq130` 仍为 `pending`，缺少“入口层级 + 触发路径 + 默认状态”的定向回归证据，无法宣称完成同义迁移。
    - 既有回归主要覆盖排序/分组子菜单，未单独验证“新建书源”入口点击后是否进入书源编辑页且默认保持 legado 同义配置状态。
  - `P2-seq130` 逐项对照清单（实施后）：
    - 入口：已同义（书源管理页“更多”菜单保留一级“新建书源”入口，对齐 legado `menu_add_book_source` 的溢出菜单层级语义）。
    - 状态：已同义（点击后进入“书源编辑”页，基础字段与顶部开关可见，默认“自动保存Cookie”为开启状态）。
    - 异常：已同义（不新增静默失败分支；导航失败仍走 Flutter 路由异常链路可观测输出）。
    - 文案：已同义（菜单项文案保持“新建书源”）。
    - 排版：已同义（使用 `CupertinoActionSheet` 承载“更多”菜单与 `AppCupertinoPageScaffold` 承载编辑页，平台视觉差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（点击“新建书源”后打开 `SourceEditLegacyView`，对齐 legado `menu_add_book_source -> startActivity<BookSourceEditActivity>()` 的入口触发语义）。
    - 验证：`flutter test test/source_list_view_sort_action_test.dart --plain-name "书源管理更多菜单新建书源入口会打开书源编辑页"` 通过；手工路径 `书架 -> 搜索 -> 右上角设置 -> 书源管理 -> 右上角更多 -> 新建书源`（确认进入书源编辑页且可见“自动保存Cookie”开启态）。
  - 兼容影响：无旧书源兼容性影响；本序号仅补齐 `menu_add_book_source` 入口语义与验证证据，不改动书源持久化结构与导入链路。
  - 已完成 `P2-seq131`：`book_source.xml / @+id/menu_import_local / 本地导入`。
  - `P2-seq131` 差异点清单（实施前）：
    - legado `book_source.xml` 将 `menu_import_local` 文案定义为 `@string/import_local`（“本地导入”）；Flutter 端“更多”菜单文案为“从文件导入”，存在用户可见语义偏差。
    - legado `BookSourceActivity.onCompatOptionsItemSelected` 在 `menu_import_local` 分支直接触发文件导入链路（`HandleFileContract.FILE + txt/json`）；Flutter 端已具备导入实现，但缺少本序号的逐项迁移证据闭环。
    - 网络导入 CORS 降级提示仍使用“从文件导入”旧文案，与本序号“本地导入”口径不一致。
  - `P2-seq131` 逐项对照清单（实施后）：
    - 入口：已同义（书源管理页“更多”菜单保留一级“本地导入”入口，对齐 legado `menu_import_local` 层级）。
    - 状态：已同义（点击后进入本地文件导入链路，支持 `txt/json` 文件输入）。
    - 异常：已同义（本地导入失败仍走可观测错误提示链路，不新增静默失败分支）。
    - 文案：已同义（菜单文案由“从文件导入”收敛为“本地导入”；网络导入 CORS 提示同步收敛为“本地导入”）。
    - 排版：已同义（继续使用 `CupertinoActionSheet` 承载“更多”菜单，平台视觉差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（点击“本地导入”后调用 `_importFromFile()`，对应 legado `menu_import_local -> importDoc.launch(FILE, txt/json)` 的入口触发语义）。
    - 验证：`flutter test test/source_list_view_sort_action_test.dart --plain-name "书源管理更多菜单本地导入入口文案与 legado 一致"`、`flutter test test/source_import_export_service_test.dart --plain-name "importFromUrl returns actionable CORS hint on web"` 通过；手工路径 `书架 -> 搜索 -> 右上角设置 -> 书源管理 -> 右上角更多 -> 本地导入`（确认入口文案与触发链路同义）。
  - 兼容影响：无旧书源兼容性影响；本序号仅收敛 `menu_import_local` 入口文案与提示口径，不改动导入解析策略与书源存储结构。
  - 已完成 `P2-seq132`：`book_source.xml / @+id/menu_import_onLine / 网络导入`。
  - `P2-seq132` 差异点清单（实施前）：
    - legado `book_source.xml` 将 `menu_import_onLine` 文案定义为 `@string/import_on_line`（“网络导入”）；Flutter 端“更多”菜单文案为“从网络导入”，存在用户可见语义偏差。
    - legado `BookSourceActivity.showImportDialog()` 使用 `import_on_line` 作为弹层标题并以 `url` 作为输入提示；Flutter 端弹层标题为“在线导入”、输入占位为“输入书源链接（http/https）”，与 legado 文案口径不一致。
    - 导入错误提示中仍存在“文件导入”旧文案，与 `menu_import_local` 已收敛为“本地导入”的语义不一致，导致同链路文案漂移。
  - `P2-seq132` 逐项对照清单（实施后）：
    - 入口：已同义（书源管理页“更多”菜单保留一级“网络导入”入口，对齐 legado `menu_import_onLine` 层级）。
    - 状态：已同义（点击后打开网络导入输入弹层，并保留历史导入记录展示与删除能力）。
    - 异常：已同义（网络导入失败仍走可观测错误提示链路；Web 跨域降级建议口径与本地导入入口一致）。
    - 文案：已同义（菜单文案由“从网络导入”收敛为“网络导入”；弹层标题由“在线导入”收敛为“网络导入”；输入占位收敛为“输入书源网址”；跨域提示统一为“本地导入”）。
    - 排版：已同义（继续使用 `CupertinoActionSheet + CupertinoPopupSurface` 承载入口与输入弹层，平台视觉差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（点击“网络导入”后调用 `_importFromUrl()`，对应 legado `menu_import_onLine -> showImportDialog()` 的入口触发语义）。
    - 验证：`flutter test test/source_list_view_sort_action_test.dart --plain-name "书源管理更多菜单网络导入入口文案与 legado 一致"`、`flutter test test/source_import_export_service_test.dart --plain-name "importFromUrl returns actionable CORS hint on web"` 通过；手工路径 `书架 -> 搜索 -> 右上角设置 -> 书源管理 -> 右上角更多 -> 网络导入`（确认入口文案、弹层标题与导入提示口径同义）。
  - 兼容影响：无旧书源兼容性影响；本序号仅收敛 `menu_import_onLine` 文案与提示口径，不改动导入解析策略与书源存储结构。
  - 已完成 `P2-seq133`：`book_source.xml / @+id/menu_import_qr / 二维码导入`。
  - `P2-seq133` 差异点清单（实施前）：
    - legado `book_source.xml` 将 `menu_import_qr` 文案定义为 `@string/import_by_qr_code`（“二维码导入”）；Flutter 端“更多”菜单文案为“扫码导入”，存在用户可见语义偏差。
    - legado `BookSourceActivity.onCompatOptionsItemSelected` 在 `menu_import_qr` 分支执行 `qrResult.launch()`，扫码结果回调后直接进入 `ImportBookSourceDialog`；Flutter 端虽已具备扫码导入能力，但保留了“扫码 URL 自动写入网络导入历史”的扩展路径，存在行为偏差风险。
    - tracker `seq133` 仍为 `pending`，缺少“入口文案 + 触发路径”的可复现验证证据，无法闭环本序号迁移记录。
  - `P2-seq133` 逐项对照清单（实施后）：
    - 入口：已同义（书源管理页“更多”菜单保留一级“二维码导入”入口，对齐 legado `menu_import_qr` 层级）。
    - 状态：已同义（点击后进入扫码页；扫码取消时直接返回，不触发导入链路）。
    - 异常：已同义（扫码结果为空时保持静默返回，不新增错误提示分支）。
    - 文案：已同义（菜单文案由“扫码导入”收敛为 legado 同义“二维码导入”）。
    - 排版：已同义（继续使用 `CupertinoActionSheet` 承载“更多”菜单，平台视觉差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（点击“二维码导入”后调用 `_importFromQrCode()`，扫码结果统一走 `importFromText` 进入导入解析链路，等价 legado “扫码结果直接进入导入弹层”语义；移除扫码 URL 写入网络导入历史的扩展行为）。
    - 验证：`flutter test test/source_list_view_sort_action_test.dart --plain-name "书源管理更多菜单"` 通过；手工路径 `书架 -> 搜索 -> 右上角设置 -> 书源管理 -> 右上角更多 -> 二维码导入`（确认入口文案与触发路径同义，取消扫码不触发导入）。
  - 兼容影响：无旧书源兼容性影响；本序号仅收敛 `menu_import_qr` 入口文案与触发边界，不改动书源解析规则与持久化结构。
  - 已完成 `P2-seq134`：`book_source.xml / @+id/menu_group_sources_by_domain / 按域名分组显示`。
  - `P2-seq134` 差异点清单（实施前）：
    - legado `book_source.xml` 将 `menu_group_sources_by_domain` 定义为 `checkable` 菜单项，标题固定为“按域名分组显示”；Flutter 端当前实现为“按域名分组/关闭按域名分组”动态文案，存在用户可见语义偏差。
    - legado `BookSourceActivity.onCompatOptionsItemSelected` 通过 `item.isChecked` 表达开关状态并复用同一文案；Flutter 端缺少勾选态反馈，无法等价表达 checkable 语义。
    - tracker `seq134` 仍为 `pending`，缺少“固定文案 + 勾选态切换 + 域名分组生效”的可复现验证证据，无法闭环本序号迁移记录。
  - `P2-seq134` 逐项对照清单（实施后）：
    - 入口：已同义（书源管理页“更多”菜单保留一级“按域名分组显示”入口，对齐 legado `menu_group_sources_by_domain` 层级）。
    - 状态：已同义（关闭态显示“按域名分组显示”；开启后再次打开菜单显示“✓ 按域名分组显示”，与 legado checkable 语义同义）。
    - 异常：已同义（仅切换分组状态与列表排序，不新增静默失败分支）。
    - 文案：已同义（移除“关闭按域名分组”扩展文案，统一为固定“按域名分组显示”）。
    - 排版：已同义（继续使用 `CupertinoActionSheet` 承载“更多”菜单，平台视觉差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（点击后切换 `_groupSourcesByDomain`，列表按“域名升序 + 同域名按更新时间降序”重排并展示域名分组头，对齐 legado `groupSourcesByDomain + adapter.showSourceHost` 联动语义）。
    - 验证：`flutter test test/source_list_view_sort_action_test.dart --plain-name "书源管理更多菜单按域名分组显示为勾选态切换语义"` 通过；手工路径 `书架 -> 搜索 -> 右上角设置 -> 书源管理 -> 右上角更多 -> 按域名分组显示`（确认文案固定、勾选态可见、列表出现域名分组头）。
  - 兼容影响：无旧书源兼容性影响；本序号仅收敛 `menu_group_sources_by_domain` 的菜单文案与勾选态语义，不改动书源数据结构与持久化字段。
  - 已完成 `P2-seq135`：`book_source.xml / @+id/menu_help / 帮助`。
  - `P2-seq135` 差异点清单（实施前）：
    - legado `BookSourceActivity` 在 `menu_help` 分支固定执行 `showHelp("SourceMBookHelp")`；Flutter 端书源管理页“帮助”动作仅展示 `SourceHelpTexts.manage` 简版文本，未加载 legado 同源帮助文档资产，语义不一致。
    - legado 首次进入书源管理页与菜单帮助均复用 `SourceMBookHelp` 文档链路；Flutter 端首次提示与菜单帮助虽复用同一方法，但内容仍为扩展简版文本，存在文案与结构偏差。
    - 当前资产目录缺少 `assets/web/help/md/SourceMBookHelp.md`，无法对齐 legado 帮助文档内容与入口触发语义。
  - `P2-seq135` 逐项对照清单（实施后）：
    - 入口：已同义（书源管理页“更多”菜单保留一级“帮助”入口，对齐 legado `menu_help` 层级）。
    - 状态：已同义（点击帮助后弹出帮助对话框；首次进入书源管理在未标记已读时自动展示同一帮助文档）。
    - 异常：已同义（文档加载失败时展示“帮助文档加载失败：<原因>”可观测提示，不新增静默失败分支）。
    - 文案：已同义（帮助内容切换为 legado 同源 `SourceMBookHelp.md` 文档，不再使用本地扩展简版文案）。
    - 排版：已同义（复用现有 `showAppHelpDialog` 弹层承载文档，平台视觉差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（菜单 `menu_help` 与首次进入引导均调用同一 `_showSourceManageHelp()`，等价 legado `showHelp("SourceMBookHelp")` 的统一触发语义）。
    - 验证：`flutter test test/source_list_view_sort_action_test.dart --plain-name "书源管理更多菜单帮助入口会打开帮助弹层"` 通过；手工路径 `书架 -> 搜索 -> 右上角设置 -> 书源管理 -> 右上角更多 -> 帮助`（确认弹层展示 SourceMBookHelp 文档内容）。
  - 兼容影响：无旧书源兼容性影响；本序号仅收敛 `menu_help` 帮助文档触发与展示语义，不改动书源解析、校验与持久化链路。
  - 已完成 `P2-seq136`：`book_source_debug.xml / @+id/menu_scan / 扫描二维码`。
  - `P2-seq136` 差异点清单（实施前）：
    - legado `book_source_debug.xml` 将 `menu_scan` 定义为顶栏常驻动作，标题语义来自 `@string/scan_qr_code`（“扫描二维码”）；Flutter 端调试页扫码调用 `QrScanService.scanText(..., title: "扫码调试")`，存在用户可见文案偏差。
    - legado `BookSourceDebugActivity` 在 `menu_scan` 点击后直接执行 `qrCodeResult.launch()`，扫码结果回调进入 `startSearch(it)`；Flutter 端虽具备扫码入口，但缺少“点击即触发扫码动作”可控回归证据。
    - tracker `seq136` 仍为 `pending`，缺少 `menu_scan` 的单项迁移记录与验证证据，无法闭环本序号。
  - `P2-seq136` 逐项对照清单（实施后）：
    - 入口：已同义（书源调试页顶栏保留二维码图标一级入口，对齐 legado `menu_scan` 常驻 action 语义）。
    - 状态：已同义（点击顶栏扫码入口后直接发起扫码链路；取消扫码保持静默返回）。
    - 异常：已同义（扫码结果为空/取消时不触发调试流程，不新增扩展失败提示）。
    - 文案：已同义（扫码页标题由“扫码调试”收敛为 legado 同义“扫描二维码”）。
    - 排版：已同义（继续使用 `CupertinoNavigationBar` 顶栏 action 承载扫码入口，平台视觉差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（点击 `menu_scan` 对应图标后执行扫码启动器；扫码返回文本后按既有调试链路进入 `_runDebug`，等价 legado “扫码结果直达 startSearch”语义）。
    - 验证：`flutter test test/source_debug_legacy_view_scan_action_test.dart test/source_debug_legacy_view_compile_test.dart` 通过；手工路径 `书架 -> 搜索 -> 右上角设置 -> 书源管理 -> 长按书源卡片 -> 调试 -> 顶栏扫码图标`（确认触发扫码页且标题为“扫描二维码”）。
  - 兼容影响：无旧书源兼容性影响；本序号仅收敛 `menu_scan` 的标题文案与触发可测性，不改动书源调试解析、日志输出与数据持久化链路。
  - 已完成 `P2-seq137`：`book_source_debug.xml / @+id/menu_search_src / 搜索源码`。
  - `P2-seq137` 差异点清单（实施前）：
    - legado `BookSourceDebugActivity` 在 `menu_search_src` 点击后直接执行 `showDialogFragment(TextDialog("html", viewModel.searchSrc))`；Flutter 端当前实现会在源码为空时额外拦截并提示“暂无搜索源码”，存在状态流转偏差。
    - legado 源码承载标题固定为 `html`；Flutter 端当前“搜索源码”路径使用“搜索源码”作为承载标题，存在用户可见文案偏差。
    - tracker `seq137` 仍为 `pending`，缺少 `menu_search_src` 的单项迁移记录与验证证据，无法闭环本序号。
  - `P2-seq137` 逐项对照清单（实施后）：
    - 入口：已同义（书源调试页“更多”菜单保留一级“搜索源码”动作，对齐 legado `menu_search_src` 层级）。
    - 状态：已同义（点击后直接进入源码承载页；源码为空时也保持可进入，不再新增拦截分支）。
    - 异常：已同义（移除“暂无搜索源码”扩展提示分支，不新增静默失败路径）。
    - 文案：已同义（源码承载标题收敛为 legacy 同义 `html`）。
    - 排版：已同义（继续使用 `CupertinoPageRoute` 承载源码文本，平台视觉差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（点击 `menu_search_src` 后直接打开源码承载页，等价 legado `TextDialog` 直接展示内容语义）。
    - 验证：`flutter test test/source_debug_legacy_view_search_src_action_test.dart test/source_debug_legacy_view_scan_action_test.dart test/source_debug_legacy_view_compile_test.dart` 通过；手工路径 `书架 -> 搜索 -> 右上角设置 -> 书源管理 -> 长按书源卡片 -> 调试 -> 右上角更多 -> 搜索源码`（确认源码为空时也直接打开承载页且标题为 `html`）。
  - 兼容影响：无旧书源兼容性影响；本序号仅收敛 `menu_search_src` 触发与标题语义，不改动调试执行链路与源码采集逻辑。
  - 已完成 `P2-seq138`：`book_source_debug.xml / @+id/menu_book_src / 书籍源码`。
  - `P2-seq138` 差异点清单（实施前）：
    - legado `BookSourceDebugActivity` 在 `menu_book_src` 点击后直接执行 `showDialogFragment(TextDialog("html", viewModel.bookSrc))`；Flutter 端当前实现会在源码为空时额外拦截并提示“暂无详情源码”，存在状态流转偏差。
    - legado 源码承载标题固定为 `html`，且菜单文案为 `boo_src=书籍源码`；Flutter 端当前“详情源码”路径使用“详情源码”作为菜单与承载标题，存在用户可见文案偏差。
    - tracker `seq138` 仍为 `pending`，缺少 `menu_book_src` 的单项迁移记录与验证证据，无法闭环本序号。
  - `P2-seq138` 逐项对照清单（实施后）：
    - 入口：已同义（书源调试页“更多”菜单保留一级“书籍源码”动作，对齐 legado `menu_book_src` 层级）。
    - 状态：已同义（点击后直接进入源码承载页；源码为空时也保持可进入，不再新增拦截分支）。
    - 异常：已同义（移除“暂无详情源码/暂无书籍源码”扩展提示分支，不新增静默失败路径）。
    - 文案：已同义（菜单文案收敛为 legado 同义“书籍源码”，源码承载标题收敛为 `html`）。
    - 排版：已同义（继续使用 `CupertinoPageRoute` 承载源码文本，平台视觉差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（点击 `menu_book_src` 后直接打开源码承载页，等价 legado `TextDialog("html", bookSrc)` 直接展示内容语义）。
    - 验证：`flutter test test/source_debug_legacy_view_book_src_action_test.dart test/source_debug_legacy_view_search_src_action_test.dart test/source_debug_legacy_view_scan_action_test.dart test/source_debug_legacy_view_compile_test.dart` 通过；手工路径 `书架 -> 搜索 -> 右上角设置 -> 书源管理 -> 长按书源卡片 -> 调试 -> 右上角更多 -> 书籍源码`（确认源码为空时也直接打开承载页且标题为 `html`）。
  - 兼容影响：无旧书源兼容性影响；本序号仅收敛 `menu_book_src` 触发、文案与标题语义，不改动调试执行链路与源码采集逻辑。
  - 已完成 `P2-seq139`：`book_source_debug.xml / @+id/menu_toc_src / 目录源码`。
  - `P2-seq139` 差异点清单（实施前）：
    - legado `BookSourceDebugActivity` 在 `menu_toc_src` 点击后直接执行 `showDialogFragment(TextDialog("html", viewModel.tocSrc))`；Flutter 端当前实现复用了 `_openRawSource(title: "目录源码", raw: _tocSrcRaw)`，源码为空时会额外拦截并提示“暂无目录源码”，存在状态流转偏差。
    - legado 源码承载标题固定为 `html`；Flutter 端当前“目录源码”路径使用“目录源码”作为承载标题，存在用户可见文案偏差。
    - tracker `seq139` 仍为 `pending`，缺少 `menu_toc_src` 的单项迁移记录与验证证据，无法闭环本序号。
  - `P2-seq139` 逐项对照清单（实施后）：
    - 入口：已同义（书源调试页“更多”菜单保留一级“目录源码”动作，对齐 legado `menu_toc_src` 层级）。
    - 状态：已同义（点击后直接进入源码承载页；源码为空时也保持可进入，不再新增拦截分支）。
    - 异常：已同义（移除“暂无目录源码”扩展提示分支，不新增静默失败路径）。
    - 文案：已同义（源码承载标题收敛为 legacy 同义 `html`）。
    - 排版：已同义（继续使用 `CupertinoPageRoute` 承载源码文本，平台视觉差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（点击 `menu_toc_src` 后直接打开源码承载页，等价 legado `TextDialog("html", tocSrc)` 直接展示内容语义）。
    - 验证：`flutter test test/source_debug_legacy_view_toc_src_action_test.dart test/source_debug_legacy_view_book_src_action_test.dart test/source_debug_legacy_view_search_src_action_test.dart test/source_debug_legacy_view_scan_action_test.dart test/source_debug_legacy_view_compile_test.dart` 通过；手工路径 `书架 -> 搜索 -> 右上角设置 -> 书源管理 -> 长按书源卡片 -> 调试 -> 右上角更多 -> 目录源码`（确认源码为空时也直接打开承载页且标题为 `html`）。
  - 兼容影响：无旧书源兼容性影响；本序号仅收敛 `menu_toc_src` 触发与标题语义，不改动调试执行链路与源码采集逻辑。
  - 已完成 `P2-seq140`：`book_source_debug.xml / @+id/menu_content_src / 正文源码`。
  - `P2-seq140` 差异点清单（实施前）：
    - legado `BookSourceDebugActivity` 在 `menu_content_src` 点击后直接执行 `showDialogFragment(TextDialog("html", viewModel.contentSrc))`；Flutter 端当前实现复用了 `_openRawSource(title: "正文源码", raw: _contentSrcRaw)`，源码为空时会额外拦截并提示“暂无正文源码”，存在状态流转偏差。
    - legado 源码承载标题固定为 `html`；Flutter 端当前“正文源码”路径使用“正文源码”作为承载标题，存在用户可见文案偏差。
    - tracker `seq140` 仍为 `pending`，缺少 `menu_content_src` 的单项迁移记录与验证证据，无法闭环本序号。
  - `P2-seq140` 逐项对照清单（实施后）：
    - 入口：已同义（书源调试页“更多”菜单保留一级“正文源码”动作，对齐 legado `menu_content_src` 层级）。
    - 状态：已同义（点击后直接进入源码承载页；源码为空时也保持可进入，不再新增拦截分支）。
    - 异常：已同义（移除“暂无正文源码”扩展提示分支，不新增静默失败路径）。
    - 文案：已同义（源码承载标题收敛为 legacy 同义 `html`）。
    - 排版：已同义（继续使用 `CupertinoPageRoute` 承载源码文本，平台视觉差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（点击 `menu_content_src` 后直接打开源码承载页，等价 legado `TextDialog("html", contentSrc)` 直接展示内容语义）。
    - 验证：`flutter test test/source_debug_legacy_view_content_src_action_test.dart test/source_debug_legacy_view_toc_src_action_test.dart test/source_debug_legacy_view_book_src_action_test.dart test/source_debug_legacy_view_search_src_action_test.dart test/source_debug_legacy_view_scan_action_test.dart test/source_debug_legacy_view_compile_test.dart` 通过；手工路径 `书架 -> 搜索 -> 右上角设置 -> 书源管理 -> 长按书源卡片 -> 调试 -> 右上角更多 -> 正文源码`（确认源码为空时也直接打开承载页且标题为 `html`）。
  - 兼容影响：无旧书源兼容性影响；本序号仅收敛 `menu_content_src` 触发与标题语义，不改动调试执行链路与源码采集逻辑。
  - 已完成 `P2-seq141`：`book_source_debug.xml / @+id/menu_refresh_explore / 刷新发现`。
  - `P2-seq141` 差异点清单（实施前）：
    - legado `BookSourceDebugActivity` 在 `menu_refresh_explore` 点击后执行 `clearExploreKindsCache -> adapter.clearItems -> openOrCloseHelp(true) -> initExploreKinds()`；Flutter 端虽已存在 `_refreshExploreKinds()`，但缺少“清缓存 + 强制重载 + 帮助区恢复 + 日志清空”的单项可复现证据。
    - Flutter 端 `SourceDebugLegacyView` 将发现分类服务实例内置在组件状态内，测试环境难以稳定注入“首次失败、刷新后成功”的对照场景，导致本序号无法闭环迁移验收证据。
    - tracker `seq141` 仍为 `pending`，缺少 `menu_refresh_explore` 的单项迁移记录与验证证据，无法闭环本序号。
  - `P2-seq141` 逐项对照清单（实施后）：
    - 入口：已同义（书源调试页“更多”菜单保留一级“刷新发现”动作，对齐 legado `menu_refresh_explore` 层级）。
    - 状态：已同义（点击后先清理发现缓存，再清空调试日志，帮助区恢复可见，并强制重载发现分类）。
    - 异常：已同义（发现分类重载失败仍走可观测日志输出，不新增静默失败分支）。
    - 文案：已同义（菜单文案保持 legado 同义“刷新发现”）。
    - 排版：已同义（继续使用 `CupertinoActionSheet` 承载“更多”菜单，平台视觉差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（点击 `menu_refresh_explore` 后调用 `_refreshExploreKinds()`，其顺序为 `clearExploreKindsCache -> _events.clear + _helpVisible=true + _selectedExploreIndex=0 -> _loadExploreKinds(forceRefresh: true)`，与 legado 刷新发现状态流转同义）。
    - 验证：`flutter test test/source_debug_legacy_view_refresh_explore_action_test.dart test/source_debug_legacy_view_compile_test.dart` 通过；手工路径 `书架 -> 搜索 -> 右上角设置 -> 书源管理 -> 长按书源卡片 -> 调试 -> 右上角更多 -> 刷新发现`（确认刷新后帮助区可见、日志区清空、发现快捷项重新加载）。
  - 兼容影响：无旧书源兼容性影响；本序号仅补齐 `menu_refresh_explore` 的可测性注入点与验证证据，不改动调试主链路与书源数据结构。
  - 已完成 `P2-seq142`：`book_source_debug.xml / @+id/menu_help / 帮助`。
  - `P2-seq142` 差异点清单（实施前）：
    - legado `BookSourceDebugActivity` 在 `menu_help` 点击后执行 `showHelp("debugHelp")`，会读取 `assets/web/help/md/debugHelp.md` 并以帮助弹层展示 Markdown 文档。
    - Flutter 端当前 `menu_help` 仍执行 `_showMessage(SourceHelpTexts.debug)`，属于内置提示文本弹窗，不是 legado 的文档帮助链路，交互语义与文档来源均不一致。
    - Flutter 资产目录中缺少 `debugHelp.md`，即使改造为文档弹层也无法等价复现 legado 内容。
  - `P2-seq142` 逐项对照清单（实施后）：
    - 入口：已同义（书源调试页“更多”菜单保留一级“帮助”动作，对齐 legado `menu_help` 层级）。
    - 状态：已同义（点击后读取 `debugHelp.md` 并打开帮助弹层，等价 legado `showHelp("debugHelp")` 文档链路）。
    - 异常：已同义（文档加载失败时给出“帮助文档加载失败：<error>”可观测提示，不新增静默失败分支）。
    - 文案：已同义（动作文案保持“帮助”，帮助弹层标题保持“帮助”）。
    - 排版：已同义（复用统一 `showAppHelpDialog` 承载文档内容，平台视觉差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（点击 `menu_help` 后调用 `_showDebugHelp()`，先从 `assets/web/help/md/debugHelp.md` 读取文档，再展示帮助弹层）。
    - 验证：`flutter test test/source_debug_legacy_view_help_action_test.dart test/source_debug_legacy_view_refresh_explore_action_test.dart test/source_debug_legacy_view_compile_test.dart` 通过；手工路径 `书架 -> 搜索 -> 右上角设置 -> 书源管理 -> 长按书源卡片 -> 调试 -> 右上角更多 -> 帮助`（确认打开帮助弹层并展示 `debugHelp.md` 文档内容）。
  - 兼容影响：无旧书源兼容性影响；本序号仅收敛 `menu_help` 的文档帮助链路与资产，不改动调试执行主链路。
  - 已完成 `P2-seq143`：`book_source_item.xml / @+id/menu_top / 置顶`。
  - `P2-seq143` 差异点清单（实施前）：
    - legado `BookSourceAdapter.showMenu` 仅在 `sort == BookSourceSort.Default` 显示 `menu_top`，点击后走 `callBack.toTop(source)`；`BookSourceActivity.toTop` 再按 `sortAscending` 分流到 `viewModel.topSource/bottomSource`，形成“反序时置顶走底序写库”的边界语义。
    - Flutter 端虽已有条目“置顶”入口与 `_toTop`，但缺少可复现证据证明“仅手动排序展示入口 + 反序时 `toTop=false` 分流”这两条关键语义。
    - `widget test` 场景下条目菜单触发置顶会命中 Drift 批量写库阻塞，导致迁移证据无法稳定闭环。
  - `P2-seq143` 逐项对照清单（实施后）：
    - 入口：已同义（书源条目“更多”菜单仅在手动排序展示“置顶”，对齐 legado `menu_top` 可见性边界）。
    - 状态：已同义（点击 `menu_top` 后进入 `_toTop`；升序传递 `toTop=true`，反序传递 `toTop=false`，对齐 legado `toTop -> topSource/bottomSource` 分流语义）。
    - 异常：已同义（未新增成功弹窗或失败静默分支；沿用原有可观测链路）。
    - 文案：已同义（动作文案保持“置顶”，无扩展文案漂移）。
    - 排版：已同义（继续使用 `CupertinoActionSheet` 承载条目菜单，平台视觉差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（条目“更多”菜单点击 `menu_top` 后直接进入置顶链路，等价 legado `menu_top -> CallBack.toTop(bookSource)`）。
    - 验证：`flutter test test/source_list_view_item_top_action_test.dart test/source_list_view_compile_test.dart` 通过；手工路径 `书架 -> 搜索 -> 右上角设置 -> 书源管理 -> 书源条目右侧更多 -> 置顶`（确认手动排序显示入口，切换“反序”后再次点击“置顶”按 legacy 语义走反向分流）。
  - 兼容影响：无旧书源兼容性影响；本序号仅补齐 `menu_top` 的入口可见性/分流语义与回归证据，不改动书源数据结构与导入链路。
  - 已完成 `P2-seq144`：`book_source_item.xml / @+id/menu_bottom / 置底`。
  - `P2-seq144` 差异点清单（实施前）：
    - legado `BookSourceAdapter.showMenu` 在 `sort == BookSourceSort.Default` 时展示 `menu_bottom`，点击后固定走 `callBack.toBottom(source)`，并由 `BookSourceActivity.toBottom` 按 `sortAscending` 分流到 `viewModel.bottomSource/topSource`。
    - Flutter 端运行链路虽已存在 `_toBottom`，但缺少可复现证据证明“仅手动排序展示置底入口 + 升序置底传递 `toTop=false` + 反序置底传递 `toTop=true`”三条关键语义。
  - `P2-seq144` 逐项对照清单（实施后）：
    - 入口：已同义（书源条目“更多”菜单仅在手动排序展示“置底”，对齐 legado `menu_bottom` 可见性边界）。
    - 状态：已同义（点击 `menu_bottom` 后进入 `_toBottom`；升序传递 `toTop=false`，反序传递 `toTop=true`，对齐 legado `toBottom -> bottomSource/topSource` 分流语义）。
    - 异常：已同义（未新增成功弹窗或失败静默分支；沿用原有可观测链路）。
    - 文案：已同义（动作文案保持“置底”，无扩展文案漂移）。
    - 排版：已同义（继续使用 `CupertinoActionSheet` 承载条目菜单，平台视觉差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（条目“更多”菜单点击 `menu_bottom` 后直接进入置底链路，等价 legado `menu_bottom -> CallBack.toBottom(bookSource)`）。
    - 验证：`flutter test test/source_list_view_item_top_action_test.dart test/source_list_view_compile_test.dart` 通过；手工路径 `书架 -> 搜索 -> 右上角设置 -> 书源管理 -> 书源条目右侧更多 -> 置底`（确认手动排序显示入口，切换“反序”后再次点击“置底”按 legacy 语义走反向分流）。
  - 兼容影响：无旧书源兼容性影响；本序号仅补齐 `menu_bottom` 的入口可见性/分流语义与回归证据，不改动书源数据结构与导入链路。
  - 已完成 `P2-seq145`：`book_source_item.xml / @+id/menu_login / 登录`。
  - `P2-seq145` 差异点清单（实施前）：
    - legado `BookSourceAdapter.showMenu` 仅在 `source.hasLoginUrl` 时展示 `menu_login`，点击后固定以 `type=bookSource` 和 `key=bookSourceUrl` 触发登录链路。
    - Flutter 端 `menu_login` 显示与主链路已接近同义，但缺少 `book_source_item` 维度的可复现回归证据，且登录动作未在触发前按 URL 回查书源边界。
  - `P2-seq145` 逐项对照清单（实施后）：
    - 入口：已同义（`loginUrl` 为空时不显示“登录”，与 legado `hasLoginUrl` 可见性边界一致）。
    - 状态：已同义（`loginUrl` 非空且存在 `loginUi` 时，点击“登录”进入表单登录页；保持与 legado 登录入口状态分流同义）。
    - 异常：已同义（触发登录前按 `bookSourceUrl` 回查最新书源；缺失时提示“未找到书源”，避免静默失败）。
    - 文案：已同义（菜单项文案保持“登录”，不引入扩展文案）。
    - 排版：已同义（继续使用 `CupertinoActionSheet` 承载条目菜单，平台视觉差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（条目“更多”菜单点击 `menu_login` 后直达登录链路，等价 legado `menu_login -> SourceLoginActivity(type=bookSource,key=bookSourceUrl)` 的入口语义）。
    - 验证：`flutter test test/source_list_view_item_top_action_test.dart` 通过；手工路径 `书架 -> 搜索 -> 右上角设置 -> 书源管理 -> 书源条目右侧更多 -> 登录`（验证 `loginUrl` 为空不显示登录入口、`loginUrl` 非空且有 `loginUi` 时进入登录表单页）。
  - 兼容影响：无旧书源兼容性影响；本序号仅收敛 `menu_login` 的入口可见性与触发边界，不改动书源登录脚本与 Cookie 存储结构。
  - 已完成 `P2-seq146`：`book_source_item.xml / @+id/menu_search / 搜索`。
  - `P2-seq146` 差异点清单（实施前）：
    - legado `BookSourceAdapter.showMenu` 点击 `menu_search` 后固定走 `BookSourceActivity.searchBook`，并以当前条目快照构造 `SearchScope(bookSource)` 传给 `SearchActivity`，不依赖再次查库。
    - Flutter 端此前使用 `SearchView.scoped(sourceUrls:[url])` 在搜索页初始化时再按 URL 回查书源生成 scope；若 action sheet 打开后条目被删除，会退化为沿用旧 scope，和 legado 快照语义不一致。
  - `P2-seq146` 逐项对照清单（实施后）：
    - 入口：已同义（书源条目“更多”菜单常驻“搜索”入口，与 legado `menu_search` 同层级）。
    - 状态：已同义（点击后先按条目快照写入 `searchScope=<书源名去冒号>::<bookSourceUrl>`，再进入搜索页，保持 legacy 快照状态流转）。
    - 异常：已同义（移除“依赖二次查库才能生成 scope”的边界漂移；即使条目在弹层打开后被删除，仍保留快照 scope，后续由搜索页按 legacy 规则在解析阶段兜底回退）。
    - 文案：已同义（菜单项文案保持“搜索”，不引入扩展文案）。
    - 排版：已同义（继续使用 `CupertinoActionSheet` 承载条目菜单，平台视觉差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（条目“更多”菜单点击 `menu_search` 后直达搜索页，等价 legado `menu_search -> SearchActivity(searchScope=SearchScope(bookSource))`）。
    - 验证：`flutter test test/source_list_view_item_top_action_test.dart`、`flutter test test/source_list_view_compile_test.dart` 通过；手工路径 `书架 -> 搜索 -> 右上角设置 -> 书源管理 -> 书源条目右侧更多 -> 搜索`。
  - 兼容影响：无旧书源兼容性影响；本序号仅收敛 `menu_search` 的 scope 快照写入时机与入口触发语义，不改动搜索算法与书源数据结构。
  - 已完成 `P2-seq147`：`book_source_item.xml / @+id/menu_debug_source / 调试`。
  - `P2-seq147` 差异点清单（实施前）：
    - legado `BookSourceAdapter.showMenu` 点击 `menu_debug_source` 后直接调用 `callBack.debug(source)`；`BookSourceActivity.debug` 固定携带当前条目 `bookSourceUrl` 打开 `BookSourceDebugActivity`，入口不做二次查库拦截。
    - Flutter 端此前复用了 `_openEditor(bookSourceUrl, initialTab: 3)`，会先按 URL 回查书源；若 action sheet 打开后条目被删，会提前提示“书源不存在或已被删除”并中断进入调试页，触发语义偏离 legado。
  - `P2-seq147` 逐项对照清单（实施后）：
    - 入口：已同义（书源条目“更多”菜单常驻“调试”入口，与 legado `menu_debug_source` 同层级）。
    - 状态：已同义（点击后按当前条目快照直接进入 `SourceDebugLegacyView`，不再依赖入口前二次查库）。
    - 异常：已同义（移除入口前置拦截；即使弹层打开后条目被删除，仍可进入调试页，由调试页内部链路处理后续状态）。
    - 文案：已同义（菜单项文案保持“调试”，不引入扩展文案）。
    - 排版：已同义（继续使用 `CupertinoActionSheet` 承载条目菜单，平台视觉差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（条目“更多”菜单点击 `menu_debug_source` 后直达调试页，等价 legado `menu_debug_source -> BookSourceDebugActivity(key=bookSourceUrl)` 的入口触发语义）。
    - 验证：`flutter test test/source_list_view_item_top_action_test.dart`、`flutter test test/source_list_view_compile_test.dart` 通过；手工路径 `书架 -> 搜索 -> 右上角设置 -> 书源管理 -> 书源条目右侧更多 -> 调试`。
  - 兼容影响：无旧书源兼容性影响；本序号仅收敛 `menu_debug_source` 的入口触发语义与边界行为，不改动调试引擎、书源数据结构与存储字段。
  - 已完成 `P2-seq148`：`book_source_item.xml / @+id/menu_del / 删除`。
  - `P2-seq148` 差异点清单（实施前）：
    - legado `BookSourceAdapter.showMenu` 在 `menu_del` 点击后执行 `callBack.del(source)`，并立即 `selected.remove(source)`；`BookSourceActivity.del` 再以 `draw + sure_del + "\n" + bookSourceName` 弹出二次确认，确认后执行 `viewModel.del(listOf(bookSource))`。
    - Flutter 端条目删除链路虽已具备“先移除选中态 + 二次确认 + 删除书源”的主流程，但确认弹窗标题仍为“提示”，与 legado `R.string.draw=提醒` 存在文案偏差。
    - tracker `seq148` 仍为 `pending`，缺少本序号“弹窗文案 + 状态流转 + 删除落库”的独立可复现验证证据。
  - `P2-seq148` 逐项对照清单（实施后）：
    - 入口：已同义（书源条目“更多”菜单保留一级“删除”入口，对齐 legado `menu_del` 层级）。
    - 状态：已同义（点击“删除”后先移除当前条目选中态，再弹出确认弹窗；取消后不恢复选中态，保持与 legado `selected.remove(source)` 时序一致）。
    - 异常：已同义（取消确认不触发删除；确认后删除书源记录并继续执行源变量清理，不新增静默失败分支）。
    - 文案：已同义（确认弹窗标题由“提示”收敛为 legado 同义“提醒”，正文保持“是否确认删除？\\n<书源名>”）。
    - 排版：已同义（继续使用 `CupertinoActionSheet + CupertinoAlertDialog` 承载菜单与确认弹窗，平台视觉差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（点击 `menu_del` 后进入 `_confirmDeleteSource`；确认按钮直接触发 `_deleteSourceByLegacyRule`，等价 legado `yesButton -> viewModel.del` 删除确认语义）。
    - 验证：`flutter test test/source_list_view_item_top_action_test.dart --plain-name "书源条目菜单删除会先移除选中态，取消后保留条目"`、`flutter test test/source_list_view_item_top_action_test.dart --plain-name "书源条目菜单确认删除后会删除条目"`、`flutter test test/source_variable_store_test.dart --plain-name "remove variable"` 通过；手工路径 `书架 -> 搜索 -> 右上角设置 -> 书源管理 -> 书源条目右侧更多 -> 删除`（确认标题“提醒”、取消不删除、确认后条目删除）。
  - 兼容影响：无旧书源兼容性影响；本序号仅收敛 `menu_del` 的确认文案与触发语义，不改动书源数据结构与排序字段。
  - 已完成 `P2-seq149`：`book_source_item.xml / @+id/menu_enable_explore / 启用发现`。
  - `P2-seq149` 差异点清单（实施前）：
    - legado `BookSourceAdapter.showMenu` 仅在 `source.hasExploreUrl` 时展示 `menu_enable_explore`，并按 `source.enabledExplore` 动态切换菜单文案“启用发现/禁用发现”。
    - Flutter 端入口显隐与文案已接近同义，但点击动作直接调用 `_sourceRepo.updateSource(source.copyWith(...))`；由于 `updateSource` 为 upsert，若 action sheet 打开后书源被删除，点击该动作会把书源重新写回，偏离 legado `BookSourceDao.enableExplore` 仅更新现存记录的语义。
    - tracker `seq149` 仍为 `pending`，缺少“入口显隐 + 文案切换 + 删除后不重建”的独立可复现证据。
  - `P2-seq149` 逐项对照清单（实施后）：
    - 入口：已同义（仅 `exploreUrl` 非空的书源在条目“更多”菜单显示“启用发现/禁用发现”入口，对齐 legado `hasExploreUrl` 可见性边界）。
    - 状态：已同义（文案按条目快照 `enabledExplore` 状态在“启用发现/禁用发现”间切换，点击后写库并由列表数据流刷新状态）。
    - 异常：已同义（点击动作改为先按 `bookSourceUrl` 回查当前记录；若记录已不存在则静默返回，不再发生“删除后被重建”的语义偏差）。
    - 文案：已同义（菜单项文案保持 legado 同义“启用发现/禁用发现”，不引入额外状态提示文案）。
    - 排版：已同义（继续使用 `CupertinoActionSheet` 承载条目菜单，平台视觉差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（点击 `menu_enable_explore` 后执行 `enabledExplore` 切换并写库，等价 legado `menu_enable_explore -> enableExplore(!enabledExplore, source)` 链路）。
    - 验证：`flutter test test/source_list_view_item_top_action_test.dart --plain-name "书源条目菜单启用发现入口显隐与切换文案对齐 legado"`、`flutter test test/source_list_view_item_top_action_test.dart --plain-name "书源条目菜单启用发现在弹层期间删除书源不会重建记录"` 通过；手工路径 `书架 -> 搜索 -> 右上角设置 -> 书源管理 -> 书源条目右侧更多 -> 启用发现/禁用发现`（确认入口显隐、文案切换与删除后不重建边界）。
  - 兼容影响：无旧书源兼容性影响；本序号仅收敛 `menu_enable_explore` 的触发边界与写库语义，不改动书源结构与发现解析链路。
  - 已完成 `P2-seq162`：`book_toc.xml / @+id/menu_search / 搜索`。
  - `P2-seq162` 差异点清单（实施前）：
    - legado `TocActivity` 的 `menu_search` 为顶栏 `SearchView` actionView，默认折叠为搜索图标；点击后展开搜索框并在 `onQueryTextChange` 里实时触发目录过滤。
    - legado 在搜索框失焦时会执行 `isIconified = true` 收起搜索 actionView；关闭搜索时恢复非搜索态，不保留“常驻内联输入框”形态。
    - Flutter 端目录页此前使用页面内联 `ShadInput(搜索章节)`，缺少 `menu_search` 顶栏入口、展开/收起状态流转与对应定向回归证据。
  - `P2-seq162` 逐项对照清单（实施后）：
    - 入口：已同义（目录页顶栏新增一级“搜索”图标入口，对齐 legado `menu_search` action 入口层级）。
    - 状态：已同义（默认折叠；点击搜索图标展开搜索框；失焦自动收起；点击关闭按钮清空查询并恢复全量目录）。
    - 异常：已同义（仅收敛 `menu_search` 入口与状态流转，不新增静默失败分支或扩展错误文案）。
    - 文案：已同义（搜索占位与动作语义统一为“搜索”，去除“搜索章节”扩展口径）。
    - 排版：已同义（采用 `CupertinoNavigationBar` 顶栏 action + `CupertinoSearchTextField` 承载，视觉差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（输入关键字后即时按章节标题过滤目录，等价 legado `menu_search -> onQueryTextChange -> startChapterListSearch` 的检索触发语义）。
    - 验证：`flutter test test/search_book_info_view_toc_search_action_test.dart test/search_book_info_view_compile_test.dart` 通过；手工路径 `书架 -> 书籍详情 -> 目录查看 -> 顶栏搜索图标 -> 输入关键词过滤 -> 关闭搜索`。
  - 兼容影响：无旧书源兼容性影响；本序号仅收敛 `menu_search` 的入口形态与目录过滤状态流转，不改动目录解析与阅读跳转链路。
  - 已完成 `P2-seq163`：`book_toc.xml / @+id/menu_toc_regex / TXT 目录规则`。
  - `P2-seq163` 差异点清单（实施前）：
    - legado `TocActivity` 在本地 TXT 场景显示 `menu_toc_regex`，点击后直接进入 `TxtTocRuleDialog`，确认后回调 `onTocRegexDialogResult`，并执行 `upBookAndToc` 立即重建目录。
    - Flutter 目录页缺失 `menu_toc_regex` 入口；本地 TXT 仅支持“自动识别”分章，无“按书籍指定 toc 正则并立即重建目录”的状态流转。
    - `TxtParser` 仅有内置规则自动匹配策略，`SearchBookInfoRefreshHelper` / 阅读器重解析链路未透传目录正则参数。
  - `P2-seq163` 逐项对照清单（实施后）：
    - 入口：已同义（目录页右上角“更多”菜单仅在本地 TXT 书籍显示“TXT 目录规则”入口，对齐 legado `menu_group_text` 可见性边界）。
    - 状态：已同义（目录规则按“书籍级”持久化；选择规则后立即触发本地 TXT 重解析并刷新目录缓存；取消选择不落库不生效）。
    - 异常：已同义（正则非法/不匹配导致章节为空时，刷新链路维持可观测失败提示，不新增静默成功分支）。
    - 文案：已同义（菜单文案固定“TXT 目录规则”，规则面板标题同名，不引入扩展提示文案）。
    - 排版：已同义（继续使用 `CupertinoActionSheet` 承载目录操作与规则选择，平台视觉差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（`menu_toc_regex` 触发规则选择；确认后写入书籍级 `tocRuleRegex` 并执行本地重解析，等价 legado `menu_toc_regex -> onTocRegexDialogResult -> upBookAndToc` 状态流转）。
    - 验证：`flutter test test/txt_parser_toc_rule_regex_test.dart test/search_book_info_refresh_helper_test.dart test/app_settings_test.dart test/search_book_info_view_toc_search_action_test.dart test/search_book_info_view_compile_test.dart` 通过；手工路径 `书架 -> 书籍详情 -> 查看目录 -> 右上角更多 -> TXT 目录规则 -> 选择规则`（确认入口可见性、规则落库与目录重建）。
  - 兼容影响：无旧书源兼容性影响；本序号仅新增书籍级 TXT 目录规则配置与重解析透传，不改动书源模型与网络目录解析链路。
  - 已完成 `P2-seq165`：`book_toc.xml / @+id/menu_reverse_toc / 反转目录`。
  - `P2-seq165` 差异点清单（实施前）：
    - legado `TocActivity` 将 `menu_reverse_toc` 放在顶栏“更多”菜单中，文案固定“反转目录”，点击后执行一次性动作 `reverseToc`，不是页面内常驻排序按钮。
    - Flutter 端目录页此前使用页面内“倒序”按钮触发 `_reversed` 切换，入口层级与文案均与 legado 存在偏差（按钮入口 + “倒序”文案）。
    - 目录页“更多”菜单此前仅承载 `menu_toc_regex`（本地 TXT 场景），非本地 TXT 场景无菜单入口，无法等价承载 `menu_reverse_toc`。
  - `P2-seq165` 逐项对照清单（实施后）：
    - 入口：已同义（目录页右上角“更多”菜单常驻可见，`menu_reverse_toc` 在菜单内一级展示；本地 TXT 场景继续与 `menu_toc_regex` 同层并存）。
    - 状态：已同义（点击“反转目录”后切换目录顺序；目录计数与搜索结果数量保持实时刷新）。
    - 异常：已同义（仅调整入口层级与触发动作，不新增静默失败分支或扩展错误提示）。
    - 文案：已同义（动作文案由“倒序”收敛为 legado 同义固定“反转目录”）。
    - 排版：已同义（移除页面内倒序按钮，改为 `CupertinoActionSheet` 承载目录动作；平台视觉差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（点击 `menu_reverse_toc` 后切换 `_reversed`，并继续保持“先按章节标题过滤，再执行倒序”的目录检索边界，与既有 legado 检索顺序要求同义）。
    - 验证：`flutter test test/search_book_info_view_toc_search_action_test.dart test/search_book_info_view_compile_test.dart` 通过；手工路径 `书架 -> 书籍详情 -> 查看目录 -> 右上角更多 -> 反转目录`（确认菜单入口层级、文案与倒序结果）。
  - 兼容影响：无旧书源兼容性影响；本序号仅收敛 `menu_reverse_toc` 的入口层级与文案语义，不改动目录解析、章节索引落库与阅读跳转链路。
  - 已完成 `P2-seq168`：`book_toc.xml / @+id/menu_export_bookmark / 导出`。
  - `P2-seq168` 差异点清单（实施前）：
    - legado `TocActivity` 在书签菜单组暴露 `menu_export_bookmark`，点击后通过 `HandleFileContract(requestCode=1)` 选择导出位置，再调用 `TocViewModel.saveBookmark` 落盘 JSON 并提示“导出成功”。
    - Flutter 端目录页“更多”菜单仅包含 `TXT 目录规则/反转目录`，缺少 `menu_export_bookmark` 入口与导出触发链路，无法提供同义导出能力。
    - Flutter 详情页目录弹层未接入书签导出可观测链路（成功提示、取消静默、失败日志），`seq168` 缺少独立回归证据。
  - `P2-seq168` 逐项对照清单（实施后）：
    - 入口：已同义（目录页右上角“更多”菜单新增固定文案“导出”入口，对齐 legado `menu_export_bookmark` 动作层级）。
    - 状态：已同义（点击“导出”后进入书签 JSON 导出流程；成功提示“导出成功”，取消保存保持静默返回）。
    - 异常：已同义（导出初始化或落盘失败时记录异常日志并弹出可观测失败提示，不新增静默失败分支）。
    - 文案：已同义（菜单项文案固定“导出”，成功反馈固定“导出成功”）。
    - 排版：已同义（继续使用 `CupertinoActionSheet` 承载目录动作，平台视觉差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（点击 `menu_export_bookmark` 后读取当前书籍书签并执行 JSON 导出，等价 legado `menu_export_bookmark -> saveBookmark` 主链路语义）。
    - 验证：`flutter test test/search_book_info_view_toc_search_action_test.dart test/search_book_info_view_compile_test.dart` 通过；手工路径 `书架 -> 书籍详情 -> 查看目录 -> 右上角更多 -> 导出`（确认入口可见、导出成功提示与取消静默边界）。
  - 兼容影响：无旧书源兼容性影响；本序号仅补齐目录页 `menu_export_bookmark` 入口与 JSON 导出触发链路，不改动目录解析、书签存储结构与阅读跳转逻辑。
  - 已完成 `P2-seq169`：`book_toc.xml / @+id/menu_export_md / 导出(MD)`。
  - `P2-seq169` 差异点清单（实施前）：
    - legado `TocActivity` 在书签菜单组暴露 `menu_export_md`，点击后通过 `HandleFileContract(requestCode=2)` 选择导出位置，再调用 `TocViewModel.saveBookmarkMd` 落盘 Markdown 并提示“导出成功”。
    - Flutter 端目录页“更多”菜单仅补齐了 `menu_export_bookmark`（JSON 导出），缺少 `menu_export_md` 入口与 Markdown 导出触发链路，无法覆盖 legado 书签菜单组第二个导出动作。
    - `seq168` 的定向回归只验证了 JSON 导出参数（`.json`），未覆盖 Markdown 导出参数（`.md`）与入口文案“导出(MD)”。
  - `P2-seq169` 逐项对照清单（实施后）：
    - 入口：已同义（目录页右上角“更多”菜单新增固定文案“导出(MD)”入口，对齐 legado `menu_export_md` 动作层级）。
    - 状态：已同义（点击“导出(MD)”后进入书签 Markdown 导出流程；成功提示“导出成功”，取消保存保持静默返回）。
    - 异常：已同义（导出初始化或落盘失败时记录异常日志并弹出可观测失败提示，不新增静默失败分支）。
    - 文案：已同义（菜单项文案固定“导出(MD)”，成功反馈固定“导出成功”）。
    - 排版：已同义（继续使用 `CupertinoActionSheet` 承载目录动作，平台视觉差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（点击 `menu_export_md` 后读取当前书籍书签并执行 Markdown 导出，等价 legado `menu_export_md -> saveBookmarkMd` 主链路语义）。
    - 验证：`flutter test test/search_book_info_view_toc_search_action_test.dart test/search_book_info_view_compile_test.dart` 通过；手工路径 `书架 -> 书籍详情 -> 查看目录 -> 右上角更多 -> 导出(MD)`（确认入口可见、导出成功提示与取消静默边界）。
  - 兼容影响：无旧书源兼容性影响；本序号仅补齐目录页 `menu_export_md` 入口与 Markdown 导出触发链路，不改动目录解析、书签存储结构与阅读跳转逻辑。
  - 已完成 `P2-seq64`：`book_read.xml / @+id/menu_change_source / 换源`。
  - `P2-seq64` 差异点清单（实施前）：
    - legado `ReadBookActivity` 中 `menu_change_source` 属于在线阅读顶栏一级 action，点击即触发整书换源（`ChangeBookSourceDialog`）；当前 Flutter 端仅在“阅读操作”二级菜单提供“换源”，入口层级不一致。
    - legado 对 `menu_change_source` 额外提供“长按图标 -> `book_read_change_source.xml` 分支菜单（章节换源/书籍换源）”语义；Flutter 端未在顶栏动作上提供长按分支入口。
    - Flutter 端“换源”默认行为是“先弹章节/整书二级选择”，与 legado “点击即整书换源”默认触发路径不一致。
  - `P2-seq64` 逐项对照清单（实施后）：
    - 入口：已同义（阅读页顶部新增“换源”一级动作按钮，仅在线书籍显示，对齐 legado `menu_group_on_line -> menu_change_source` 层级）。
    - 状态：已同义（点击换源后先收起阅读菜单，再进入换源候选流程；本地书籍隐藏入口，保持在线/本地分组边界一致）。
    - 异常：已同义（沿用现有换源失败可观测提示链路，不新增静默失败分支）。
    - 文案：已同义（一级入口固定“换源”，长按分支菜单保持“章节换源/书籍换源”顺序与文案同义）。
    - 排版：已同义（采用顶栏圆角图标按钮承载一级动作，Cupertino 样式差异属于 `Shadcn + Cupertino` 平台允许范围）。
    - 交互触发：已同义（点击“换源”默认直达整书换源；长按“换源”弹出分支菜单并承载章节/整书换源选择，对齐 legado `iconItemOnLongClick(menu_change_source)` 语义）。
    - 验证：`flutter test test/reader_top_menu_test.dart test/simple_reader_view_compile_test.dart` 通过；手工路径 `阅读页 -> 顶部换源按钮（点击）`、`阅读页 -> 顶部换源按钮（长按）`（确认默认整书换源与长按分支菜单）。
  - 兼容影响：无旧书源兼容性影响；本序号仅收敛阅读页 `menu_change_source` 入口层级与默认触发语义，不改动章节换源/整书换源数据匹配与落库策略。
  - 已完成 `P2-seq65`：`book_read.xml / @+id/menu_refresh / 刷新`。
  - `P2-seq65` 差异点清单（实施前）：
    - legado `ReadBookActivity` 中 `menu_refresh` 属于在线阅读顶栏一级 action，点击语义等价 `menu_refresh_dur`（刷新当前章节）；当前 Flutter 端仅在“阅读操作”二级菜单提供刷新，入口层级不一致。
    - legado 对 `menu_refresh` 额外提供“长按图标 -> `book_read_refresh.xml` 分支菜单（刷新当前章节/刷新之后章节/刷新全部章节）”语义；Flutter 端未在顶栏动作上提供长按分支入口。
    - Flutter 端“阅读操作”菜单仍包含“刷新”，与 legado 顶栏一级入口语义存在层级偏差。
  - `P2-seq65` 逐项对照清单（实施后）：
    - 入口：已同义（阅读页顶部新增“刷新”一级动作按钮，仅在线书籍显示，对齐 legado `menu_group_on_line -> menu_refresh` 层级）。
    - 状态：已同义（点击刷新后先收起阅读菜单，再按当前章节执行刷新；本地书籍隐藏入口，保持在线/本地分组边界一致）。
    - 异常：已同义（沿用现有刷新失败可观测提示链路，不新增静默失败分支）。
    - 文案：已同义（一级入口固定“刷新”，长按分支菜单保持“刷新当前章节/刷新之后章节/刷新全部章节”顺序与文案同义）。
    - 排版：已同义（采用顶栏圆角图标按钮承载一级动作，Cupertino 样式差异属于 `Shadcn + Cupertino` 平台允许范围）。
    - 交互触发：已同义（点击“刷新”默认执行当前章节刷新；长按“刷新”弹出分支菜单并承载当前/之后/全部刷新选择，对齐 legado `iconItemOnLongClick(menu_refresh)` 与 `menu_refresh=menu_refresh_dur` 语义）。
    - 验证：`flutter test test/reader_top_menu_test.dart test/reader_legacy_menu_helper_test.dart test/simple_reader_view_compile_test.dart` 通过；手工路径 `阅读页 -> 顶部刷新按钮（点击）`、`阅读页 -> 顶部刷新按钮（长按）`（确认默认当前章节刷新与长按分支菜单）。
  - 兼容影响：无旧书源兼容性影响；本序号仅收敛阅读页 `menu_refresh` 入口层级与默认触发语义，不改动章节刷新缓存清理与正文重载策略。
  - 已完成 `P2-seq66`：`book_read.xml / @+id/menu_download / 离线缓存`。
  - `P2-seq66` 差异点清单（实施前）：
    - legado `ReadBookActivity` 中 `menu_download` 属于在线阅读顶栏一级 action（`showAsAction=always`），当前 Flutter 端仅在“阅读操作”二级菜单提供“离线缓存”，入口层级不一致。
    - legado 点击 `menu_download` 会弹出章节范围输入并启动缓存流程；当前 Flutter 端点击仅提示“离线缓存：当前版本暂未支持”，未进入缓存链路。
    - legado 对 `menu_download` 保持在线/本地边界（本地书隐藏入口）；当前 Flutter 顶栏未提供同层级入口，无法完成同义触发路径。
  - `P2-seq66` 逐项对照清单（实施后）：
    - 入口：已同义（阅读页顶部新增“离线缓存”一级动作按钮，仅在线书籍显示，对齐 legado `menu_group_on_line -> menu_download` 层级）。
    - 状态：已同义（在线书籍显示入口，本地书籍隐藏；离线缓存执行期间避免重复触发，保持“进行中”保护分支）。
    - 异常：已同义（范围输入无效与空范围保持可观测提示；章节抓取失败记录到 `ExceptionLogService`，避免静默失败）。
    - 文案：已同义（入口固定“离线缓存”；范围对话框标题固定“离线缓存”，输入项“开始章节/结束章节”）。
    - 排版：已同义（顶栏圆角图标按钮承载一级动作；范围输入采用 `CupertinoAlertDialog`，平台视觉差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（点击顶栏“离线缓存”后弹出章节范围对话框，默认起止为“当前章/末章”；确认后按范围执行章节正文缓存并回报完成摘要；更多菜单移除离线缓存项以避免双入口层级偏差）。
    - 验证：`flutter test test/reader_top_menu_test.dart test/reader_legacy_menu_helper_test.dart test/simple_reader_view_compile_test.dart` 通过；手工路径 `阅读页 -> 顶部离线缓存按钮 -> 输入开始/结束章节 -> 确定`（确认入口层级、在线/本地显隐、缓存完成摘要与失败日志可观测）。
  - 兼容影响：无旧书源兼容性破坏；本序号仅收敛 `menu_download` 入口层级与阅读页范围缓存触发链路，不改动目录解析、章节存储结构与书源规则执行语义。
  - 已完成 `P2-seq67`：`book_read.xml / @+id/menu_toc_regex / TXT 目录规则`。
  - `P2-seq67` 差异点清单（实施前）：
    - legado `ReadBookActivity` 在 `menu_group_text` 中将 `menu_toc_regex` 作为本地 TXT 专属顶栏一级 action，点击后进入 `TxtTocRuleDialog`，采用“取消不生效、确定统一提交”的确认式状态流转。
    - Flutter 端阅读页虽然已有顶栏 `TXT 目录规则` 入口，但规则弹层为“点选即提交”语义，未对齐 legado `tvCancel/tvOk` 的提交时机边界。
    - Flutter 端规则提交成功后追加“TXT 目录规则已应用”扩展提示；legado 在该链路仅触发目录重建，不追加成功提示文案。
  - `P2-seq67` 逐项对照清单（实施后）：
    - 入口：已同义（阅读页顶部 `TXT 目录规则` 仅在本地 TXT 书籍显示，对齐 legado `menu_group_text -> menu_toc_regex` 可见性边界）。
    - 状态：已同义（规则弹窗改为确认式状态流转：取消不生效，确定后统一提交并触发目录重建）。
    - 异常：已同义（目录重建失败统一输出 `LoadTocError:<error>` 可观测提示，不新增静默失败分支）。
    - 文案：已同义（入口文案固定“TXT 目录规则”；移除扩展成功提示，避免偏离 legado 业务文案语义）。
    - 排版：已同义（规则选择改为 `CupertinoAlertDialog` 承载确认式列表，平台视觉差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（点击顶栏 `menu_toc_regex` 后弹出规则确认框；确定后保存书籍级规则并按当前编码/拆分配置立即重解析本地 TXT，等价 legado `menu_toc_regex -> onTocRegexDialogResult -> loadChapterList` 主链路）。
    - 验证：`flutter test test/reader_txt_toc_rule_dialog_test.dart test/reader_top_menu_test.dart test/reader_legacy_menu_helper_test.dart test/simple_reader_view_compile_test.dart` 通过；手工路径 `阅读页 -> 本地 TXT 书籍 -> 顶部 TXT 目录规则 -> 选择规则 -> 取消/确定`（确认取消不生效与确定后重建目录）。
  - 兼容影响：无旧书源兼容性影响；本序号仅收敛阅读页 `menu_toc_regex` 的提交时机与提示语义，不改动书源模型与网络目录解析链路。
  - 已完成 `P2-seq68`：`book_read.xml / @+id/menu_set_charset / 设置编码`。
  - `P2-seq68` 差异点清单（实施前）：
    - legado `ReadBookActivity` 在 `menu_group_local` 将 `menu_set_charset` 作为本地书籍顶栏一级 action（`showAsAction=always`），点击进入 `showCharsetConfig`；Flutter 端该动作仍位于“阅读操作”二级菜单，入口层级不一致。
    - legado `showCharsetConfig` 为输入式对话框（标题“设置编码”、输入框 hint=`charset`、预填当前编码、支持建议值过滤），点击确定后直接调用 `ReadBook.setCharset`；Flutter 端为固定选项 picker，不支持自由输入。
    - legado `ReadBook.setCharset` 在保存编码后统一触发 `loadChapterList(book)`，本地 TXT/非 TXT 都会走目录重载链路；Flutter 端非 TXT 本地仅保存编码并提示成功，未触发重载。
  - `P2-seq68` 逐项对照清单（实施后）：
    - 入口：已同义（本地书籍时“设置编码”改为顶栏一级动作；“阅读操作”菜单移除该项，避免双入口层级偏差）。
    - 状态：已同义（确认后先持久化编码，再立即触发本地目录重载；本地 TXT 走带编码重解析，本地非 TXT 也执行目录重载）。
    - 异常：已同义（重载失败统一保持 `LoadTocError:<error>` 可观测提示，不新增静默失败分支）。
    - 文案：已同义（对话框标题固定“设置编码”，输入框占位 `charset`；移除“编码已保存/已切换”扩展成功提示）。
    - 排版：已同义（顶栏一级动作使用 `Cupertino` 圆角按钮承载，输入对话框使用 `CupertinoAlertDialog`，平台样式差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（点击顶栏 `menu_set_charset` 打开输入式对话框，取消不生效；确定后对齐 legado `menu_set_charset -> showCharsetConfig -> ReadBook.setCharset -> loadChapterList` 主链路语义）。
    - 验证：`flutter test test/reader_top_menu_test.dart test/reader_legacy_menu_helper_test.dart test/simple_reader_view_compile_test.dart` 通过；手工路径 `阅读页 -> 本地书籍 -> 顶部设置编码 -> 输入 GBK -> 确定`（确认顶栏入口、自由输入与立即重载生效）。
  - 兼容影响：无旧书源兼容性破坏；本序号仅收敛 `menu_set_charset` 入口层级与编码设置状态流转，不改动书源规则解析与网络阅读链路。
  - 已完成 `P2-seq83`：`book_read.xml / @+id/menu_update_toc / 更新目录`。
  - `P2-seq83` 差异点清单（实施前）：
    - legado `ReadBookActivity.menu_update_toc` 对本地与在线书籍都执行目录重载；本地 EPUB/MOBI 会先清缓存再触发 `loadChapterList`。Flutter 端此前将本地书籍拦截为“不支持检查更新”，存在行为偏差。
    - legado 触发 `menu_update_toc` 后仅进入“更新目录中”加载态并在成功后静默结束，不追加成功提示；Flutter 端此前会弹“目录已更新，共X章”扩展提示，文案语义不一致。
    - legado 失败口径为“在线统一 `加载目录失败`、本地统一 `LoadTocError:*`”；Flutter 端此前按异常原文拼接“更新目录失败：$e”，错误语义不一致。
  - `P2-seq83` 逐项对照清单（实施后）：
    - 入口：已同义（阅读操作菜单保留“更新目录”入口，触发层级与 legado `book_read.xml/menu_update_toc` 同义）。
    - 状态：已同义（点击后进入加载态执行目录刷新，成功后不再追加“目录已更新，共X章”扩展提示）。
    - 异常：已同义（在线失败收敛为“加载目录失败”；本地失败收敛为 `LoadTocError:*`，并写入异常日志，保持可观测）。
    - 文案：已同义（动作文案固定“更新目录”，失败文案口径对齐 legado）。
    - 排版：已同义（沿用 `CupertinoActionSheet` 菜单承载，平台样式差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（在线书走目录更新服务并刷新章节；本地书走本地目录重解析链路，TXT 透传编码/TXT目录规则/拆分配置，EPUB 刷新前清缓存后重载）。
    - 验证：`flutter test test/reader_top_menu_test.dart test/reader_legacy_menu_helper_test.dart test/simple_reader_view_compile_test.dart test/search_book_info_refresh_helper_test.dart`、`flutter test test/reader_catalog_sheet_test.dart` 通过；手工路径 `阅读页 -> 阅读操作 -> 更新目录`（在线书/本地 TXT/本地 EPUB 分别验证）。
  - 兼容影响：无旧书源兼容性破坏；本序号仅收敛阅读页 `menu_update_toc` 的本地/在线目录刷新语义与提示口径，不改动书源规则模型与章节存储结构。
  - 已完成 `P3-seq94`：`book_read_refresh.xml / @+id/menu_refresh_dur / 刷新当前章节`。
  - `P3-seq94` 差异点清单（实施前）：
    - legado `ReadBookActivity` 中 `menu_refresh` 与 `menu_refresh_dur` 处于同一 `when` 分支，默认都执行“刷新当前章节”；Flutter 端 `ReaderLegacyReadMenuAction.refresh` 仍指向“弹出刷新分支菜单”，存在默认触发语义偏差。
    - legado 长按顶栏刷新图标仅负责打开 `book_read_refresh.xml` 三分支菜单（当前/之后/全部），其中“刷新当前章节”应与顶栏点击链路完全同义，不能额外分叉独立行为。
    - tracker/ExecPlan 尚缺少 `seq94` 的单项证据，当前仅有 `seq65(menu_refresh)` 的入口层级证明，缺少 `menu_refresh_dur` 与默认刷新同分支的明确回归记录。
  - `P3-seq94` 逐项对照清单（实施后）：
    - 入口：已同义（顶栏刷新按钮长按仍弹出 `刷新当前章节/刷新之后章节/刷新全部章节` 子菜单，入口层级保持与 legado `book_read_refresh.xml` 同义）。
    - 状态：已同义（新增 `ReaderLegacyMenuHelper.defaultRefreshAction()` 固化默认刷新动作；顶栏点击刷新与 `menu_refresh_dur` 都统一走“刷新当前章节”分支）。
    - 异常：已同义（无可用书源时默认刷新仍回落到当前章节重载，不新增扩展错误分支）。
    - 文案：已同义（默认动作文案保持“刷新当前章节”，不引入额外提示文案）。
    - 排版：已同义（继续使用 `CupertinoActionSheet` 承载长按分支菜单，平台视觉差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（`menu_refresh` 点击与 `menu_refresh_dur` 点击统一进入 `_runLegacyDefaultRefreshAction -> _executeLegacyRefreshMenuAction(current)`，对齐 legado “同一分支”语义）。
    - 验证：`flutter test test/reader_legacy_menu_helper_test.dart test/reader_top_menu_test.dart test/simple_reader_view_compile_test.dart` 通过；手工路径 `阅读页 -> 顶部刷新按钮（点击）` 与 `阅读页 -> 顶部刷新按钮（长按）-> 刷新当前章节`（确认两条路径同分支）。
  - 兼容影响：无旧书源兼容性影响；本序号仅收敛 `menu_refresh_dur` 与默认刷新动作映射关系，不改动章节缓存结构与目录数据模型。
  - 已完成 `P3-seq95`：`book_read_refresh.xml / @+id/menu_refresh_after / 刷新之后章节`。
  - `P3-seq95` 差异点清单（实施前）：
    - 现有实现虽已具备“清理当前及后续章节缓存”行为，但缺少独立可复现证据，tracker 中 `seq95` 仍为 `pending`，无法闭环迁移记录。
    - 刷新范围计算散落在页面状态类中，难以稳定验证 `menu_refresh_after` “从当前章节开始清理后续缓存、前序章节保持不变” 的 legado 边界语义。
  - `P3-seq95` 逐项对照清单（实施后）：
    - 入口：已同义（顶栏刷新按钮长按进入 `book_read_refresh` 分支菜单，选择“刷新之后章节”触发对应动作）。
    - 状态：已同义（执行后清理当前及后续章节缓存并重载当前章节，前序章节缓存保持不变）。
    - 异常：已同义（无可用书源时回落到当前章节重载，不新增扩展失败分支，对齐 legado `bookSource==null -> upContent()` 边界）。
    - 文案：已同义（分支文案固定“刷新之后章节”，不引入额外状态文案）。
    - 排版：已同义（分支菜单继续由 `CupertinoActionSheet` 承载，平台样式差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（`menu_refresh_after` 收敛为 `ReaderRefreshScopeHelper.selectionFromLegacyAction(after)`，统一走“从当前章节起清理后续缓存”链路）。
    - 验证：`flutter test test/reader_refresh_scope_helper_test.dart test/reader_legacy_menu_helper_test.dart test/reader_top_menu_test.dart test/simple_reader_view_compile_test.dart` 通过；手工路径 `阅读页 -> 顶部刷新按钮（长按）-> 刷新之后章节`（确认当前及后续缓存被清理且当前章节立即重载）。
  - 兼容影响：无旧书源兼容性影响；本序号仅收敛 `menu_refresh_after` 的范围计算与验证证据，不改动书源模型与章节数据结构。
  - 已完成 `P3-seq96`：`book_read_refresh.xml / @+id/menu_refresh_all / 刷新全部章节`。
  - `P3-seq96` 差异点清单（实施前）：
    - 现有实现已具备 `ReaderLegacyRefreshMenuAction.all` 分支，但缺少“从首章开始清理全量缓存并回写变更章节”的独立可复现证据，tracker 中 `seq96` 仍为 `pending`。
    - `menu_refresh_all` 的关键语义（`startIndex=0, clearFollowing=true`）尚未有单测固定，存在后续序号改动时被回归破坏的风险。
    - “无可用书源时回落到当前章节重载”的 legado 边界虽由共用链路承载，但本序号尚未形成单项迁移结论记录。
  - `P3-seq96` 逐项对照清单（实施后）：
    - 入口：已同义（顶栏刷新按钮长按进入 `book_read_refresh` 分支菜单，选择“刷新全部章节”触发对应动作）。
    - 状态：已同义（有可用书源时从首章起清理全量章节缓存并回写变更章节，随后重载当前章节）。
    - 异常：已同义（无可用书源时回落到当前章节重载，对齐 legado `bookSource==null -> upContent()` 边界）。
    - 文案：已同义（分支文案固定“刷新全部章节”，不新增扩展提示文案）。
    - 排版：已同义（分支菜单继续由 `CupertinoActionSheet` 承载，平台样式差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（`menu_refresh_all` 收敛为 `ReaderRefreshScopeHelper.selectionFromLegacyAction(all)`，统一走 `startIndex=0 + clearFollowing=true` 的全量缓存清理链路）。
    - 验证：`flutter test test/reader_refresh_scope_helper_test.dart test/reader_legacy_menu_helper_test.dart test/reader_top_menu_test.dart test/simple_reader_view_compile_test.dart` 通过；手工路径 `阅读页 -> 顶部刷新按钮（长按）-> 刷新全部章节`（确认全量缓存清理并重载当前章节）。
  - 兼容影响：无旧书源兼容性影响；本序号仅补齐 `menu_refresh_all` 的迁移证据与边界固化，不改动书源模型与章节数据结构。
  - 已完成 `P3-seq97`：`book_read_source.xml / @+id/menu_login / 登录`。
  - `P3-seq97` 差异点清单（实施前）：
    - legado `ReadMenu` 在点击“登录”时通过 `showLogin()` 回调，以 `bookSourceUrl` 作为键启动登录链路；登录动作天然基于“当前最新书源状态”。
    - Flutter 阅读页“登录”动作使用弹层打开时的 `BookSource` 快照对象直接触发登录，缺少按 URL 回查最新书源的边界收敛；在弹层期间书源被删除或替换时可能使用过期快照。
    - `seq97` 在台账中仍为 `pending`，缺少单项迁移闭环记录与可复现验证路径。
  - `P3-seq97` 逐项对照清单（实施后）：
    - 入口：已同义（阅读页顶部“书源名”动作弹层内保留一级“登录”入口）。
    - 状态：已同义（仅当 `loginUrl` 非空时显示“登录”动作；`loginUrl` 为空时隐藏）。
    - 异常：已同义（点击后先按 `bookSourceUrl` 回查最新书源，缺失时提示“未找到书源”，避免使用过期快照静默失败）。
    - 文案：已同义（入口文案保持“登录”，与 legado `@string/login` 语义一致）。
    - 排版：已同义（继续使用 `CupertinoActionSheet` 承载书源动作菜单，平台视觉差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（点击“登录”后按当前书源状态进入登录流程，等价 legado `menu_login -> SourceLoginActivity(type=bookSource,key=bookSourceUrl)` 的实时触发语义）。
    - 验证：手工路径 `阅读页(网络书) -> 顶部书源名 -> 登录`（校验 `loginUrl` 为空时不展示登录；`loginUrl` 非空时点击可进入登录流程）。
  - 兼容影响：无旧书源兼容性影响；本序号仅收敛阅读页 `menu_login` 触发边界，不改动书源解析规则与 Cookie 持久化结构。
  - 已完成 `P3-seq98`：`book_read_source.xml / @+id/menu_chapter_pay / 购买`。
  - `P3-seq98` 差异点清单（实施前）：
    - legado `ReadMenu` 对 `menu_chapter_pay` 的显隐条件是 `loginUrl 非空 && curTextChapter.isVip == true && curTextChapter.isPay != true`；Flutter 端额外依赖 `payAction` 非空，且在章节 `isVip/isPay` 未命中缓存时兜底显示，存在入口显隐语义偏差。
    - legado `payAction()` 仅在异常分支记录 `执行购买操作出错` 日志，不弹扩展失败提示；Flutter 端存在“未配置购买动作/执行失败/返回值不支持”等扩展 toast，状态流转不一致。
    - legado 结果分流为 `isAbsUrl -> 打开网页`、`isTrue -> 清当前章缓存并刷新目录`；Flutter 端使用自定义结果枚举，true 判定口径偏窄，且成功分支仅重载当前章节未刷新目录。
  - `P3-seq98` 逐项对照清单（实施后）：
    - 入口：已同义（书源动作弹层保留“章节购买”一级入口）。
    - 状态：已同义（仅当 `loginUrl` 非空且当前章节 `isVip=true && isPay!=true` 时显示“章节购买”）。
    - 异常：已同义（购买执行异常统一写入日志 `执行购买操作出错`，不追加扩展失败提示；目录刷新失败独立记录日志并保持可观测错误提示）。
    - 文案：已同义（确认弹窗标题固定“章节购买”，正文展示章节标题，不追加扩展成功提示）。
    - 排版：已同义（继续使用 `CupertinoActionSheet` + `CupertinoAlertDialog` 承载入口与确认交互，平台视觉差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（确认后按 `bookSourceUrl` 回查当前书源执行 `payAction`，结果分流对齐 legado：绝对 URL 打开网页、`isTrue` 返回清缓存并刷新目录）。
    - 验证：手工路径 `阅读页(网络书,VIP未购买章节) -> 顶部书源名 -> 章节购买 -> 确定`（校验入口显隐、URL 跳转分支、truthy 分支目录刷新、异常仅写日志）。
  - 兼容影响：无旧书源兼容性破坏；本序号仅收敛 `menu_chapter_pay` 显隐与结果分流语义，不改动书源规则字段结构与 Cookie 持久化链路。
  - 已完成 `P3-seq99`：`book_read_source.xml / @+id/menu_edit_source / 编辑书源`。
  - `P3-seq99` 差异点清单（实施前）：
    - legado `menu_edit_source` 在点击时调用 `openSourceEditActivity()`，内部按当前 `ReadBook.bookSource.bookSourceUrl` 实时启动编辑页；Flutter 端当前使用 action sheet 打开时捕获的 `source` 快照直接打开编辑页，弹层期间若书源状态变化会出现过期触发。
    - legado 仅在 `BookSourceEditActivity` 返回 `RESULT_OK` 时执行 `upBookSource -> upMenuView` 刷新菜单；Flutter 端当前无论保存或取消都刷新书源显示，状态回调边界不一致。
  - `P3-seq99` 逐项对照清单（实施后）：
    - 入口：已同义（书源动作弹层保留“编辑书源”一级入口）。
    - 状态：已同义（点击时按 `bookSourceUrl` 回查当前书源后再打开编辑页，缺失时给出“未找到书源”可观测反馈）。
    - 异常：已同义（弹层期间书源被删除时不再使用过期快照，改为即时拦截并提示，避免静默失败）。
    - 文案：已同义（入口文案维持“编辑书源”，缺失提示与阅读域既有口径一致为“未找到书源”）。
    - 排版：已同义（继续使用 `CupertinoActionSheet` 承载入口，平台样式差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（仅在编辑页保存返回时刷新阅读页书源显示，取消返回不刷新，对齐 legado `RESULT_OK` 回调边界）。
    - 验证：手工路径 `阅读页(网络书) -> 顶部书源名 -> 编辑书源`（校验进入编辑页、删除后回查提示、取消不刷新、保存后刷新）。
  - 兼容影响：无旧书源兼容性破坏；本序号仅收敛 `menu_edit_source` 触发与回调边界，不改动书源保存规则与正文链路。
  - 已完成 `P3-seq100`：`book_read_source.xml / @+id/menu_disable_source / 禁用书源`。
  - `P3-seq100` 差异点清单（实施前）：
    - legado `ReadMenu.menu_disable_source` 点击后直接回调 `disableSource()`，`ReadBookViewModel.disableSource()` 仅执行“将当前书源 `enabled=false` 写库”链路，不弹确认、不弹成功提示。
    - Flutter 阅读页“禁用书源”当前实现为“确认弹窗 + 确认后提示‘已禁用书源’”，状态流转与 legado 直接执行语义不一致。
    - Flutter 当前禁用动作直接使用 action sheet 打开时的 `BookSource` 快照调用 `updateSource(copyWith(enabled:false))`；在弹层期间书源被删除时，`updateSource` 的 upsert 语义可能把已删书源重新写回，偏离实时状态边界。
  - `P3-seq100` 逐项对照清单（实施后）：
    - 入口：已同义（书源动作弹层保留一级“禁用书源”入口）。
    - 状态：已同义（点击后直接执行禁用写库，不再弹确认对话框，不再追加成功提示）。
    - 异常：已同义（执行前按 `bookSourceUrl` 回查当前书源，缺失时提示“未找到书源”，避免使用过期快照写回已删除记录）。
    - 文案：已同义（入口文案保持“禁用书源”，移除“确定禁用/已禁用书源”扩展文案）。
    - 排版：已同义（继续使用 `CupertinoActionSheet` 承载书源动作菜单，平台样式差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（点击后按 `bookSourceUrl` 回查并写库 `enabled=false`，等价 legado `menu_disable_source -> disableSource()` 的直接触发语义）。
    - 验证：手工路径 `阅读页(网络书) -> 顶部书源名 -> 禁用书源`（校验无确认弹窗、点击后立即禁用、无成功 toast）。
  - 兼容影响：无旧书源兼容性破坏；本序号仅收敛 `menu_disable_source` 的触发与状态边界，不改动书源规则结构与阅读正文链路。
  - 已完成 `P2-seq164`：`book_toc.xml / @+id/menu_split_long_chapter / 拆分超长章节`。
  - `P2-seq164` 差异点清单（实施前）：
    - legado `TocActivity` 在目录“更多”菜单 `menu_group_text` 下提供 `menu_split_long_chapter`（固定标题、checkable 勾选态），并且仅本地 TXT 显示；Flutter 目录页当前缺失该入口。
    - legado 点击 `menu_split_long_chapter` 后会立即执行 `upBookAndToc(book)` 重建本地 TXT 目录；Flutter 仅在详情页提供“分割长章节”入口，目录页无法原位切换并即时生效。
  - `P2-seq164` 逐项对照清单（实施后）：
    - 入口：已同义（目录页“更多”菜单补齐“拆分超长章节”，层级与 legado 一致）。
    - 状态：已同义（仅本地 TXT 显示该项，标题固定“拆分超长章节”，通过勾选态表达开关）。
    - 异常：已同义（切换后沿用本地 TXT 目录重建链路，失败继续走既有可观测错误提示）。
    - 文案：已同义（目录菜单文案收敛为“拆分超长章节”）。
    - 排版：已同义（继续使用 `CupertinoActionSheet` 承载目录菜单，平台样式差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（点击后立即切换勾选态并触发本地 TXT 目录重建，目录列表实时刷新，对齐 legado `menu_split_long_chapter -> upBookAndToc` 的即时生效语义）。
    - 验证：手工路径 `书籍详情页 -> 查看目录 -> 更多 -> 拆分超长章节`（校验仅本地 TXT 显示、勾选态切换生效、目录列表即时刷新）。
  - 兼容影响：无旧书源兼容性破坏；本序号仅补齐目录页 `menu_split_long_chapter` 入口与触发链路，不改动网络书目录解析规则。
  - 已完成 `P2-seq166`：`book_toc.xml / @+id/menu_use_replace / 使用替换`。
  - `P2-seq166` 差异点清单（实施前）：
    - legado `TocActivity` 在目录菜单 `menu_group_toc` 中提供 `menu_use_replace`（固定标题“使用替换”、checkable 勾选态），并在点击时仅切换 `AppConfig.tocUiUseReplace`。
    - legado 点击后执行 `chapterListCallBack.clearDisplayTitle() -> upChapterList(searchKey)`，目录标题会即时按开关重算；当前 Flutter 目录页缺失该入口，标题始终应用替换规则，缺少目录级开关语义。
    - legado `tocUiUseReplace` 为全局持久化偏好；当前 Flutter 无对应持久化键，目录替换开关无法跨页面保持一致。
  - `P2-seq166` 逐项对照清单（实施后）：
    - 入口：已同义（目录页“更多”菜单补齐“使用替换”checkable 入口，层级与 legado 一致）。
    - 状态：已同义（标题固定“使用替换”，通过勾选态表达开关，不引入“开/关”动态文案）。
    - 异常：已同义（切换后仅重算目录展示标题，单条标题处理失败时回退原始标题，不新增静默失败分支）。
    - 文案：已同义（菜单文案固定“使用替换”）。
    - 排版：已同义（继续使用 `CupertinoActionSheet` 承载目录菜单，视觉差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（点击后切换全局 `tocUiUseReplace` 并即时刷新目录展示标题，等价 legado `menu_use_replace -> clearDisplayTitle -> upChapterList` 状态流转）。
    - 验证：手工路径 `书籍详情页 -> 查看目录 -> 更多 -> 使用替换`（校验固定文案+勾选态切换、切换后目录标题即时刷新、无成功提示）。
  - 兼容影响：无旧书源兼容性破坏；本序号仅补齐目录页 `menu_use_replace` 入口与标题展示开关，不改动书源规则解析与正文读取链路。
  - 已完成 `P2-seq167`：`book_toc.xml / @+id/menu_load_word_count / 加载字数`。
  - `P2-seq167` 差异点清单（实施前）：
    - legado `TocActivity` 在目录菜单 `menu_group_toc` 中提供 `menu_load_word_count`（固定标题“加载字数”、checkable 勾选态），并在点击时仅切换 `AppConfig.tocCountWords`，随后调用 `chapterListCallBack.upAdapter()` 刷新目录适配器。
    - legado `tocCountWords` 为全局持久化偏好，默认值 `true`；当前 Flutter 缺失对应持久化键，目录字数开关无法跨页面保持一致。
    - 当前 Flutter 详情目录页“更多”菜单缺失“加载字数”入口，且目录列表未接入“按开关显示字数”的展示链路。
  - `P2-seq167` 逐项对照清单（实施后）：
    - 入口：已同义（目录页“更多”菜单补齐“加载字数”checkable 入口，层级与 legado 一致）。
    - 状态：已同义（标题固定“加载字数”，通过勾选态表达开关；全局键 `toc_ui_load_word_count` 默认 `true`，与 legado `tocCountWords` 默认语义一致）。
    - 异常：已同义（切换动作仅刷新目录展示状态；无可用字数字段时保持不显示且不报错）。
    - 文案：已同义（菜单文案固定“加载字数”，未引入“已开启/已关闭”扩展提示）。
    - 排版：已同义（继续使用 `CupertinoActionSheet` 承载目录菜单，平台样式差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（点击后切换全局 `toc_ui_load_word_count` 并即时刷新目录项字数显隐，等价 legado `menu_load_word_count -> upAdapter` 的刷新语义）。
    - 验证：`flutter test test/search_book_info_view_compile_test.dart`、`flutter test test/simple_reader_view_compile_test.dart`、`flutter test test/reader_catalog_sheet_test.dart` 通过；手工路径 `书籍详情页 -> 查看目录 -> 更多 -> 加载字数`（校验固定文案+勾选态切换、无成功提示、目录项字数按开关显隐）。
  - 兼容影响：无旧书源兼容性破坏；本序号仅补齐目录页 `menu_load_word_count` 开关与字数展示链路，不改动书源规则结构。
  - 已完成 `P3-seq69`：`book_read.xml / @+id/menu_add_bookmark / 添加书签`。
  - `P3-seq69` 差异点清单（实施前）：
    - legado `ReadBookActivity.menu_add_bookmark -> addBookmark()` 固定走“创建书签草稿并弹出 `BookmarkDialog` 编辑”语义；当前 Flutter 入口实现为 `_toggleBookmark()`，会出现“有则删无则加”的额外分支。
    - legado `ReadView.click(action=7)` 也复用 `addBookmark()`；当前 Flutter 九宫格点击动作同样复用了 `_toggleBookmark()`，触发语义与 legado 不同。
    - legado 书签跳转依赖 `chapterPos` 恢复阅读位置；当前 Flutter 目录书签点击仅跳章，不使用 `chapterPos`。
  - `P3-seq69` 逐项对照清单（实施后）：
    - 入口：已同义（阅读操作菜单 `menu_add_bookmark` 与九宫格点击动作 `addBookmark` 均统一接入 `_openAddBookmarkDialog()`）。
    - 状态：已同义（弹窗标题固定“书签”，默认展示章节标题并提供“内容/备注”输入；取消不落库，确定才新增书签）。
    - 异常：已同义（新增失败保持可观测提示“书签操作失败：<error>”，不引入静默失败分支）。
    - 文案：已同义（“书签 / 内容 / 备注 / 取消 / 确定”）。
    - 排版：已同义（使用 `CupertinoAlertDialog` 承载章节标题 + 双输入框 + 操作按钮，平台样式差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（目录书签点击新增 `chapterPos -> targetChapterProgress` 恢复路径，按书签进度回跳章节内位置）。
    - 验证：手工路径 `阅读页 -> 阅读操作 -> 添加书签`、`阅读页 -> 九宫格点击动作(添加书签)`、`阅读页 -> 目录/书签 -> 选择书签`（校验弹窗展示、取消不落库、确定新增可见、书签跳转按进度恢复）。
  - 兼容影响：无旧书源兼容性破坏；本序号仅收敛书签交互与进度恢复语义，未改动书源解析与五段链路网络行为。
  - 已完成 `P3-seq70`：`book_read.xml / @+id/menu_edit_content / 编辑内容`。
  - `P3-seq70` 差异点清单（实施前）：
    - legado `ReadBookActivity.menu_edit_content -> showDialogFragment(ContentEditDialog())` 打开编辑页后由 `ContentEditViewModel.loadStateLiveData` 统一驱动加载态；当前 Flutter 虽已具备编辑正文入口，但“重置正文”仅在操作区显示小型 loading，未对整体编辑区域做一致的交互锁定。
    - legado `ContentEditViewModel.initContent` 通过 `execute` 包裹正文抓取异常，失败后不会中断编辑入口；当前 Flutter `_resolveCurrentChapterRawContentForMenu` 直接 await 抓取，异常会向上冒泡并打断“编辑正文/正文倒序”菜单链路。
  - `P3-seq70` 逐项对照清单（实施后）：
    - 入口：已同义（阅读操作菜单 `menu_edit_content` 继续走 `_openContentEditFromMenu()`，保持一级入口层级与 legado 一致）。
    - 状态：已同义（编辑页 `reset` 期间新增全屏遮罩 + `CupertinoActivityIndicator`，并通过 `IgnorePointer` 锁定整页交互，等价 legado dialog 的加载中不可编辑语义）。
    - 异常：已同义（正文抓取失败统一记录 `ExceptionLogService` 节点 `reader.menu.<action>.fetch_content_failed`，并回退当前显示内容继续流程；`edit_content/reverse_content` 场景补齐可观测提示“获取正文失败，已回退当前显示内容”）。
    - 文案：已同义（菜单文案“编辑正文”与编辑页动作文案“关闭/保存/重置/复制全文”保持不变，未引入扩展成功提示）。
    - 排版：已同义（继续使用 `CupertinoPageScaffold` 全屏编辑承载；新增遮罩仅用于加载态，属于 `Shadcn + Cupertino` 平台差异允许范围）。
    - 交互触发：已同义（返回/关闭仍自动回传正文并落库；重置流程保持“清理缓存 -> 重新抓取 -> 回写章节 -> 重载当前章节”主链路）。
    - 验证：手工路径 `阅读页 -> 阅读操作 -> 编辑正文 -> 重置`（校验重置期间全屏遮罩与不可交互）；`阅读页 -> 阅读操作 -> 编辑正文 -> 关闭`（校验关闭自动保存）；`阅读页 -> 阅读操作 -> 反转内容`（校验正文抓取异常时仍可回退当前内容并弹出提示）。
  - 兼容影响：无旧书源兼容性破坏；本序号仅收敛正文编辑菜单的异常兜底与加载态交互，不改动书源规则、Cookie 与五段链路数据模型。
  - 已完成 `P3-seq71`：`book_read.xml / @+id/menu_page_anim / 翻页动画（本书）`。
  - `P3-seq71` 差异点清单（实施前）：
    - legado `menu_page_anim` 点击后进入单选列表（默认/覆盖/滑动/仿真/滚动/无），写入书籍级 `pageAnim(i-1)`，随后立即执行 `upPageAnim + loadContent(false)`；当前 Flutter 该入口会跳转“界面设置”大面板，触发路径与入口层级不一致。
    - legado 该动作是“本书级覆盖”语义；当前 Flutter 无书籍级翻页动画持久化键，菜单动作只能改全局 `pageTurnMode`，会污染其它书籍会话。
    - legado 在样式面板修改全局翻页动画时会先执行 `book.setPageAnim(-1)` 清除本书覆盖；当前 Flutter 无该状态回收边界，容易出现本书覆盖与全局设置互相污染。
  - `P3-seq71` 逐项对照清单（实施后）：
    - 入口：已同义（阅读操作菜单 `menu_page_anim` 改为直接弹出单选列表，不再跳转界面设置面板）。
    - 状态：已同义（新增书籍级翻页动画持久化键 `book_page_anim_map`，支持默认/覆盖/滑动/仿真/滚动/无六档；阅读会话初始化与全局设置变更时均叠加本书覆盖）。
    - 异常：已同义（会话态与持久化态分离：本书菜单只改书籍覆盖并即时生效，不再误写全局阅读设置）。
    - 文案：已同义（菜单文案收敛为“翻页动画（本书）”，单选项文案为“默认/覆盖/滑动/仿真/滚动/无”）。
    - 排版：已同义（继续使用 `Cupertino` 选项底部面板承载单选动作，平台样式差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（菜单选择后立即刷新翻页模式与正文展示；样式面板改全局翻页动画时清除本书覆盖，对齐 legado `setPageAnim(-1)` 边界）。
    - 验证：`flutter test test/reader_legacy_menu_helper_test.dart test/simple_reader_view_compile_test.dart` 通过；手工路径 `阅读页 -> 阅读操作 -> 翻页动画（本书）`（校验单选项、即时生效、本书覆盖与全局设置边界）。
  - 兼容影响：无旧书源兼容性破坏；本序号仅补齐 `menu_page_anim` 的入口语义与书籍级翻页动画状态边界，不改动书源规则解析与正文抓取链路。
  - 已完成 `P3-seq72`：`book_read.xml / @+id/menu_get_progress / 拉取云端进度`。
  - `P3-seq72` 差异点清单（实施前）：
    - legado `menu_get_progress` 触发 `syncBookProgress` 时，云端无进度/无配置/空目录均静默返回；当前 Flutter 会额外弹出“云端暂无该书进度”“当前目录为空，无法同步阅读进度”等扩展 toast，状态流转不一致。
    - legado 仅在 `progress.durChapterIndex < simulatedTotalChapterNum` 时才应用云端进度；当前 Flutter 对越界索引会 `clamp` 到末章后继续覆盖，存在越界回退覆盖风险。
    - legado 拉取失败仅写日志 `拉取阅读进度失败《书名》`，不弹失败 toast；当前 Flutter 会弹“获取进度失败：...”扩展提示，且缺少同义日志节点。
  - `P3-seq72` 逐项对照清单（实施后）：
    - 入口：已同义（阅读操作菜单保留 `获取进度` 入口，触发链路对齐 `menu_get_progress`）。
    - 状态：已同义（云端进度落后于本地时弹确认框；云端进度领先且章节索引合法时直接同步；索引越界时不覆盖本地进度；兼容 legado 原始 `durChapterPos` 位点场景时按章节内容长度估算章节进度）。
    - 异常：已同义（拉取失败仅记录 `reader.menu.get_progress.failed` 日志，不追加失败 toast；云端无进度保持静默返回）。
    - 文案：已同义（确认框标题“获取进度”，正文“当前进度超过云端，是否覆盖为云端进度？”）。
    - 排版：已同义（继续使用 `CupertinoAlertDialog`，平台样式差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（覆盖确认分支仅在本地进度领先时出现；确认后按目标章节与章节进度应用；取消不生效）。
    - 验证：手工路径 `阅读页(已配置 WebDav) -> 阅读操作 -> 获取进度`（校验无配置/无云端数据静默返回、落后分支弹确认框、领先分支直接同步、越界索引不覆盖本地进度、失败仅写日志）。
  - 兼容影响：无旧书源兼容性破坏；本序号仅收敛 `menu_get_progress` 的状态流转与日志可观测边界，不改动书源规则、Cookie 与正文抓取链路。
  - 已完成 `P3-seq73`：`book_read.xml / @+id/menu_cover_progress / 覆盖云端进度`。
  - `P3-seq73` 差异点清单（实施前）：
    - legado `ReadBookActivity.menu_cover_progress` 调用 `ReadBook.uploadProgress(true)`，成功 toast 固定“上传成功”；当前 Flutter 成功提示为“上传进度成功”，文案存在偏差。
    - legado 失败链路是 `AppLog.put("上传进度失败\\n...", toast=true)`，具备日志可观测与失败提示双输出；当前 Flutter 仅弹失败 toast，缺少同义日志节点。
    - legado 在同步开关关闭/未配置 WebDav/无网络场景是静默返回；当前 Flutter 在守卫失败分支存在扩展提示，不符合 legado 静默守卫语义。
  - `P3-seq73` 逐项对照清单（实施后）：
    - 入口：已同义（阅读操作菜单保留 `覆盖云端进度` 一级入口，触发链路对齐 `menu_cover_progress`）。
    - 状态：已同义（同步开关关闭、未配置 WebDav、目录为空时静默返回；上传前先保存本地进度，再构建 payload 上传）。
    - 异常：已同义（上传失败补齐日志节点 `reader.menu.cover_progress.failed`，并保留失败提示）。
    - 文案：已同义（菜单文案由“覆盖进度”收敛为 legado 同义“覆盖云端进度”；成功提示收敛为“上传成功”）。
    - 排版：已同义（继续使用 `CupertinoActionSheet` 承载阅读操作菜单与 toast 反馈，平台样式差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（点击后直接上传本地进度到云端，无确认框；失败提示与异常日志同时可观测）。
    - 验证：手工路径 `阅读页(已配置 WebDav) -> 阅读操作 -> 覆盖云端进度`（校验守卫分支静默返回、成功提示“上传成功”、失败提示“上传进度失败\\n<原因>”并在日志页看到 `reader.menu.cover_progress.failed`）。
  - 兼容影响：无旧书源兼容性破坏；本序号仅收敛 `menu_cover_progress` 的提示/日志/文案语义，不改动书源规则、Cookie 与正文抓取链路。
  - 已完成 `P3-seq74`：`book_read.xml / @+id/menu_reverse_content / 反转内容`。
  - `P3-seq74` 差异点清单（实施前）：
    - legado `reverseContent` 通过 `content.toStringArray()` 逐字符倒序并回写缓存；当前 Flutter 采用“按行倒序”实现，正文反转粒度不一致。
    - legado 仅使用当前章节已缓存正文（`BookHelp.getContent`），正文缺失时静默返回；当前 Flutter 会兜底拉取正文并追加“当前章节暂无可倒序的正文”提示，状态流转偏离。
    - legado 菜单文案为 `reverse_content=反转内容`；当前 Flutter 文案为“正文倒序”，存在用户可见语义差异。
  - `P3-seq74` 逐项对照清单（实施后）：
    - 入口：已同义（阅读操作菜单仅在线书展示 `反转内容`，触发链路对齐 `menu_reverse_content`）。
    - 状态：已同义（正文反转算法收敛为字符级倒序，保持与 legado `toStringArray + insert(0, it)` 同义）。
    - 异常：已同义（无可用缓存正文时静默返回，不追加扩展提示与兜底抓取）。
    - 文案：已同义（菜单文案由“正文倒序”收敛为“反转内容”）。
    - 排版：已同义（继续使用 `CupertinoActionSheet` 承载阅读操作菜单，平台样式差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（点击后回写当前章节缓存并立即重载当前章节，保持无成功 toast 的 legado 语义）。
    - 验证：手工路径 `阅读页(网络书且当前章节已缓存正文) -> 阅读操作 -> 反转内容`（校验入口显隐、字符级倒序结果、无缓存正文静默返回）。
  - 兼容影响：无旧书源兼容性破坏；本序号仅收敛 `menu_reverse_content` 的反转算法与缺失正文边界，不改动书源规则、Cookie 与正文抓取链路。
  - 已完成 `P3-seq75`：`book_read.xml / @+id/menu_simulated_reading / 模拟追读`。
  - `P3-seq75` 差异点清单（实施前）：
    - legado `showSimulatedReading()` 为“配置弹窗 + 持久化 + 刷新正文”链路；当前 Flutter 该菜单仍是自动阅读占位动作，入口语义不一致。
    - legado `simulatedTotalChapterNum()` 使用 `Period.between(startDate, now).days + 1` 口径计算追读天数，并限制目录/翻页/朗读可读章节上限；当前 Flutter 未将该边界贯穿到章节导航与目录展示。
    - legado 在配置后会立即更新阅读会话边界；当前 Flutter 未对“可读章节=0”与“当前章节越界”提供同义收敛。
  - `P3-seq75` 逐项对照清单（实施后）：
    - 入口：已同义（阅读操作菜单 `模拟追读` 打开配置弹窗，包含启用、起始章节、每日章节、开始日期）。
    - 状态：已同义（落盘后立即重算可读章节上限，并统一影响底部章节导航、自动翻页、朗读切章、目录可见范围与进度分母）。
    - 异常：已同义（起始章节/每日章节非法输入阻断保存并提示；可读章节为 0 时清空正文展示且保持会话可继续配置）。
    - 文案：已同义（菜单文案与弹窗标题均为“模拟追读”，字段语义与 legado 对齐）。
    - 排版：已同义（保持 `CupertinoAlertDialog` 结构，平台样式差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（保存后立即重载当前章节或收敛到可读边界；取消不生效）。
    - 验证：`flutter test test/simple_reader_view_compile_test.dart`、`flutter test test/reader_legacy_menu_helper_test.dart`、`flutter test test/reader_catalog_sheet_test.dart`；手工路径 `阅读页 -> 阅读操作 -> 模拟追读`（校验配置保存后可读章节上限即时生效）。
  - 兼容影响：无旧书源兼容性破坏；本序号仅收敛阅读会话的可读章节边界与菜单交互语义，不改动书源解析与网络链路。
  - 已完成 `P3-seq76`：`book_read.xml / @+id/menu_enable_replace / 替换净化`。
  - `P3-seq76` 差异点清单（实施前）：
    - legado `menu_enable_replace` 标题语义为“替换净化（checkable）”；当前 Flutter 文案为“启用替换规则”，用户可见文案偏差。
    - legado `changeReplaceRuleState()` 是“切换书籍级开关 -> 保存 -> 刷新正文（不额外提示）”；当前 Flutter 在切换后追加“已开启/已关闭替换规则”toast，存在扩展反馈。
  - `P3-seq76` 逐项对照清单（实施后）：
    - 入口：已同义（阅读操作菜单保留 `替换净化`，勾选态映射书籍级 `useReplaceRule`）。
    - 状态：已同义（点击后切换书籍级开关并持久化，随后重载当前章节正文）。
    - 异常：已同义（空章节场景保持安全返回，不引入新异常分支）。
    - 文案：已同义（菜单标题收敛为“替换净化”，移除“已开启/已关闭替换规则”扩展提示）。
    - 排版：已同义（沿用阅读操作 `CupertinoActionSheet`，平台样式差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（点击即切换并刷新正文，保持无额外成功提示）。
    - 验证：`flutter test test/reader_legacy_menu_helper_test.dart`、`flutter test test/simple_reader_view_compile_test.dart`；手工路径 `阅读页 -> 阅读操作 -> 替换净化`（校验勾选态与正文刷新联动）。
  - 兼容影响：无旧书源兼容性破坏；本序号仅收敛菜单文案与交互反馈语义，不改动替换规则引擎与书源解析链路。
  - 已完成 `P3-seq77`：`book_read.xml / @+id/menu_same_title_removed / 移除重复标题`。
  - `P3-seq77` 差异点清单（实施前）：
    - legado `menu_same_title_removed` 文案为“移除重复标题”；当前 Flutter 文案为“同名标题去重”，用户可见语义偏差。
    - legado 菜单勾选态来自 `ReadBook.curTextChapter.sameTitleRemoved`（当前章节是否实际移除成功）；当前 Flutter 勾选态来自章节级持久化配置，状态语义不一致。
    - legado 点击动作为 `setRemoveSameTitle(book, chapter, !textChapter.sameTitleRemoved)`，且仅在“当前章节未移除且仍处于启用态”提示“未找到可移除的重复标题”；当前 Flutter 以“配置开关翻转 + 内容比较”判定提示，边界不一致。
    - legado 章节缺失场景静默返回；当前 Flutter 会提示“当前章节不存在”，存在扩展反馈。
  - `P3-seq77` 逐项对照清单（实施后）：
    - 入口：已同义（阅读操作菜单保留 `移除重复标题` 动作，不新增前置拦截入口）。
    - 状态：已同义（勾选态收敛为“当前章节实际发生重复标题移除”，不再使用章节配置态直接表达）。
    - 异常：已同义（章节缺失静默返回；仅在“未移除且已启用”边界提示“未找到可移除的重复标题”）。
    - 文案：已同义（菜单文案由“同名标题去重”收敛为“移除重复标题”）。
    - 排版：已同义（继续使用阅读操作 `CupertinoActionSheet` 承载 checkable 表达，平台视觉差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（点击后按 legado `!sameTitleRemoved` 语义翻转章节级开关并重载当前章节）。
    - 验证：`flutter test test/reader_legacy_menu_helper_test.dart`、`flutter test test/simple_reader_view_compile_test.dart`；手工路径 `阅读页 -> 阅读操作 -> 移除重复标题`（校验文案、勾选态、提示边界与章节重载）。
  - 兼容影响：无旧书源兼容性破坏；本序号仅收敛 `menu_same_title_removed` 文案与状态语义，不改动书源规则与正文抓取链路。
  - 已完成 `P3-seq78`：`book_read.xml / @+id/menu_re_segment / 重新分段`。
  - `P3-seq78` 差异点清单（实施前）：
    - legado `menu_re_segment` 为固定文案 `checkable` 入口，勾选态来源于书籍级 `Book.getReSegment()`；当前 Flutter 虽保留同名入口，但重载前未先保存当前阅读进度，`restoreOffset` 在部分场景会读取旧进度导致位置漂移。
    - legado 点击链路为 `setReSegment(!getReSegment()) -> item.isChecked = getReSegment() -> ReadBook.loadContent(false)`，关键语义是“切换后立即重载当前正文且不追加提示”；当前 Flutter 存在额外的全量章节同步调用，语义颗粒度偏大。
    - legado `Book.ReadConfig.reSegment` 默认值为 `false`；Flutter 端需保持首次进入关闭态并按书籍维度持久化。
  - `P3-seq78` 逐项对照清单（实施后）：
    - 入口：已同义（阅读操作菜单保留 `重新分段`，不新增前置拦截与二级入口）。
    - 状态：已同义（勾选态映射书籍级 `reSegment` 开关；默认关闭，点击后立即翻转并持久化）。
    - 异常：已同义（章节列表为空时静默返回，不追加扩展提示）。
    - 文案：已同义（菜单文案保持固定“重新分段”，勾选态通过前缀勾选符表达）。
    - 排版：已同义（继续使用阅读操作 `CupertinoActionSheet`，平台视觉差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（点击后仅切换书籍级开关并重载当前章节；重载前先保存当前进度，再按 `restoreOffset` 恢复阅读位置，不追加成功 toast）。
    - 验证：手工路径 `阅读页 -> 阅读操作 -> 重新分段`（校验勾选态切换、正文即时重载、无扩展提示、重载后阅读位置保持）。
  - 兼容影响：无旧书源兼容性破坏；本序号仅收敛 `menu_re_segment` 的重载触发与阅读位置恢复语义，不改动书源规则与正文抓取链路。
  - 已完成 `P3-seq79`：`book_read.xml / @+id/menu_enable_review / 段评`。
  - `P3-seq79` 差异点清单（实施前）：
    - legado 在 `book_read.xml` 保留 `menu_enable_review`，但默认 `visible=false`；同时 `ReadBookActivity` 中对应的显示与点击处理分支处于注释状态，运行时语义为“默认隐藏且不可触发”。
    - Flutter 端此前未显式保留该隐藏入口占位，虽结果同样不可触发，但缺少结构化表达，容易在后续菜单重排时误判为遗漏。
  - `P3-seq79` 逐项对照清单（实施后）：
    - 入口：已同义（阅读操作菜单默认不显示“段评”）。
    - 状态：已同义（保持默认隐藏，不引入可切换态）。
    - 异常：已同义（默认不可触发，无新增失败分支）。
    - 文案：已同义（保留 legacy 语义标签“段评”作为隐藏占位文案）。
    - 排版：已同义（不影响现有可见菜单布局与热区）。
    - 交互触发：已同义（菜单模型补齐 `enableReview` 占位，默认 `showReviewAction=false`；事件分发分支保持 no-op，不引入扩展流程）。
    - 验证：手工路径 `阅读页 -> 阅读操作`（校验菜单不出现“段评”且其后续项顺序不变）；代码对照 `legado book_read.xml(menu_enable_review visible=false)` 与 `legado ReadBookActivity` 注释分支确认默认不可触发。
  - 兼容影响：无旧书源兼容性破坏；本序号仅补齐隐藏入口结构同义与触发边界，不改动正文渲染与书源链路。
  - 已完成 `P3-seq80`：`book_read.xml / @+id/menu_del_ruby_tag / 删除ruby标签`。
  - `P3-seq80` 差异点清单（实施前）：
    - legado `book_read.xml` 菜单文案为固定 `删除ruby标签`，当前 Flutter 菜单文案为“删除 ruby 标签”，存在用户可见语义差异。
    - legado 在 `EpubFile.getContent` 中仅移除 `rt/rp` 标签（`elements.select("rp, rt").remove()`），当前 Flutter 额外移除了 `ruby` 包裹标签，清理边界偏离 legacy。
    - legado 点击 `menu_del_ruby_tag` 后走 `refreshContentAll(it)`，语义为“全量清缓存并重载当前章节”；当前 Flutter 使用 `_clearBookCache` 会保留当前章内存正文，刷新边界偏弱。
  - `P3-seq80` 逐项对照清单（实施后）：
    - 入口：已同义（仅 EPUB 阅读场景显示“删除ruby标签”入口，非 EPUB 不显示）。
    - 状态：已同义（保持 checkable 语义，勾选态映射书籍级 `delRubyTag` 状态）。
    - 异常：已同义（入口显隐受 EPUB 边界控制，切换流程无新增静默失败分支）。
    - 文案：已同义（由“删除 ruby 标签”收敛为“删除ruby标签”）。
    - 排版：已同义（继续使用阅读操作 `CupertinoActionSheet` 承载，平台视觉差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（点击后切换书籍级开关、全量清缓存并重载当前章节；文本清理仅删除 `rt/rp` 标签，保留 `ruby` 包裹标签）。
    - 验证：手工路径 `阅读页(EPUB书籍) -> 阅读操作 -> 删除ruby标签`（校验入口显隐、勾选态切换、切换后当前章节重载且注音标签按 `rt/rp` 删除生效）。
  - 兼容影响：无旧书源兼容性破坏；本序号仅收敛 EPUB 正文后处理与菜单文案/刷新语义，不改动书源解析与网络链路。
  - 已完成 `P3-seq81`：`book_read.xml / @+id/menu_del_h_tag / 删除h标签`。
  - `P3-seq81` 差异点清单（实施前）：
    - legado `book_read.xml` 菜单文案为固定 `删除h标签`，当前 Flutter 菜单文案为“删除 h 标签”，存在用户可见语义差异。
    - legado 在 `EpubFile.getBody` 中通过 `select("h1, h2, h3, h4, h5, h6").remove()` 删除整段标题节点；当前 Flutter `_removeHTagLikeLegado` 仅移除标签本身，保留标签内文本，清理边界偏离 legacy。
    - legado 点击 `menu_del_h_tag` 后沿用 `refreshContentAll(it)`，语义为“全量清缓存并重载当前章节”；当前 Flutter 已收敛全量清缓存链路，但需补齐 `h` 标签节点清理语义。
  - `P3-seq81` 逐项对照清单（实施后）：
    - 入口：已同义（仅 EPUB 阅读场景显示“删除h标签”入口，非 EPUB 不显示）。
    - 状态：已同义（保持 checkable 语义，勾选态映射书籍级 `delHTag` 状态）。
    - 异常：已同义（入口显隐受 EPUB 边界控制，切换流程无新增静默失败分支）。
    - 文案：已同义（由“删除 h 标签”收敛为“删除h标签”）。
    - 排版：已同义（继续使用阅读操作 `CupertinoActionSheet` 承载，平台视觉差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（点击后切换书籍级开关并走全量清缓存重载；`h` 标签处理收敛为删除 `h1~h6` 整段节点内容，包含标题文本）。
    - 验证：手工路径 `阅读页(EPUB书籍) -> 阅读操作 -> 删除h标签`（校验入口显隐、勾选态切换、切换后章节内 `h1~h6` 整段节点内容被移除、全量清缓存并重载当前章节）。
  - 兼容影响：无旧书源兼容性破坏；本序号仅收敛 EPUB 正文 `h` 标签清理边界与菜单文案语义，不改动书源解析与网络链路。
  - 已完成 `P3-seq82`：`book_read.xml / @+id/menu_image_style / 图片样式`。
  - `P3-seq82` 差异点清单（实施前）：
    - legado `menu_image_style` 的 `SINGLE` 分支会调用 `book.setPageAnim(0)`，属于书籍级翻页动画覆盖；Flutter 端此前通过 `_updateSettings(...cover...)` 修改全局阅读设置，作用域偏大。
    - legado 选择图片样式后统一 `ReadBook.loadContent(false)` 刷新正文；Flutter 端已有章节重载链路，但需保证 `SINGLE` 联动后仍保持同次重载语义。
  - `P3-seq82` 逐项对照清单（实施后）：
    - 入口：已同义（阅读操作菜单保留“图片样式”一级入口）。
    - 状态：已同义（`DEFAULT/FULL/TEXT/SINGLE` 四档按书籍级持久化）。
    - 异常：已同义（取消选择不生效，保持当前样式）。
    - 文案：已同义（标题“图片样式”，选项保持 legacy 常量文案）。
    - 排版：已同义（切换样式后正文即时重载，图片渲染按所选样式更新）。
    - 交互触发：已同义（选择 `SINGLE` 时改为仅写入书籍级 `pageAnim=覆盖`，不再污染全局设置；随后重载当前章节）。
    - 验证：手工路径 `阅读页 -> 阅读操作 -> 图片样式 -> 选择 DEFAULT/FULL/TEXT/SINGLE`（校验样式即时生效；`SINGLE` 分支仅影响当前书籍翻页动画，切换其它书籍不受影响）。
  - 兼容影响：无旧书源兼容性破坏；本序号仅收敛 `menu_image_style` 的 `SINGLE` 联动作用域，不改动书源解析与正文抓取链路。
  - 已完成 `P3-seq84`：`book_read.xml / @+id/menu_effective_replaces / 起效的替换`。
  - `P3-seq84` 差异点清单（实施前）：
    - legado `menu_effective_replaces` 点击后打开 `EffectiveReplacesDialog`，列表来源是 `ReadBook.curTextChapter.effectiveReplaceRules`（仅当前章节正文实际命中规则）；当前 Flutter 该入口直接跳转 `ReplaceRuleListView`，入口层级与语义不一致。
    - legado 在简繁转换开启（`chineseConverterType > 0`）时会在列表尾部追加固定项“繁简转换”；当前 Flutter 未暴露该同层级入口。
    - legado 对话框内发生编辑（规则编辑或简繁模式变更）后在 `onDismiss` 统一触发 `viewModel.replaceRuleChanged()` 刷新正文；当前 Flutter 缺少该“编辑后统一重载”闭环。
  - `P3-seq84` 逐项对照清单（实施后）：
    - 入口：已同义（阅读操作菜单“起效的替换”改为弹层展示当前章节起效规则，不再跳转规则总列表页）。
    - 状态：已同义（列表仅展示当前章节正文实际命中替换规则；简繁转换开启时追加“繁简转换”项）。
    - 异常：已同义（无命中规则时仅保留关闭动作，不新增扩展失败提示）。
    - 文案：已同义（菜单文案与弹层标题统一为“起效的替换”；简繁入口文案为“繁简转换”）。
    - 排版：已同义（采用 `CupertinoActionSheet` 承载弹层与条目，平台视觉差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（点击命中规则进入规则编辑；点击“繁简转换”进入模式选择；发生编辑后统一清理替换阶段缓存并重载当前章节，等价 `replaceRuleChanged`）。
    - 验证：手工路径 `阅读页 -> 阅读操作 -> 起效的替换`、`起效的替换 -> 选择规则 -> 保存`、`起效的替换 -> 繁简转换 -> 切换模式`（校验命中列表、简繁入口、编辑后即时重载）。
  - 兼容影响：无旧书源兼容性破坏；本序号仅收敛 `menu_effective_replaces` 入口与规则可见性，不改动书源解析、网络请求与正文抓取链路。
  - 已完成 `P2-seq348`：`search_view.xml / @+id/menu_search / 搜索`。
  - `P2-seq348` 差异点清单（实施前）：
    - legado `search_view.xml` 仅提供 `menu_search` 单一 `SearchView actionView` 提交入口；当前 Flutter 搜索页存在“输入框 + 独立搜索按钮”双入口，属于扩展入口偏差。
    - legado 搜索输入提示语义来自 `search_book_key`（“搜索书名、作者”）；当前 Flutter 占位文案为“请输入书名或作者名”，存在文案口径差异。
  - `P2-seq348` 逐项对照清单（实施后）：
    - 入口：已同义（顶部收敛为单一 `ShadInput` 搜索控件，提交动作内聚在控件内搜索图标与键盘 `search`）。
    - 状态：已同义（搜索进行中控件内图标切换为 loading；输入变化时保持 legado 同义“停止搜索并隐藏继续加载入口”状态流转）。
    - 异常：已同义（未新增扩展失败提示，继续复用既有搜索异常汇总与日志可观测链路）。
    - 文案：已同义（搜索占位文案收敛为“搜索书名、作者”）。
    - 排版：已同义（搜索控件保持页面顶部一级入口承载；平台视觉差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（点击控件内搜索图标或键盘提交均触发 `_search()`，不再保留外置独立“搜索”按钮入口）。
    - 验证：手工路径 `搜索页 -> 输入关键字 -> 点击输入框内搜索图标`、`搜索页 -> 输入关键字 -> 键盘搜索`（校验两条路径均可触发搜索；输入变化时会停止搜索并隐藏“继续加载”入口）。
  - 兼容影响：无旧书源兼容性破坏；本序号仅收敛 `menu_search` 的入口形态与文案语义，不改动搜索规则解析、缓存键与书源请求链路。
  - 已完成 `P3-seq5`：`audio_play.xml / @+id/menu_change_source / 换源`。
  - `P3-seq5` 差异点清单（实施前）：
    - legado `AudioPlayActivity` 顶栏固定存在 `menu_change_source` 一级 action，点击后直接进入 `ChangeBookSourceDialog(name, author)`；当前 Flutter 端“朗读”长按入口仍是占位提示“朗读设置暂未实现”，缺少 `audio_play` 维度的换源触发入口。
    - Flutter 端虽已在阅读页顶栏实现 `book_read/menu_change_source`，但该入口不属于音频播放菜单语义，无法覆盖 `audio_play.xml` 的独立入口要求。
  - `P3-seq5` 逐项对照清单（实施后）：
    - 入口：已同义（底部菜单“朗读”长按改为打开“播放”菜单，补齐 `audio_play` 维度换源入口）。
    - 状态：已同义（菜单仅承载当前序号 `menu_change_source` 单项动作；取消仅关闭菜单，不改变阅读状态）。
    - 异常：已同义（换源点击后复用现有整书换源链路与异常边界：书名为空/无可用书源/无候选源时保持可观测提示）。
    - 文案：已同义（菜单标题“播放”，动作文案“换源”与 legado 语义一致）。
    - 排版：已同义（使用 `CupertinoActionSheet` 承载播放菜单，平台视觉差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（点击“换源”后直接进入整书换源候选弹层，等价 legado `menu_change_source -> ChangeBookSourceDialog` 的主触发语义）。
    - 验证：手工路径 `阅读页 -> 底部菜单长按朗读 -> 播放 -> 换源`（校验播放菜单出现“换源”入口，点击后进入换源候选弹层）。
  - 兼容影响：无旧书源兼容性破坏；本序号仅补齐 `audio_play/menu_change_source` 入口与触发语义，不改动书源搜索规则、目录匹配与正文抓取链路。
  - 已完成 `P3-seq6`：`audio_play.xml / @+id/menu_login / 登录`。
  - `P3-seq6` 差异点清单（实施前）：
    - legado `AudioPlayActivity.onMenuOpened` 会按 `AudioPlay.bookSource?.loginUrl` 控制 `menu_login` 显隐；当前 Flutter “播放”菜单仅包含“换源”，缺少登录入口与显隐边界。
    - legado `menu_login` 点击后以 `bookSourceUrl` 触发 `SourceLoginActivity(type=bookSource, key=bookSourceUrl)`；当前 Flutter 缺少 `audio_play` 维度登录触发路径。
  - `P3-seq6` 逐项对照清单（实施后）：
    - 入口：已同义（“播放”菜单补齐“登录”动作，与 `audio_play/menu_login` 同层级）。
    - 状态：已同义（仅在当前书源 `loginUrl` 非空时展示“登录”；`loginUrl` 为空时隐藏）。
    - 异常：已同义（无可用登录入口时不展示动作，不新增扩展失败分支）。
    - 文案：已同义（动作文案固定为“登录”）。
    - 排版：已同义（继续使用 `CupertinoActionSheet` 承载菜单，平台视觉差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（点击“登录”后按 `bookSourceUrl` 复用现有书源登录链路：优先 `loginUi` 表单登录，回退网页登录）。
    - 验证：手工路径 `阅读页(网络书且书源配置 loginUrl) -> 底部菜单长按朗读 -> 播放 -> 登录`（校验 `loginUrl` 非空时展示并可进入登录流程；`loginUrl` 为空时不展示）。
  - 兼容影响：无旧书源兼容性破坏；本序号仅补齐 `audio_play/menu_login` 的显隐与触发语义，不改动书源解析、目录匹配与正文抓取链路。
  - 已完成 `P3-seq8`：`audio_play.xml / @+id/menu_edit_source / 编辑书源`。
  - `P3-seq8` 差异点清单（实施前）：
    - legado `AudioPlayActivity.onCompatOptionsItemSelected` 中 `menu_edit_source` 为播放菜单常驻入口，点击后按当前 `AudioPlay.bookSource.bookSourceUrl` 打开 `BookSourceEditActivity`；当前 Flutter “播放”菜单仅有“登录/换源”，缺少 `audio_play` 维度编辑书源入口。
    - legado 仅在编辑页返回 `RESULT_OK` 时执行 `viewModel.upSource()` 刷新书源显示；当前 Flutter 播放菜单缺少该入口，无法覆盖“取消不刷新、保存返回刷新”的回调边界。
  - `P3-seq8` 逐项对照清单（实施后）：
    - 入口：已同义（“播放”菜单补齐“编辑书源”动作，与 `audio_play/menu_edit_source` 同层级）。
    - 状态：已同义（入口常驻展示；当前书源为空时点击保持 no-op，不新增扩展提示）。
    - 异常：已同义（缺失书源场景不触发编辑页，不新增额外失败分支）。
    - 文案：已同义（动作文案固定为“编辑书源”）。
    - 排版：已同义（继续使用 `CupertinoActionSheet` 承载菜单，平台视觉差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（点击后复用 `_openSourceEditorFromReader(sourceUrl)` 打开书源编辑页；仅在保存返回时刷新当前书源展示，取消返回不刷新）。
    - 验证：手工路径 `阅读页(网络书) -> 底部菜单长按朗读 -> 播放 -> 编辑书源`（校验可进入编辑页、取消返回不刷新、保存返回后刷新当前书源展示）。
  - 兼容影响：无旧书源兼容性破坏；本序号仅补齐 `audio_play/menu_edit_source` 入口与回调边界，不改动书源解析、目录匹配与正文抓取链路。
  - 已完成 `P3-seq87`：`book_read_change_source.xml / @+id/menu_chapter_change_source / 单章换源`。
  - `P3-seq87` 差异点清单（实施前）：
    - legado `menu_chapter_change_source` 会打开 `ChangeChapterSourceDialog`，并在选中候选书源后由用户手动选择目标章节，再执行 `replaceContent` 替换当前章节正文；当前 Flutter 端是“选源后自动匹配章节并立即替换”，缺少手动选章步骤。
    - legado 单章换源成功后仅关闭弹层并刷新当前章节，不弹成功 toast；当前 Flutter 端会弹“已完成章节换源：xxx”，属于扩展反馈。
  - `P3-seq87` 逐项对照清单（实施后）：
    - 入口：已同义（阅读页“换源”按钮长按分支保留“单章换源”入口，仍在 `book_read_change_source` 分支菜单层级触发）。
    - 状态：已同义（单章换源改为“先选候选书源，再选目标章节”两段流程，章节选择默认定位到 legado 同义匹配章节）。
    - 异常：已同义（目录为空/候选章节为空仍给出可观测失败提示；获取正文异常统一走 `章节换源失败：<原因>`）。
    - 文案：已同义（分支菜单文案收敛为“单章换源”；章节选择面板标题同步收敛为“单章换源”）。
    - 排版：已同义（章节选择使用 `OptionPickerSheet` 呈现目标章节列表；平台视觉差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（选择目标章节后仅替换当前阅读章节正文并重载当前章节，不迁移整书来源，不追加成功 toast）。
    - 验证：手工路径 `阅读页(网络书) -> 顶部换源按钮长按 -> 单章换源 -> 选择候选书源 -> 选择目标章节`（校验当前章节正文被替换且章节索引保持不变）；手工路径 `同链路 -> 章节选择面板点取消`（校验取消不落库、不改正文）。
  - 兼容影响：无旧书源兼容性破坏；本序号仅收敛 `menu_chapter_change_source` 的交互与正文替换边界，不改动整书换源、书源落库与目录持久化。
  - 已完成 `P3-seq88`：`book_read_change_source.xml / @+id/menu_book_change_source / 整书换源`。
  - `P3-seq88` 差异点清单（实施前）：
    - legado `book_read_change_source.xml` 中 `menu_book_change_source` 文案是“整书换源”；当前 Flutter 长按“换源”分支菜单该项文案为“书籍换源”，存在用户可见文案语义偏差。
    - legado `menu_change_source/menu_book_change_source` 成功后仅关闭换源弹层并刷新阅读会话，不弹成功 toast；当前 Flutter 整书换源成功后会弹“已切换到：<书源名>”，属于扩展反馈。
  - `P3-seq88` 逐项对照清单（实施后）：
    - 入口：已同义（阅读页“换源”按钮长按分支保留 `menu_book_change_source` 入口，层级不变）。
    - 状态：已同义（长按分支“整书换源”与顶栏点击“换源”均复用同一整书换源候选链路，切源后目录与正文同步刷新）。
    - 异常：已同义（保留整书换源既有可观测失败分支：书名为空/无可用书源/无候选源/目录为空/新源章节为空）。
    - 文案：已同义（分支菜单文案由“书籍换源”收敛为 legado 同义“整书换源”）。
    - 排版：已同义（继续使用 `CupertinoActionSheet` 承载长按分支菜单，平台视觉差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（整书换源成功后保持静默，不再弹“已切换到：...”扩展提示，贴齐 legado `ChangeBookSourceDialog` 成功反馈边界）。
    - 验证：手工路径 `阅读页(网络书) -> 顶部换源按钮长按 -> 整书换源 -> 选择候选书源`（校验文案“整书换源”、切源后目录/正文刷新且无成功 toast）；手工路径 `阅读页(网络书) -> 顶部换源按钮点击`（校验默认点击与长按“整书换源”触发链路一致）。
  - 兼容影响：无旧书源兼容性破坏；本序号仅收敛 `menu_book_change_source` 文案与成功反馈语义，不改动整书换源候选匹配、目录落库与正文抓取链路。
  - 已完成 `P3-seq210`：`content_select_action.xml / @+id/menu_search_content / 全文搜索`。
  - `P3-seq210` 差异点清单（实施前）：
    - legado `TextActionMenu.menu_search_content` 会把选中文本作为 `searchWord` 传给 `SearchContentActivity`，搜索范围是“当前书籍的跨章节正文”；当前 Flutter “搜索正文”仅在当前章节内命中，无法跨章节导航，语义缺口明显。
    - legado `SearchContentActivity` 的核心边界是“空关键词不触发搜索；在线书仅检索已缓存章节；本地书可检索全部章节内容”；当前 Flutter 实现没有这组跨章节与缓存边界。
    - legado 搜索结果导航会展示章节维度信息并支持跨章节跳转；当前 Flutter 结果面板只显示当前章节位置，无法表达“命中章节”。
  - `P3-seq210` 逐项对照清单（实施后）：
    - 入口：已同义（阅读页“搜索正文”继续作为一级动作，提交后直接进入全文结果面板）。
    - 状态：已同义（搜索状态新增“进行中”指示；重复发起搜索会取消旧任务并以新关键词结果覆盖）。
    - 异常：已同义（空关键词静默返回；无命中时保持结果面板空态文案“全文未找到匹配内容”，不追加扩展错误弹窗）。
    - 文案：已同义（保留“搜索正文”语义；结果栏改为“结果 x/y · 章节名”，对齐章节维度反馈）。
    - 排版：已同义（继续使用 `Cupertino` 搜索面板与底部结果条；新增 loading 指示仅用于状态可观测，属于 `Shadcn + Cupertino` 平台差异允许范围）。
    - 交互触发：已同义（命中列表支持上下条切换；命中不在当前章节时先切章再定位，形成跨章节跳转闭环）。
    - 验证：`flutter test test/reader_search_navigation_helper_test.dart`、`flutter test test/reader_top_menu_test.dart`；手工路径 `阅读页 -> 搜索正文 -> 输入当前章节关键词` 与 `阅读页 -> 搜索正文 -> 输入其它章节关键词 -> 上一个/下一个`（校验跨章节命中与定位）。
  - 兼容影响：无旧书源兼容性破坏；本序号仅收敛 `menu_search_content` 的命中范围与跳转语义，不改动书源解析、目录刷新、换源与云端进度链路。
  - 已完成 `P3-seq239`：`font_select.xml / @+id/menu_other / 其它目录`。
  - `P3-seq239` 差异点清单（实施前）：
    - legado `FontSelectDialog` 顶栏菜单包含 `menu_other`，点击后始终触发 `openFolder()` 重选字体目录；当前 Flutter 字体弹层无“其它目录”入口。
    - legado 会持久化 `fontFolder` 并在后续重进弹层时继续以该目录加载字体；当前 Flutter 无字体目录路径持久化。
    - legado 目录重选后会刷新 `ttf/otf` 候选列表；当前 Flutter 仅固定展示预设字体，缺少目录字体刷新链路。
  - `P3-seq239` 逐项对照清单（实施后）：
    - 入口：已同义（阅读页“选择字体”弹层顶部补齐“其它目录”动作，触发层级与 legado `menu_other` 同义）。
    - 状态：已同义（新增字体目录路径持久化与回读；重进阅读后可继续使用已选目录与已选自定义字体路径）。
    - 异常：已同义（目录选择取消/空目录/读取失败均可观测且不崩溃；空目录提示“未找到可用字体文件”）。
    - 文案：已同义（动作文案固定为“其它目录”，不追加扩展入口文案）。
    - 排版：已同义（仅在既有字体弹层头部补齐动作按钮，列表层级与间距节奏保持不变；平台视觉差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（点击“其它目录”后重选目录并刷新 `ttf/otf` 列表；点击目录字体后即时应用到正文）。
    - 验证：`flutter test test/reader_top_menu_test.dart`、`flutter test test/reader_search_navigation_helper_test.dart`、`flutter test test/simple_reader_view_compile_test.dart`；手工路径 `阅读页 -> 样式弹层 -> 字体 -> 其它目录 -> 选择目录` 与 `阅读页 -> 样式弹层 -> 字体 -> 选择目录字体`。
  - 兼容影响：无旧书源兼容性破坏；本序号仅补齐 `menu_other` 的目录重选与字体候选刷新语义，不改动书源解析、搜索/目录/正文抓取与换源链路。
  - 已完成 `P3-seq373`：`speak_engine.xml / @+id/menu_default / 导入默认规则`。
  - `P3-seq373` 差异点清单（实施前）：
    - legado `SpeakEngineDialog` 的 `menu_default` 会调用 `SpeakEngineViewModel.importDefault -> DefaultData.importDefaultHttpTTS`，语义是“删除默认规则（`id<0`）并导入内置 `defaultData/httpTTS.json`”；当前 Flutter 端“语音管理”入口为占位提示，缺少可执行导入动作。
    - legado 默认 HTTP 朗读规则资产来自 `app/src/main/assets/defaultData/httpTTS.json`；当前 Flutter 端缺少对应默认规则资产，无法保证导入内容同源。
  - `P3-seq373` 逐项对照清单（实施后）：
    - 入口：已同义（设置页与源管理页“语音管理”改为可进入“朗读引擎”管理页，并在右上角更多菜单提供“导入默认规则”动作）。
    - 状态：已同义（导入默认规则后列表即时刷新；重复执行时保持“仅重置默认规则”边界）。
    - 异常：已同义（资产读取/解析失败可观测：弹窗提示“导入失败：<原因>”）。
    - 文案：已同义（菜单文案固定“导入默认规则”，与 legado `@string/import_default_rule` 一致）。
    - 排版：已同义（使用 `AppCupertinoPageScaffold + CupertinoActionSheet + CupertinoListSection` 承载，属于 `Shadcn + Cupertino` 允许差异范围）。
    - 交互触发：已同义（动作执行语义收敛为“仅删除默认规则 `id<0>` 并导入 `assets/source/httpTTS.json`；保留用户自定义规则”）。
    - 验证：手工路径 `设置 -> 语音管理 -> 右上角更多 -> 导入默认规则`（校验导入后 `HTTP 朗读引擎` 列表出现默认规则且重复导入不删除用户规则）。
  - 兼容影响：无旧书源兼容性破坏；本序号仅补齐默认 HTTP 朗读规则导入语义与入口，不改动现有朗读执行链路。
  - 已完成 `P3-seq374`：`speak_engine.xml / @+id/menu_import_local / 本地导入`。
  - `P3-seq374` 差异点清单（实施前）：
    - legado `SpeakEngineDialog` 在 `menu_import_local` 分支固定触发 `HandleFileContract.FILE + allowExtensions(txt/json)`；当前 Flutter 朗读引擎页“更多”菜单仅有“导入默认规则”，缺少本地导入入口。
    - legado 本地导入不会直接落库，而是进入 `ImportHttpTtsDialog` 先展示候选项并按 `id + lastUpdateTime` 标记“新增/更新/已有”，默认仅勾选“新增/更新”；当前 Flutter 缺少候选对比与选择流程。
    - legado 确认导入时使用等待态并仅写入勾选项，取消则不落库；当前 Flutter 端缺少该状态流转与交互边界。
  - `P3-seq374` 逐项对照清单（实施后）：
    - 入口：已同义（“朗读引擎”页右上角更多菜单补齐“本地导入”一级入口，对齐 legado `menu_import_local` 层级）。
    - 状态：已同义（选择 `txt/json` 后先进入“导入朗读引擎”候选弹层；候选按 `id + lastUpdateTime` 标记“新增/更新/已有”，默认勾选“新增/更新”，支持全选/取消全选）。
    - 异常：已同义（格式错误时提示“格式不对”；导入异常可观测：日志输出 `ImportError:*` 且弹窗提示“导入失败：<原因>”）。
    - 文案：已同义（菜单文案固定“本地导入”，候选状态文案固定“新增/更新/已有”，不追加扩展成功文案）。
    - 排版：已同义（继续使用 `CupertinoActionSheet + CupertinoPopupSurface` 承载本地导入与候选选择，信息层级保持“入口 -> 候选列表 -> 导入确认”）。
    - 交互触发：已同义（确认导入仅落库勾选项并即时刷新 HTTP 朗读引擎列表；取消文件选择或取消弹层均不落库）。
    - 验证：`flutter test test/widget_test.dart`、`flutter test test/search_view_source_manage_action_test.dart`；手工路径 `设置 -> 语音管理 -> 右上角更多 -> 本地导入 -> 选择 txt/json`（校验候选状态、默认勾选与导入后刷新）。
  - 兼容影响：无旧书源兼容性破坏；本序号仅补齐 `menu_import_local` 本地导入与候选选择语义，不改动阅读朗读执行链路与书源规则结构。
  - 已完成 `P3-seq375`：`speak_engine.xml / @+id/menu_import_onLine / 网络导入`。
  - `P3-seq375` 差异点清单（实施前）：
    - legado `SpeakEngineDialog` 在 `menu_import_onLine` 分支固定触发 `importAlert()`，先弹出 URL 输入框，再进入 `ImportHttpTtsDialog(url)`；当前 Flutter 朗读引擎页“更多”菜单缺少“网络导入”入口。
    - legado `importAlert` 会缓存导入 URL（键 `ttsUrlKey`）并支持删除历史项；当前 Flutter 端缺少网络导入历史管理能力。
    - legado 网络导入与本地导入共用同一候选预览导入语义（新增/更新/已有 + 默认勾选新增/更新 + 仅导入勾选项）；当前 Flutter 端仅覆盖了本地导入链路。
  - `P3-seq375` 逐项对照清单（实施后）：
    - 入口：已同义（“朗读引擎”页右上角更多菜单补齐“网络导入”一级入口，对齐 legado `menu_import_onLine` 层级）。
    - 状态：已同义（点击后进入“网络导入”输入弹层，支持历史记录点选回填与删除；确认后进入“导入朗读引擎”候选弹层，默认勾选新增/更新）。
    - 异常：已同义（输入格式不合法时提示“格式不对”；导入异常可观测：日志输出 `ImportError:*` 且弹窗提示“导入失败：<原因>”）。
    - 文案：已同义（菜单文案固定“网络导入”；输入占位固定 `url`；历史区域文案固定“历史记录”）。
    - 排版：已同义（继续使用 `CupertinoActionSheet + CupertinoPopupSurface` 承载“入口 -> URL 输入/历史 -> 候选列表 -> 导入确认”层级，平台视觉差异属于允许范围）。
    - 交互触发：已同义（HTTP/HTTPS 输入会写入并前置历史；点选历史可回填输入框；确认导入仅落库勾选项并即时刷新列表；取消输入弹层/候选弹层均不落库）。
    - 验证：手工路径 `设置 -> 语音管理 -> 右上角更多 -> 网络导入 -> 输入 URL -> 导入`（校验网络导入弹层、历史记录回填与删除、候选状态与默认勾选、确认后列表刷新、取消不落库）。
  - 兼容影响：无旧书源兼容性破坏；本序号仅补齐 `menu_import_onLine` 网络导入入口与历史记录语义，不改动朗读执行链路与书源规则结构。
  - 已完成 `P3-seq376`：`speak_engine.xml / @+id/menu_export / 导出`。
  - `P3-seq376` 差异点清单（实施前）：
    - legado `SpeakEngineDialog` 在 `menu_export` 分支固定触发 `HandleFileContract.EXPORT`，输出 `fileName=httpTts.json`、`mimeType=application/json`，内容为 `GSON.toJson(adapter.getItems())`；当前 Flutter 朗读引擎页“更多”菜单缺少“导出”入口。
    - legado 导出成功后会弹“导出成功”对话框并展示导出路径，支持复制路径；当前 Flutter 端缺少导出成功后的路径可观测与复制动作。
    - tracker 缺少 `seq376` 行，无法闭环“差异->实现->验证”证据链。
  - `P3-seq376` 逐项对照清单（实施后）：
    - 入口：已同义（“朗读引擎”页右上角更多菜单补齐“导出”一级入口，对齐 legado `menu_export` 层级）。
    - 状态：已同义（点击后进入系统导出流程，默认文件名 `httpTts.json`，导出内容为当前 HTTP 朗读引擎 JSON 数组；取消导出不落盘）。
    - 异常：已同义（导出失败弹窗可观测提示“导出失败：<原因>”，不吞错）。
    - 文案：已同义（菜单文案固定“导出”，成功弹窗标题固定“导出成功”，路径区域文案固定“导出路径：”）。
    - 排版：已同义（继续使用 `CupertinoActionSheet + CupertinoAlertDialog` 承载“入口 -> 系统导出 -> 成功路径确认”层级，平台视觉差异属于允许范围）。
    - 交互触发：已同义（成功弹窗提供“复制路径”动作；复制后给出“已复制导出路径”轻提示）。
    - 验证：手工路径 `设置 -> 语音管理 -> 右上角更多 -> 导出`（校验默认文件名 `httpTts.json`、文件内容为当前 HTTP 朗读引擎 JSON 数组、成功弹窗展示路径且可复制）。
  - 兼容影响：无旧书源兼容性破坏；本序号仅补齐 `menu_export` 导出入口与成功反馈语义，不改动朗读执行链路与书源规则结构。
  - 已完成 `P3-seq378`：`speak_engine_edit.xml / @+id/menu_login / 登录`。
  - `P3-seq378` 差异点清单（实施前）：
    - legado `HttpTtsEditDialog` 在 `menu_login` 分支固定执行“从编辑表单取值 -> `viewModel.save(httpTts)` -> `SourceLoginActivity(type=httpTts,key=id)`”；当前 Flutter 仅有朗读引擎列表承载，缺少 `speak_engine_edit` 编辑页与 `menu_login` 入口。
    - legado 在 `menu_login` 点击时只拦截 `loginUrl` 为空并提示“登录url不能为空”，不依赖列表页已保存态；当前 Flutter 缺少“登录前先按当前编辑输入回写规则”的状态流转。
    - tracker 缺少 `seq378` 行，无法闭环“差异->实现->验证”证据链。
  - `P3-seq378` 逐项对照清单（实施后）：
    - 入口：已同义（HTTP 朗读引擎条目支持进入编辑页，编辑页右上角更多菜单补齐“登录”动作，对齐 legado `speak_engine_edit/menu_login` 层级）。
    - 状态：已同义（点击“登录”时先按当前编辑表单回写规则，再按登录配置分流到登录页）。
    - 异常：已同义（`loginUrl` 为空时提示“登录url不能为空”并终止登录；登录流程失败弹窗可观测“登录失败：<原因>”）。
    - 文案：已同义（菜单文案固定“登录”，空登录地址提示固定“登录url不能为空”）。
    - 排版：已同义（编辑页使用 `AppCupertinoPageScaffold + CupertinoListSection` 承载字段编辑与更多菜单，平台视觉差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（存在 `loginUi` 时进入表单登录；无 `loginUi` 时进入网页登录；两条分支均先执行规则回写）。
    - 验证：手工路径 `设置 -> 语音管理 -> 点击 HTTP 朗读引擎条目 -> 编辑页右上角更多 -> 登录`（校验 `loginUrl` 为空提示“登录url不能为空”；非空时先保存编辑输入再进入登录流程）。
  - 兼容影响：无旧书源兼容性破坏；本序号仅补齐 `menu_login` 触发链路与保存时序，不改动朗读执行链路与导入导出规则结构。
  - 已完成 `P3-seq380`：`speak_engine_edit.xml / @+id/menu_del_login_header / 删除登录头`。
  - `P3-seq380` 差异点清单（实施前）：
    - legado `HttpTtsEditDialog` 在 `menu_del_login_header` 分支固定执行 `dataFromView().removeLoginHeader()`；当前 Flutter 编辑页“更多”菜单仅有“登录/查看登录头”，缺少“删除登录头”入口。
    - legado 删除动作仅清理登录头缓存与关联 Cookie，不触发保存和提示；当前 Flutter 缺少该删除链路，无法从编辑页直接回收登录头状态。
  - `P3-seq380` 逐项对照清单（实施后）：
    - 入口：已同义（HTTP 朗读引擎编辑页“更多”菜单补齐“删除登录头”一级入口，对齐 legado `speak_engine_edit/menu_del_login_header` 层级）。
    - 状态：已同义（点击后按当前规则 `id` 映射 `httpTts:<id>` 键删除登录头缓存，不触发规则保存与登录跳转）。
    - 异常：已同义（缺失缓存时删除动作静默返回，不新增扩展错误提示）。
    - 文案：已同义（菜单文案固定“删除登录头”）。
    - 排版：已同义（继续使用 `CupertinoActionSheet` 承载“更多”菜单，平台视觉差异属于 `Shadcn + Cupertino` 允许范围）。
    - 交互触发：已同义（删除后立即生效；再进入“查看登录头”仅显示标题且无缓存文本）。
    - 验证：手工路径 `设置 -> 语音管理 -> 点击 HTTP 朗读引擎条目 -> 编辑页右上角更多 -> 删除登录头 -> 查看登录头`（校验删除后仅显示标题且删除动作无额外提示）。
  - 兼容影响：无旧书源兼容性破坏；本序号仅补齐 `menu_del_login_header` 删除入口与缓存清理语义，不改动朗读执行链路与导入导出规则结构。
  - 已完成 `P3-seq201`：`content_edit.xml / @+id/menu_save / 保存`。
  - `P3-seq201` 差异点清单（实施前）：
    - legado `ContentEditDialog.menu_save -> save()` 调用 `BookHelp.saveText`，当正文为空字符串时直接返回，不覆盖现有正文缓存；当前 Flutter 编辑正文返回后会无条件用编辑框内容覆盖章节 `content`，空正文会把已缓存正文写成空串。
    - legado `menu_save` 仅负责保存正文并关闭弹层；当前 Flutter 保存链路还会无差别改写 `isDownloaded` 状态，即使正文未有效落库也会被置为已缓存。
  - `P3-seq201` 逐项对照清单（实施后）：
    - 入口：已同义（阅读页“阅读操作 -> 编辑正文”中保留“保存”动作，触发保存后返回阅读页）。
    - 状态：已同义（保存时仅在正文非空时覆盖章节 `content` 并置 `isDownloaded=true`；正文为空时保持原缓存与下载状态不变）。
    - 异常：已同义（本序号不新增网络/解析分支；空正文场景保持静默返回，不追加扩展提示）。
    - 文案：已同义（保持“保存”文案，不新增扩展提示）。
    - 排版：已同义（沿用现有 Cupertino 编辑页承载，平台视觉差异属于允许范围）。
    - 交互触发：已同义（点击“保存”或“关闭”均沿用自动保存链路；空正文不会覆盖当前章节正文缓存）。
    - 验证：手工路径 `阅读页 -> 阅读操作 -> 编辑正文 -> 清空正文后点保存/关闭`（校验返回后当前章节正文不被空串覆盖）；手工路径 `阅读页 -> 阅读操作 -> 编辑正文 -> 修改正文后保存`（校验正文更新并即时生效）。
  - 兼容影响：无旧书源兼容性破坏；本序号仅收敛 `menu_save` 的空内容保存边界，不改动书源解析、目录加载与正文抓取链路。
  - 已完成 `P3-seq202`：`content_edit.xml / @+id/menu_reset / 重置`。
  - `P3-seq202` 差异点清单（实施前）：
    - legado `menu_reset` 失败分支无错误弹窗，执行失败时保持当前编辑内容；当前 Flutter 重置失败会弹出“重置失败”对话框，用户可见语义不一致。
    - legado `initContent(true)` 在重置时先清章节缓存，再按书籍类型回源获取正文（本地书走本地文件读取）；当前 Flutter 在重置链路中会回退到 `_currentContent`，本地书清缓存后也无法从本地文件回读章节正文。
    - legado 重置后触发 `ReadBook.loadContent(..., resetPageOffset=false)` 刷新当前阅读章节；当前 Flutter 失败分支可能中断刷新闭环，缺少同义日志落点。
  - `P3-seq202` 逐项对照清单（实施后）：
    - 入口：已同义（阅读页“阅读操作 -> 编辑正文”保留“重置”动作）。
    - 状态：已同义（重置前先清章节缓存与 `isDownloaded`；网络书按书源重拉正文，本地书按本地文件重读正文后回填编辑框并刷新当前章节）。
    - 异常：已同义（重置失败时保持当前编辑内容并静默返回，不弹扩展失败弹窗；同时记录 `reader.menu.edit_content_reset.failed` 与 `reader.menu.edit_content_reset.reload_failed` 日志）。
    - 文案：已同义（动作文案保持“重置”，未新增扩展提示文案）。
    - 排版：已同义（沿用 Cupertino 全屏编辑页与重置 loading 遮罩，平台视觉差异属于允许范围）。
    - 交互触发：已同义（点击“重置”后执行“清缓存 -> 回源读取 -> 回填编辑框 -> 刷新当前章节”，失败时保持编辑态可继续操作）。
    - 验证：手工路径 `阅读页(网络书) -> 阅读操作 -> 编辑正文 -> 重置`（校验重置后正文回填并刷新当前章节；重拉失败时无“重置失败”弹窗）；手工路径 `阅读页(本地 TXT/EPUB) -> 阅读操作 -> 编辑正文 -> 重置`（校验重置后从本地文件回读章节正文）。
  - 兼容影响：无旧书源兼容性破坏；本序号仅收敛 `menu_reset` 的重置来源与失败边界，不改动书源解析、目录加载与正文抓取主链路。
  - 下一项：`seq204`（`content_search.xml / @+id/menu_enable_replace / 替换`）。

## Surprises & Discoveries

- `2026-02-22`：对照 legado `SourceLoginDialog.menu_show_login_header` 与 `HttpTtsEditDialog.menu_show_login_header` 时确认两者边界不同：前者在有登录头缓存时提供“复制文本”按钮，后者仅只读展示无复制动作。`P4-seq365` 已按前者补齐复制语义，避免错误复用 `P3-seq379` 的只读边界。
- `2026-02-22`：对照 legado `ChangeBookSourceDialog/ChangeChapterSourceDialog.menu_load_toc` 时确认该项是“只切换全局开关 + 勾选态”的纯状态动作，不触发刷新；但该开关会影响后续候选刷新链路是否预加载目录。Flutter 端此前无此入口且候选刷新固定不预加载目录，本序号已补齐入口并将刷新链路改为按开关分支。
- `2026-02-22`：对照 legado `ChangeBookSourceDialog.menu_refresh_list -> ChangeBookSourceViewModel.startRefreshList` 时确认“刷新列表”并非“重新对全部启用书源发起新搜索”，而是“基于当前候选集合逐项刷新并回写列表”；同时 `ChangeChapterSourceDialog` 未处理 `menu_refresh_list`。本序号据此将刷新动作仅接入整书换源候选弹层，避免在单章链路提前引入无效扩展动作。
- `2026-02-22`：对照 legado `HttpTtsEditDialog.menu_paste_source + HttpTtsEditViewModel.importFromClip/importSource` 时确认该动作的关键边界不是“从剪贴板导入并保存”，而是“仅把剪贴板 JSON 回填到编辑表单”：剪贴板为空提示“剪贴板为空”，仅接受 JSON 对象/数组，数组仅取首项，成功后不自动保存也不跳转。本序号已按该边界收敛。
- `2026-02-22`：对照 legado `HttpTtsEditDialog.menu_save` 时确认该动作是“显式保存入口”而非“由其它动作顺带保存”：点击后必须即时持久化并提示“保存成功”，且编辑页保持打开；若仅保留“登录前保存”会丢失独立 `menu_save` 交互语义。本序号已补齐顶栏一级“保存”并保持保存后不退出页面。
- `2026-02-22`：对照 legado `SpeakEngineDialog.menu_add -> HttpTtsEditDialog` 时确认“添加”动作本身不承担保存语义，只负责打开空白编辑承载页；若在入口点击阶段直接写库会偏离 legado 的“由 `menu_save` 提交”状态分层。本序号已先收敛一级入口与“未保存不落库”边界，保存动作留在后续 `seq377` 单项推进。
- `2026-02-22`：对照 legado `FontSelectDialog.menu_default + ChapterProvider.getTypeface` 时确认“默认字体”动作不是“回到预设字体列表首项”，而是“写入系统字体类型（默认/衬线/等宽）并强制清空 `textFont` 自定义路径”；若仅改当前字体索引而不清空自定义路径，会被自定义字体覆盖导致默认字体不生效。本序号已补齐“清空自定义字体 -> 应用系统字体 -> 关闭弹层”闭环。
- `2026-02-22`：推进 `P3-seq209(menu_dict)` 时确认 legado 默认词典规则的 `showRule` 包含 `org.jsoup.Jsoup.parse(result)` 脚本（例如 `select(...).remove().html()`）；Flutter 现有 JS 运行时无法直接执行 Java 互操作脚本。为保持主链路同义，本序号在词典查询层补齐了 jsoup 子集解释（`select/remove/html/text`）并继续复用规则提取链路，保证默认规则可用且不阻断迁移队列。
- `2026-02-22`：对照 legado `content_select_action.xml + TextActionMenu + ReadBookActivity.menu_replace` 时确认 `menu_replace` 的关键前提是“可获得选中文本 `selectedText` 并带入替换编辑页”；当前 Flutter 阅读正文为 `RichText` 分页渲染，缺少选区能力与选区回调，导致该序号无法在不引入基础设施改造的前提下等价复刻。本项已按迁移例外流程标记 `blocked`，等待需求方确认。
- `2026-02-22`：对照 legado `ContentEditDialog.menu_reset -> ContentEditViewModel.initContent(true)` 后确认重置失败边界是“静默保留当前编辑内容”，不弹失败提示；同时本地书重置并非回退当前显示内容，而是回源到本地文件正文。Flutter 端此前“回退当前显示内容 + 重置失败弹窗”会引入语义偏差，本序号已收敛。
- `2026-02-22`：对照 legado `ContentEditDialog.save -> BookHelp.saveText` 时确认 `menu_save` 存在“空正文不落库”的硬边界：`content.isEmpty()` 直接返回且不会覆盖缓存正文。Flutter 端此前无条件覆盖章节内容会把空正文写回缓存并污染阅读结果；本序号已收敛为“仅正文非空才覆盖”。
- `2026-02-22`：对照 legado `ReadRecordActivity` 与 `ReadBook.upReadTime` 后确认 `menu_enable_record` 的核心语义是“全局开关控制阅读记录累计”，而不是“禁用阅读进度保存”。Flutter 端为保持主阅读链路稳定，本序号采用“继续保存章节进度，仅在开关关闭时不刷新 `lastReadTime`”的收敛策略，兼顾开关语义与现有数据模型边界。
- `2026-02-22`：对照 legado `AudioPlayService` 时确认 `audioPlayUseWakeLock` 在服务创建阶段读取一次；因此 `menu_wake_lock` 的同义关键是“全局键落盘 + 菜单勾选反映当前键值”，而不是“即时影响正在播放的会话状态”。Flutter 端本序号已先收敛入口与持久化语义。
- `2026-02-22`：对照 legado `HttpTtsEditDialog.menu_del_login_header` 时确认该动作不是“清空表单中的请求头字段”，而是“按 `id` 映射键 `httpTts:<id>` 删除登录头缓存”；且删除动作本身不触发保存、不弹成功提示。Flutter 端本序号已补齐该独立状态清理语义，避免误把登录头缓存与规则配置字段耦合。
- `2026-02-22`：对照 legado `HttpTtsEditDialog.menu_login` 时确认该动作依赖“编辑表单未保存输入”语义，点击登录必须先按当前输入回写规则再启动登录流程；若直接从列表条目登录会丢失 legado 的“编辑态优先保存”边界。本序号先补齐 `speak_engine_edit` 承载页并把“保存后登录”收敛到同一动作链路。
- `2026-02-22`：对照 legado `SpeakEngineDialog.menu_export` 时确认导出动作不是“生成文本后仅提示成功”，而是“调用系统导出器写出 `httpTts.json` + 成功后展示可复制路径”的完整链路；若缺少路径展示与复制入口，会丢失 legado 的导出可观测反馈。本序号已补齐导出成功路径弹窗与复制路径动作。
- `2026-02-22`：对照 legado `SpeakEngineDialog.menu_import_onLine -> importAlert -> ImportHttpTtsDialog` 时确认“网络导入”不是“仅输入 URL 后直接入库”，而是“URL 输入/历史管理 + 候选预览勾选导入”完整链路；若跳过候选层会破坏与本地导入一致的“新增/更新默认勾选”语义。本序号已补齐输入历史、候选预览与仅导入勾选项闭环。
- `2026-02-22`：对照 legado `SpeakEngineDialog.menu_import_local + ImportHttpTtsDialog` 时确认“本地导入”不是“选文件后直接覆盖导入”，而是“先候选对比（新增/更新/已有）再按勾选项提交”；若跳过候选层会丢失 legado 默认仅勾选新增/更新的状态语义。本序号已补齐候选预览与选择提交闭环。
- `2026-02-22`：对照 legado `DefaultData.importDefaultHttpTTS` 与 `HttpTTSDao.deleteDefault` 时确认 `menu_default` 的真实边界是“仅删除默认规则（`id<0`）并回灌默认资产”，不能清空全量规则；否则会误删用户自定义 HTTP 朗读引擎。
- `2026-02-22`：对照 legado `FontSelectDialog` 时确认 `menu_other` 不是“新增字体入口”，而是“始终可重选字体目录并刷新候选列表”的目录重选动作；Flutter 端此前只有预设字体清单，本序号已补齐目录重选与 `ttf/otf` 列表刷新闭环。
- `2026-02-22`：对照 legado `SearchContentActivity` 时确认 `menu_search_content` 的核心并非“当前章节内查找”，而是“跨章节检索 + 在线仅缓存正文边界 + 跨章节跳转”。Flutter 端此前仅当前章节命中，本序号已收敛。
- `2026-02-22`：对照 legado `book_read_change_source.xml` 时确认 `menu_book_change_source` 的用户可见文案应固定为“整书换源”，不能写成“书籍换源”；同时 `ReadBookActivity` 触发整书换源成功后不提供成功 toast。Flutter 端已将分支文案与成功反馈边界同步收敛。
- `2026-02-22`：对照 legado `ChangeChapterSourceDialog` 时确认 `menu_chapter_change_source` 的核心语义是“手动选章后替换当前章节正文”，不是“按标题自动匹配后立即覆盖”；Flutter 端此前自动匹配会缺失选章交互且附带扩展成功提示，本序号已收敛为“选源 -> 选章 -> 替换当前章正文（成功静默）”。
- `2026-02-22`：对照 legado `AudioPlayActivity` 时确认 `menu_edit_source` 在 `audio_play` 菜单是常驻入口，且刷新边界是“仅编辑保存返回时刷新书源显示（`RESULT_OK`）”；Flutter 端此前播放菜单缺少该入口，本序号已补齐并复用既有“保存返回刷新、取消不刷新”回调语义。
- `2026-02-22`：对照 legado `AudioPlayActivity` 时确认 `menu_login` 的核心边界是“按书源 `loginUrl` 显隐”，而不是“固定展示登录后再提示不可用”；Flutter 端此前“播放”菜单仅有“换源”，本序号已补齐“登录”并收敛到 `loginUrl` 非空才展示。
- `2026-02-22`：对照 legado `AudioPlayActivity` 时确认 `audio_play/menu_change_source` 不是阅读菜单动作，而是音频播放菜单独立入口；Flutter 端此前仅在“朗读长按”保留占位提示，已收敛为“播放菜单 -> 换源”并复用整书换源链路。
- `2026-02-22`：对照 legado `search_view.xml` 时确认 `menu_search` 的核心是“搜索控件自身提交动作”，而非“输入框外再挂一个独立搜索按钮”；Flutter 端此前“输入框 + 独立按钮”会形成扩展入口，本序号已收敛为单一搜索控件内提交。
- `2026-02-22`：对照 legado `EffectiveReplacesDialog` 时确认 `menu_effective_replaces` 的核心不是“进入规则管理”，而是“展示当前章节真实命中的替换规则清单”；并且简繁转换开启时该弹层必须追加“繁简转换”同层级入口。Flutter 端此前直接跳规则总列表会丢失该状态语义，本序号已收敛。
- `2026-02-22`：对照 legado `ReadBookActivity.menu_image_style` 时确认 `SINGLE` 联动只应写入书籍级 `pageAnim=0`，不应修改全局翻页动画设置；Flutter 端此前走全局 `_updateSettings` 会产生跨书籍污染，本序号已收敛为书籍级覆盖。
- `2026-02-22`：对照 legado `EpubFile.getBody` 时确认 `menu_del_h_tag` 的核心不是“把 `h1~h6` 标签删掉”，而是“删除整个 `h1~h6` 节点内容（含标题文本）”；Flutter 端此前仅做去标签会保留标题文字并造成正文重复，本序号已收敛为整段节点移除。
- `2026-02-22`：对照 legado `EpubFile.getContent` 与 `ReadBookActivity.menu_del_ruby_tag` 时确认该功能的同义关键包含两层边界：一是仅移除 `rt/rp` 不移除 `ruby` 包裹标签，二是切换后需走 `refreshContentAll` 的全量清缓存语义。Flutter 端此前分别存在“多删 `ruby` 标签”和“保留当前章内存正文”的偏差，本序号已收敛。
- `2026-02-22`：对照 legado `menu_enable_review` 时确认该项在当前上游代码中属于“结构保留但运行时关闭”状态：`book_read.xml` 默认 `visible=false` 且 `ReadBookActivity` 对应分支已注释。迁移时应避免把该项误当作可见功能实现，正确语义是“保留占位并默认隐藏”。
- `2026-02-22`：对照 legado `menu_re_segment -> ReadBook.loadContent(false)` 时确认该项的关键不仅是开关持久化，还包含“重载后阅读位置保持”语义；Flutter 端若直接 `restoreOffset` 但未先保存当前进度，会在部分场景回到旧位点。本序号已调整为“先保存进度再重载”闭环。
- `2026-02-22`：对照 legado `menu_same_title_removed` 时确认该项勾选态并非“章节配置是否启用”，而是 `curTextChapter.sameTitleRemoved` 的“本章实际移除结果”；且点击动作是按 `!sameTitleRemoved` 翻转章节级开关。Flutter 端已改为同义边界并保留“未移除且已启用”时的提示语义。
- `2026-02-22`：对照 legado `Book.simulatedTotalChapterNum` 时确认追读天数口径并非“起始日到当前日的总天数”，而是 `Period.between(startDate, now).days + 1`（`days` 仅取日期差中的“日”分量）。Flutter 端已按该口径实现 `_legacyPeriodDays`，避免以总天数替代导致可读章节上限漂移。
- `2026-02-22`：对照 legado `menu_enable_replace` 时确认该动作是“checkable 文案 + 即时刷新正文”而非“切换后提示反馈”；Flutter 端已将菜单文案收敛为“替换净化”并移除切换 toast，避免扩展反馈干扰迁移一致性。
- `2026-02-22`：对照 legado `ReadBookViewModel.reverseContent` 时确认该动作是“字符级倒序 + 仅缓存正文 + 缺失静默返回”语义，不包含正文拉取兜底或失败提示；Flutter 端此前“按行倒序 + 提示/兜底拉取”属于扩展行为，本序号已收敛。
- `2026-02-22`：对照 legado `menu_cover_progress -> uploadBookProgress(toast=true)` 时确认该功能是“静默守卫 + 成功固定提示 + 失败日志与提示并存”组合语义：守卫失败（开关关闭/无配置/无网络）不弹提示，上传成功统一“上传成功”，上传异常同时写日志并提示失败。Flutter 端此前存在扩展提示与文案漂移，本序号已收敛。
- `2026-02-22`：对照 legado `menu_get_progress -> syncBookProgress` 时确认该功能的关键是“静默同步 + 条件确认 + 越界不覆盖”：无云端进度与失败场景不弹扩展提示，仅写日志；且仅 `durChapterIndex` 合法时才应用。Flutter 端此前存在扩展 toast 与越界 `clamp` 覆盖，本序号已收敛为同义边界。
- `2026-02-22`：对照 legado `menu_page_anim + ReadStyleDialog` 时确认“翻页动画（本书）”与“样式面板翻页动画”是两层状态机：前者写书籍级覆盖、后者改全局并清书籍覆盖。Flutter 端若只做全局 `pageTurnMode` 会互相污染，本序号已拆分为“本书覆盖键 + 样式面板改全局时清覆盖”双路径。
- `2026-02-22`：对照 legado `ContentEditDialog + ContentEditViewModel` 时确认 `menu_edit_content` 的风险点不在入口缺失，而在“正文抓取异常不能中断编辑链路”；Flutter 端已将 `_resolveCurrentChapterRawContentForMenu` 收敛为“异常记录 + 回退当前内容 + 可观测提示”。
- `2026-02-22`：`P3-seq69` 对照 legado 时确认“添加书签”在阅读菜单和九宫格点击动作都必须走同一“弹窗确认后新增”路径；Flutter 端原“有则删无则加”会把 legado 中不存在的删除分支暴露到一级入口，已统一收敛并补齐按 `chapterPos` 恢复书签跳转进度。
- `2026-02-22`：对照 legado `TocActivity + ChapterListAdapter` 时确认 `menu_load_word_count` 的核心不在“新增字数计算”，而在“全局 checkable 开关 + 目录适配器刷新”；Flutter 端先收敛开关语义与持久化默认值，再在已缓存章节上补齐字数显隐，保证在现有章节模型下尽量等价。
- `2026-02-22`：对照 legado `TocActivity` 时确认 `menu_use_replace` 不是“阅读替换规则开关”的别名，而是“目录展示层开关 + 全局持久化”的独立语义；本序号已将目录标题展示收敛为 `tocUiUseReplace && 书籍启用替换规则` 组合判断，并在目录页点击后即时重算标题。
- `2026-02-22`：对照 legado `TocActivity` 时确认 `menu_split_long_chapter` 的关键不是“可改设置”，而是“目录页 checkable 入口 + 切换后立即重建目录”的组合语义；若只保留详情页入口会造成目录页状态流转缺口。本序号已补齐目录页入口并复用本地 TXT 即时重建链路。
- `2026-02-22`：`P3-seq100` 对照 legado 时确认“禁用书源”核心风险不在开关写库，而在 Flutter `updateSource` 的 upsert 行为会放大弹层快照副作用：若弹层期间书源已被删除，直接用快照写库可能把记录重建；本序号已收敛为按 `bookSourceUrl` 实时回查后再禁用。
- `2026-02-22`：`P3-seq99` 对照 legado 时确认“编辑书源”与“登录/购买”属于同类时序边界：若弹层打开后书源被删除，继续使用弹层快照会偏离 legado 的实时回查语义；本序号已统一改为按 `bookSourceUrl` 回查后再触发编辑。
- `2026-02-22`：`P3-seq98` 对照 legado `String?.isTrue()` 时确认购买动作的“成功判定”不是仅 `true/1/ok`，而是“非空且不属于 `false|no|not|0`”即视为真；Flutter 端已按该口径收敛，避免 `payAction` 返回自定义 truthy 字符串时被误判为失败。
- `2026-02-22`：`P3-seq97` 对照 legado 时确认阅读页“登录”动作与书源管理条目登录存在同类边界风险：若弹层打开后书源状态变化，直接使用快照对象会偏离“按当前书源状态触发”的语义；本序号已统一为按 `bookSourceUrl` 回查后再触发登录链路。
- `2026-02-22`：`P3-seq96` 对照 legado 时确认“刷新全部章节”的高风险点不是运行逻辑缺失，而是缺少 `startIndex=0 + clearFollowing=true` 的独立回归证据；本序号补齐 `ReaderRefreshScopeHelper` 的 `menu_refresh_all` 映射与全量清缓存测试后，已可稳定证明全量刷新边界。
- `2026-02-22`：`P3-seq95` 补证据时发现“刷新之后章节”的核心风险不是实现缺失，而是范围计算与验证证据分散在页面状态类中，难以稳定回归；本序号将范围计算抽离为 `ReaderRefreshScopeHelper` 后，已能稳定证明“从当前章节开始清理后续缓存、前序不受影响”的 legado 边界。
- `2026-02-22`：`P3-seq94` 对照 legado 时确认 `menu_refresh` 与 `menu_refresh_dur` 不是“主动作 + 子菜单”两套独立逻辑，而是同一刷新分支；Flutter 端已将默认刷新动作集中到 `defaultRefreshAction/current`，避免后续序号改动导致触发语义漂移。
- `2026-02-22`：`P2-seq83` 对照 legado 时确认 `menu_update_toc` 在本地书籍并不会被拦截，而是走“本地重载目录”链路；Flutter 端此前将本地书拦截为“不支持检查更新”，本序号已收敛为本地/在线统一可触发目录刷新。
- `2026-02-22`：`P2-seq68` 对照 legado 时确认“设置编码”不是固定选项选择器，而是允许自由输入的 `charset` 文本框；若限制为枚举会丢失 legado 的开放输入语义。本序号已改为输入式对话框并保留建议值展示。
- `2026-02-22`：`P2-seq67` 对照 legado `TxtTocRuleDialog` 时确认 `menu_toc_regex` 的关键边界是“取消不生效、确定统一提交”，不是“点选即生效”；Flutter 端已将阅读页规则选择收敛为确认式弹窗并移除扩展成功提示。
- `2026-02-22`：`P2-seq66` 对照 legado 时确认 `menu_download` 不是“更多菜单中的下载动作”，而是在线阅读顶栏一级 action（`showAsAction=always`）；Flutter 端若保留二级入口会形成层级偏差，因此本序号同步将离线缓存从“阅读操作”菜单移出并收敛到顶栏。
- `2026-02-22`：`P2-seq64` 对照 legado 时确认“换源分支菜单（章节/整书）”在 Android 端挂在 `menu_change_source` 图标长按手势，而不是点击后的二级弹窗；Flutter 端已将默认点击收敛为整书换源，并在顶栏按钮补齐长按分支入口。
- `2026-02-22`：`P2-seq163` 对照 legado `TextFile.getChapterList` 时确认“指定 `tocRegex`”与“自动识别”是两条不同语义：指定规则不应再回退自动分章；Flutter 端已在 `TxtParser` 增加 `tocRuleRegex` 透传，并将“指定规则无匹配”收敛为可观测空目录结果。
- `2026-02-22`：`P2-seq163` 的目录页 widget 回归在 Drift 写库链路上复现了既有阻塞问题（测试环境中目录重建任务无法稳定收敛）；本序号保留“入口与手工路径”证据，并将自动化验证下沉到 parser/refresh/settings 定向测试闭环，运行时逻辑不受影响。
- `2026-02-22`：对照 legado `TocActivity` 时确认 `menu_search` 关键边界不是“有搜索能力即可”，而是“默认折叠 actionView + 失焦自动 iconify”；Flutter 端已按该边界从常驻内联输入收敛为顶栏可折叠搜索入口并补齐定向回归。
- `2026-02-22`：`P2-seq165` 对照 legado 时确认 `menu_reverse_toc` 属于“固定文案的一次性菜单动作”语义，不是页面内常驻按钮或 checkable 子项；Flutter 端已将页面内“倒序”按钮收敛为“更多 -> 反转目录”并补齐菜单触发回归。
- `2026-02-22`：`P2-seq168` 的目录导出回归中，默认 `ReaderBookmarkExportService` 会触发系统文件选择器，widget 环境下不可稳定复现；为保证单项证据可复现，`SearchBookInfoView` 增加了仅测试可选的 `bookmarkExportService` 注入点，默认运行时行为保持不变。
- `2026-02-22`：`P2-seq169` 对照 legado `TocActivity` 时确认 `menu_export_md` 与 `menu_export_bookmark` 属于同一书签菜单组的并列入口，不应复用同一文案或参数；Flutter 端已在目录“更多”菜单补齐独立“导出(MD)”入口，并通过定向回归固化 `.md` 扩展名与 Markdown 导出触发链路。
- `2026-02-21`：历史计划文档体量较大且聚焦阅读器，不适合作为“全量逐项迁移”主执行文档，已改为统一 tracker 驱动。
- `2026-02-21`：对照 legado `TextDialog` 构造逻辑确认 `content` 为空时会按空字符串直接展示，不会追加“暂无源码”提示；`P2-seq137` 已据此移除空源码拦截分支并保持入口可达。
- `2026-02-21`：`P2-seq138` 对照 legado 时确认 `menu_book_src` 与 `menu_search_src` 一样采用 `TextDialog("html", bookSrc)` 直出语义；Flutter 端原“详情源码 + 空内容拦截”属于扩展路径，已在本序号收敛。
- `2026-02-21`：`P2-seq139` 对照 legado 时确认 `menu_toc_src` 同样采用 `TextDialog("html", tocSrc)` 直出语义；Flutter 端原“目录源码 + 空内容拦截”属于扩展路径，已在本序号收敛。
- `2026-02-21`：`P2-seq140` 对照 legado 时确认 `menu_content_src` 与 `menu_search_src/menu_book_src/menu_toc_src` 共享同一 `TextDialog("html", raw)` 直出语义；Flutter 端原“正文源码 + 空内容拦截”属于扩展路径，已在本序号收敛。
- `2026-02-21`：`P2-seq141` 的 `widget test` 若直接依赖组件内部 `SourceExploreKindsService`，无法稳定构造“首次加载失败、刷新后成功”的对照场景；为保证迁移证据可复现，调试页补充了“发现分类加载/清缓存”可注入回调，默认运行路径保持不变。
- `2026-02-21`：`P2-seq142` 对照 legado 时确认调试页帮助并非内置提示，而是 `showHelp("debugHelp")` 文档链路；Flutter 资产目录此前缺少 `debugHelp.md`，已补齐同源文档并切换到统一帮助弹层展示。
- `2026-02-22`：`P2-seq143` 的条目“置顶”链路在 `widget test` 环境中会因 Drift 批量写库出现阻塞，导致“入口触发已命中但持久化断言不稳定”；本序号为 `SourceListView` 增加可选 `moveSourcesHandler` 注入点，仅用于稳定验证 `menu_top` 触发与分流语义，默认运行时行为保持不变。
- `2026-02-22`：`P2-seq144` 对照 legado 时确认“置底”并非简单固定写底序；在反序场景必须走 `topSource` 分流。Flutter 运行链路已同义，当前序号主要补齐“升序/反序分流”的可复现回归证据。
- `2026-02-22`：`P2-seq145` 的边界回归里，若在 action sheet 已打开后立刻删除书源再点击“登录”，会出现列表重绘与弹层生命周期竞争，导致 UI 断言偶发不稳定；本序号保留稳定可复现的两条核心证据（入口显隐 + 登录跳转），并在实现层补齐“按 URL 回查书源”的缺失边界。
- `2026-02-22`：`P2-seq146` 的 widget 回归中，`CupertinoActionSheetAction` 在部分场景会出现命中区域漂移，`tap` 触发不稳定；测试侧改为直接调用 action `onPressed` 以稳定复现菜单触发语义，不影响运行时交互实现。
- `2026-02-22`：`P2-seq147` 对照 legado 时确认 `menu_debug_source` 的关键约束是“菜单点击后直达调试页，不在入口做二次查库拦截”；Flutter 端原 `_openEditor(initialTab:3)` 会因入口前回查导致调试页不可达，已改为按条目快照直达并补齐定向回归。
- `2026-02-22`：`P2-seq148` 对照 legado 字符串时确认删除确认弹窗标题应为 `draw=提醒`，不是“提示”；Flutter 端已将标题收敛为“提醒”并补齐“先移除选中态、取消不恢复、确认后删除”回归证据。
- `2026-02-22`：`P2-seq148` 的删除回归里，`SourceRepository.getSourceByUrl` 会受静态缓存时序影响出现短暂旧值；本序号将确认删除断言改为直接查询 Drift `source_records` 行存在性，以保证验证证据稳定可复现。
- `2026-02-22`：`P2-seq149` 对照 legado 时发现单项“启用发现”若直接调用 `updateSource(copyWith)` 会在 action sheet 打开期间被删除的场景下把书源重新 upsert 回库；本序号改为“先按 URL 回查现存记录再更新”，将边界行为收敛为 legado 的“仅更新已存在记录”语义并补齐删除后不重建回归。
- `2026-02-21`：在 `widget test` 场景下直接调用 `RssSourceRepository.addSource/addSources` 进行写库会出现阻塞；`P1-seq276` 改为内存 `FakeRssSourceRepository` 提供可控分组数据，保证分组菜单回归用例稳定可复现。
- `2026-02-21`：`P2-seq30` 页面级测试中，`testWidgets` 直接执行 Drift 写库会阻塞；改为 `tester.runAsync` 包裹 `BookRepository.addBook` 后恢复稳定，可复用到后续涉及 DB 预置数据的详情页测试。
- `2026-02-21`：`P2-seq31` 对照 legado 时发现当前分享入口存在“二维码预览中间页 + 文本回退分享”扩展语义，需在当前序号内收敛为直接系统分享二维码并对齐失败提示。
- `2026-02-21`：`P2-seq32` 对照 legado 字符串时发现当前详情页上传入口仍保留“上传到远程”扩展文案，且确认弹窗附加远程 URL；需在当前序号内收敛为固定提醒文案与确认路径。
- `2026-02-21`：`P2-seq33` 新增本地刷新测试时，详情页 widget 用例在 `pumpAndSettle` 下会被页面持续动画阻塞；改为 service 层定向单测可稳定复现本地刷新行为并避免假阻塞。
- `2026-02-21`：`P2-seq34` 页面级回归确认了 legado 的边界语义：即使书源配置了 `loginUi`，只要 `loginUrl` 为空，“登录”入口仍应隐藏；该规则已在 Flutter 端固化为可复现测试。
- `2026-02-21`：`P2-seq35` 页面级回归中发现 `BookRepository` 缓存快照存在时序抖动；置顶验证改为直接校验 Drift `book_records` 行字段，确保“写库结果”可稳定复现。
- `2026-02-21`：对照 legado `BaseSource.setVariable/getVariable` 时确认源变量边界语义是“仅 `null` 删除，空字符串保留并可回读”；Flutter 端原先将空串视为删除，已在 `P2-seq36` 收敛。
- `2026-02-21`：对照 legado `Book.putCustomVariable -> RuleDataInterface.putVariable` 时确认书籍变量边界语义与源变量一致：仅 `null` 删除，空字符串保留并可回读；Flutter 端原先将空白字符串视为删除，已在 `P2-seq37` 收敛。
- `2026-02-21`：`P2-seq38` 页面级回归中，若直接用 `MethodChannel('flutter/platform')` 伪造剪贴板会触发 `Message corrupted`；改为 `SystemChannels.platform` 同编解码通道后，剪贴板写入断言恢复稳定。
- `2026-02-21`：`P2-seq39` 对照 legado 时发现目录链接复制仍保留“空值拦截 + 已复制目录链接”扩展语义；已收敛为与 `sendToClip` 同义的“始终复制并统一提示复制完成”。
- `2026-02-21`：`P2-seq40` 对照 legado 时确认“允许更新”必须以 checkable 状态表达，不应把开关状态写进标题文本；Flutter 端已改为固定标题 + 勾选图标，并移除切换成功提示。
- `2026-02-21`：`P2-seq41` 对照 legado 时发现本地 TXT 重解析链路未读取 `splitLongChapter` 设置，导致开关只改 UI 不改解析策略；已在 `TxtParser.reparseFromFile` 与详情/阅读两侧调用链补齐参数透传，并将详情页切换动作改为“保存设置后立即重解析”。
- `2026-02-21`：`P2-seq42` 对照 legado 时确认“删除提醒”属于 checkable 静默开关语义：状态应由勾选态表达，切换不追加成功提示；Flutter 端已收敛为固定标题 + 勾选图标并移除开关提示文案。
- `2026-02-21`：`P2-seq43` 在 widget 场景中触发 `CupertinoActionSheetAction` 的异步清理链路时，需要通过 `tester.runAsync` 驱动数据库异步任务，否则会出现“动作已触发但清理结果未落盘”的假阴性；已固化到定向回归用例。
- `2026-02-21`：`P2-seq44` 对照 legado 时发现详情页“日志”虽已存在入口，但仍沿用“异常日志”页面跳转语义；需收敛为 `menu_log -> AppLogDialog` 弹层，并将空态文案统一到“暂无日志”。
- `2026-02-21`：`P2-seq45` 对照 legado 时发现编辑保存链路存在两处语义漂移：作者空白输入被回退为旧值，以及保存后追加“书籍信息已保存”扩展提示；已在本序号内收敛。
- `2026-02-21`：`P2-seq101` 的页面级测试发现 `RemoteBooksPlaceholderView` 依赖 `ShadTheme` 上下文；定向测试需以 `ShadApp.custom + ShadAppBuilder` 包裹后方可稳定复现刷新行为。
- `2026-02-21`：`P2-seq102` 对照 tracker 后确认 `menu_sort_name/menu_sort_time` 在台账中是独立序号（`seq103/104`）；当前序号仅收敛父级 `menu_sort` 入口与子菜单承载，避免跨序号并项实现。
- `2026-02-21`：`P2-seq103` 对照 legado `AlphanumComparator` 时发现普通字符串排序会把 `b10` 排在 `b2` 前；已按 chunk 比较规则实现 Dart 等价比较，确保名称排序语义一致。
- `2026-02-21`：`P2-seq104` 对照 legado `sortCheck(RemoteBookSort.Default)` 时确认“更新时间排序”并非固定单向排序，而是可重复点击切换升/降序；Flutter 端已补齐该状态机并追加页面级回归用例。
- `2026-02-21`：`P2-seq105` 页面级回归中，配置页返回后需显式触发目录重载才能对齐 legado `onDialogDismiss -> upPath`；已在远程页收敛为“配置页关闭即刷新当前目录”并通过测试固化。
- `2026-02-21`：`P2-seq106` 对照 legado `showHelp("webDavBookHelp")` 时发现 Flutter 资产仅包含 `appHelp.md`；需补齐同源 `webDavBookHelp.md` 后才能完成远程页帮助入口同义迁移。
- `2026-02-21`：`P2-seq107` 的页面级回归需要先清空 `ExceptionLogService` 才能稳定断言“暂无日志”空态；已在远程页定向测试中固化该前置动作。
- `2026-02-21`：`P2-seq108` 对照 legado 时确认“精准搜索”属于 `checkable` 菜单语义，不应以“开启/关闭”值文本承载；Flutter 端已改为勾选态并补齐定向回归。
- `2026-02-21`：`P2-seq109` 定向回归暴露 `SourceListView` 在 Linux/测试环境对 QuickJS 动态库的强依赖；已将 `js_runtime_native` 收敛为惰性初始化并在缺库时降级为空运行时，恢复书源管理入口可测可用。
- `2026-02-21`：`P2-seq110` 对照 legado 时确认当前“搜索范围 quick sheet”属于扩展流程，且将 `menu_search_scope` 变成二级入口；已移除该扩展并恢复“多分组/书源”一级直达语义。
- `2026-02-21`：`P2-seq111` 对照 legado 时确认搜索页“日志”必须是 `AppLogDialog` 弹层语义；Flutter 原实现仍跳转 `ExceptionLogsView` 页面，已收敛为弹层并补齐定向回归。
- `2026-02-21`：`P2-seq112` 对照 legado 时确认 `menu_screen` 的关键不只是“有筛选框”，还包括“入口位于工具栏 action 位且仅书源模式可见”；Flutter 端已将筛选输入迁移到导航栏 trailing 并补齐显隐回归。
- `2026-02-21`：`P2-seq113` 对照 legado 时确认当前排序入口的唯一偏差在父级标题文案（“排序选项” vs “排序”）；本序号仅收敛父级语义与回归证据，排序子项行为继续按 `seq114~121` 串行推进。
- `2026-02-21`：`P2-seq114` 对照 legado 时确认 `menu_sort_desc` 是固定“反序”checkable 项，不是“切换为降序/升序”的动态文案；Flutter 端已收敛为固定文案 + 勾选态并补齐定向回归。
- `2026-02-21`：`P2-seq115` 对照 legado 时确认当前偏差属于“迁移证据缺口”而非实现缺口；已新增“先切换到其它排序再切回手动排序”的定向回归，用例固化 `menu_sort_manual` 单选勾选态语义。
- `2026-02-21`：`P2-seq116` 对照 legado 时确认当前偏差集中在菜单文案（“权重” vs “智能排序”）与证据缺口；已收敛文案并新增“智能排序勾选态保持”定向回归，确保 `menu_sort_auto` 语义可复现。
- `2026-02-21`：`P2-seq117` 对照 legado 时确认偏差集中在菜单文案（“名称” vs “名称排序”）与证据缺口；已收敛文案并新增“名称排序勾选态保持”定向回归，确保 `menu_sort_name` 语义可复现。
- `2026-02-21`：`P2-seq118` 对照 legado 时确认偏差集中在菜单文案（“地址” vs “地址排序”）与证据缺口；已收敛文案并新增“地址排序勾选态保持”定向回归，确保 `menu_sort_url` 语义可复现。
- `2026-02-21`：`P2-seq119` 对照 legado 时确认当前偏差集中在菜单文案（“更新时间” vs “更新时间排序”）与证据缺口；已收敛文案并新增“更新时间排序勾选态 + 反序联动勾选态”定向回归，确保 `menu_sort_time` 语义可复现。
- `2026-02-21`：`P2-seq120` 对照 legado 时确认当前偏差集中在菜单文案（“响应时间” vs “响应时间排序”）与证据缺口；已收敛文案并新增“响应时间排序勾选态保持”定向回归，确保 `menu_sort_respondTime` 语义可复现。
- `2026-02-21`：`P2-seq121` 对照 legado 时确认 `menu_sort_enable` 有两处偏差：菜单文案（“启用状态” vs “是否启用”）与反序边界（Flutter 误将同组名称也反序）；已收敛文案并补齐“是否启用 + 反序同组名称正序”回归，确保 `menu_sort_enable` 语义可复现。
- `2026-02-21`：`P2-seq122` 对照 legado 时确认当前实现缺口主要是入口图标语义（`folder` vs `ic_groups`）和证据缺口（缺少分组入口触发/动态分组筛选用例）；已收敛图标并补齐页面级回归。
- `2026-02-21`：`P2-seq123` 在 widget test 中涉及 `CupertinoActionSheet -> CupertinoPopupSurface -> CupertinoAlertDialog` 三层叠加，点击目标易受底层同名按钮干扰；回归用例改为“分组管理入口/新增弹窗/分组行编辑删除入口可见性”定向断言，保持证据稳定可复现。
- `2026-02-21`：`P2-seq124` 对照 legado 时确认分组菜单筛选项存在“文案与过滤关键字绑定”隐式约束：若文案从“启用”收敛为“已启用”，过滤分支也必须同步识别“已启用”，否则会出现入口文案同义但筛选结果不生效的断层；已同步收敛并补齐定向回归。
- `2026-02-21`：`P2-seq125` 与 `seq124` 共享同一隐式约束：`menu_disabled_group` 文案改为“已禁用”后，过滤分支必须同步识别“已禁用”；否则只改文案会导致筛选语义漂移。已同步收敛并补齐定向回归。
- `2026-02-21`：`P2-seq126` 对照 legado 时确认 `menu_group_login` 同样存在“文案与过滤关键字绑定”隐式约束：若筛选项文案从“需登录”收敛为“需要登录”，过滤分支也必须同步识别“需要登录”，否则会出现入口文案同义但筛选结果不生效。已同步收敛并补齐定向回归。
- `2026-02-21`：`P2-seq127` 与 `seq124~126` 共享同一隐式约束：`menu_group_null` 文案改为“未分组”后，过滤分支必须同步识别“未分组”；否则只改文案会导致筛选语义漂移。已同步收敛并补齐定向回归。
- `2026-02-21`：`P2-seq128` 与 `seq124~127` 共享同一隐式约束：`menu_enabled_explore_group` 文案改为“已启用发现”后，过滤分支必须同步识别“已启用发现”；否则只改文案会导致筛选语义漂移。已同步收敛并补齐定向回归。
- `2026-02-21`：`P2-seq129` 延续 `seq124~128` 的同一隐式约束：`menu_disabled_explore_group` 文案改为“已禁用发现”后，过滤分支必须同步识别“已禁用发现”；否则只改文案会导致筛选语义漂移。已同步收敛并补齐定向回归。
- `2026-02-21`：执行 `flutter test test/source_list_view_sort_action_test.dart` 全量回归时，既有用例“书源管理是否启用反序时同启用状态内名称保持正序”在连续场景偶发找不到 `B-enabled`；同用例以 `--plain-name` 单独重跑可稳定通过。本序号保留定向验证证据，测试稳定性问题待后续独立处理。
- `2026-02-21`：`P2-seq130` 的 widget 回归中，`CupertinoIcons.ellipsis_circle` 存在多实例匹配（导航栏与其它图标节点）；定向用例需限定在 `CupertinoNavigationBar` 作用域内点击，才能稳定触发“更多”菜单。
- `2026-02-21`：`P2-seq131` 对照 legado 时确认“本地导入”语义不仅体现在 `menu_import_local` 菜单项，还体现在异常分支提示口径；若仅修改入口文案而不更新 CORS 降级提示，会出现同一功能域内文案口径不一致。
- `2026-02-21`：`P2-seq132` 对照 legado 时确认“网络导入”语义同时覆盖三个用户可见位置（菜单入口、导入弹层标题、错误提示建议）；只改入口不改弹层/提示会形成同链路文案割裂。
- `2026-02-21`：`P2-seq133` 对照 legado 时确认“二维码导入”链路只要求“扫码结果直接进入导入处理”；Flutter 端原有“扫码 URL 同步写入网络导入历史”属于扩展行为，已移除以避免跨入口状态耦合。
- `2026-02-21`：`P2-seq134` 对照 legado 时确认 `menu_group_sources_by_domain` 的关键约束是“固定标题 + checkable 勾选态”，不是“根据状态切换开/关文案”；Flutter 端已收敛为固定“按域名分组显示”并补齐勾选态回归。
- `2026-02-21`：`P2-seq136` 的 widget 回归如果直接走真实扫码页面，会受到 `mobile_scanner` 插件平台通道影响导致测试不稳定；本序号通过在调试页引入可注入扫码启动器，仅对 `menu_scan` 触发语义做定向断言，保证迁移证据稳定可复现。

## Decision Log

- `2026-02-22` 决策 159：`P4-seq366` 采用“登录页单项补齐 + 静默清理”策略：在 `SourceLoginFormView` 的“更多”菜单仅新增 `menu_del_login_header`，点击后执行“删除 `loginHeader_<sourceKey>` + 按书源 URL 作用域清理 Cookie”；清理失败不提示，保持 legado `removeLoginHeader()` 的静默边界。该序号不提前并入 `menu_log`（`seq367`）后续能力，保持一项一处理。
- `2026-02-22` 决策 158：`P4-seq365` 采用“登录承载页单项补齐 + 复制语义按源类型分流”策略：在 `SourceLoginFormView` 顶栏新增“更多”入口，仅补齐 `menu_show_login_header`；点击后按当前书源键读取 `loginHeader_<sourceKey>` 缓存并弹出“登录头”对话框，有缓存时展示原始文本并提供“复制文本”动作，无缓存仅标题。该序号不提前并入 `menu_del_login_header/menu_log` 后续能力，保持一项一处理。
- `2026-02-22` 决策 157：`P4-seq360` 采用“入口文案收敛 + 导入仅回填表单”策略：`SourceEditLegacyView.menu_qr_code_camera` 文案收敛为“二维码导入”，扫码承载标题收敛为“扫描二维码”；扫码成功后仅执行 `upSourceView` 等价回填，不更新 `_savedSource/_savedSnapshot`，不追加成功提示，保持“导入后仍需用户手动保存”的 legado 边界，不提前并入 `menu_show_login_header/menu_del_login_header` 后续序号能力。
- `2026-02-22` 决策 156：`P4-seq354` 采用“入口显式写入 scope 再跳转”策略：`SourceEditLegacyView.menu_search` 保持“先保存再跳转”主链路不变，但将搜索范围写入从 `SearchView.scoped(sourceUrls)` 的页面内隐式推导收敛为入口侧显式 `searchScope=SearchScope.fromSource(saved)`；随后打开常规搜索页。该策略与 legado `BookSourceEditActivity.menu_search -> putExtra(searchScope, SearchScope(source))` 触发语义同义，不提前并入 `menu_qr_code_camera/menu_show_login_header/menu_del_login_header` 后续序号能力。
- `2026-02-22` 决策 155：`P4-seq353` 采用“入口显隐沿用 `loginUrl`，分流判定收敛为 `loginUi` 原始非空”策略：`SourceEditLegacyView.menu_login` 点击后继续复用“先保存再跳转”主链路；登录承载分流从“可解析 loginUi 行”改为“`loginUi` 字符串非空即表单承载”，与 legado `SourceLoginActivity(loginUi.isNullOrEmpty())` 语义同义，不提前并入 `menu_search/menu_clear_cookie` 后续序号能力。
- `2026-02-22` 决策 154：`P4-seq192` 采用“共享候选弹层补齐 checkable 入口 + 刷新链路按开关分支”策略：在 `SourceSwitchCandidateSheet` 新增“更多 -> 加载目录”动作，点击仅翻转并持久化 `changeSourceLoadToc`；不自动刷新当前候选。候选重拉时按开关决定是否执行“搜索后预加载目录并回填最新章节”，目录预加载失败按单源隔离，保持 legado 状态边界。
- `2026-02-22` 决策 153：`P4-seq188` 采用“候选弹层内热刷新 + 当前候选来源范围约束”策略：在 `SourceSwitchCandidateSheet` 新增可选“刷新列表”回调，由阅读页传入“按当前候选来源集合重拉结果”的实现；刷新中禁用“刷新列表/书源管理”动作，刷新失败静默保留当前列表，不提前并入 `menu_load_toc/menu_load_word_count`（后续序号）能力。
- `2026-02-22` 决策 152：`P4-seq187` 采用“共享候选弹层单点补齐 + 路由回调复用”策略：在 `SourceSwitchCandidateSheet` 仅新增可选“书源管理”回调入口，由阅读页传入 `SourceListView` 打开逻辑，同时复用于“整书换源/单章换源”两条路径；保持“点击仅跳转管理页，不提前并入 `menu_refresh_list/menu_load_toc` 后续序号能力”。
- `2026-02-22` 决策 149：`P3-seq377` 采用“顶栏一级保存 + 非阻塞成功反馈”策略：在 `speak_engine_edit` 顶栏新增独立“保存”动作并与“更多”并列；点击仅执行“表单回写持久化 -> 成功提示‘保存成功’”，不触发登录、不关闭页面。登录链路继续保留“先保存再登录”的既有语义，两条路径互不替代。
- `2026-02-22` 决策 148：`P3-seq372` 采用“一级添加入口先收敛 + 保存动作后置”策略：在语音管理页顶栏补齐 `menu_add` 同义入口，点击仅创建空白 HTTP 朗读引擎草稿并打开编辑承载页，不在当前序号执行写库、副作用导入或导出流程；保存闭环严格留在下一序号 `seq377(menu_save)` 单独实现，保持一项一处理。
- `2026-02-22` 决策 146：`P3-seq238` 采用“系统字体动作独立入口 + 清空自定义字体优先”策略：在字体弹层顶部单独补齐 `menu_default` 同义入口，点击后弹出“系统内置字体样式”三选项并映射到当前阅读字体预设；确认后强制执行 `clear custom font path` 再应用系统字体并关闭字体弹层，不提前并入字体目录加载与其它扩展行为，保持按队列串行推进。
- `2026-02-22` 决策 141：`P3-seq207` 采用“选中文本复用既有书签编辑闭环”策略：不新增独立书签存储流程，而是在文本操作菜单补齐 `menu_bookmark` 并复用 `_showBookmarkEditorDialog` 的确认落库语义；`bookText` 预填选中文本，取消不写库，确定后写库并刷新书签状态。当前 `chapterPos` 继续沿用现有阅读器进度编码模型，避免在本序号跨入书签存储结构改造。
- `2026-02-22` 决策 140：`P3-seq205` 采用“词级选区起点 + 文本动作菜单先闭环”策略：在 `PagedReaderWidget` 补齐长按文本提取回调，并在阅读页接入 `menu_replace` 动作；当前先收敛到“长按提取词级 selectedText -> 替换规则编辑”闭环，不提前并入 `menu_bookmark/menu_aloud/menu_dict/menu_browser/menu_share_str` 后续序号逻辑，确保按队列串行推进。
- `2026-02-22` 决策 139：`P3-seq205` 采用“先阻塞、后确认”策略：由于当前 Flutter 阅读器缺失“选中文本菜单”基础设施，无法等价复刻 legado `menu_replace(selectedText -> ReplaceEditActivity)` 语义，先将 ExecPlan 状态标记为 `blocked`；待需求方确认后在两种路径中二选一推进：A 先补选区基础设施再迁移（推荐），B 明确批准临时降级方案并登记例外回补计划。
- `2026-02-22` 决策 127：`P3-seq373` 采用“入口承载补齐 + 默认规则边界同义”策略：先将设置页/源管理页“语音管理”从占位提示收敛为“朗读引擎”管理页，再仅实现 `menu_default` 动作；导入逻辑严格按 `id<0` 删除默认项并从 `assets/source/httpTTS.json` 回灌默认规则，不提前并入 `menu_import_local/menu_import_onLine/menu_export` 后续序号能力。
- `2026-02-22` 决策 126：`P3-seq210` 采用“跨章节检索优先 + 缓存边界同义”策略：全文搜索收敛为跨章节命中列表，命中跳转支持自动切章后定位；在线书仅检索已有缓存正文，本地书检索全章节已加载正文；搜索并发采用任务令牌取消旧请求，避免结果乱序覆盖。
- `2026-02-22` 决策 125：`P3-seq88` 采用“文案同义 + 成功静默”策略：长按“换源”分支菜单 `menu_book_change_source` 文案收敛为“整书换源”，并移除整书换源成功 toast；换源候选匹配、目录落库与正文刷新流程继续复用既有主链路，不跨序号并入 `seq210` 的全文搜索动作。
- `2026-02-22` 决策 124：`P3-seq87` 采用“手动选章同义优先”策略：单章换源从“选源后自动匹配章节”收敛为“选源后手动选择目标章节再替换当前章节正文”，并移除成功 toast 以对齐 legado `ChangeChapterSourceDialog -> replaceContent` 的静默成功边界；整书换源行为保持原链路，留待 `seq88` 单独闭环。
- `2026-02-22` 决策 123：`P3-seq8` 采用“入口补齐 + 回调边界复用”策略：在播放菜单仅新增 `menu_edit_source` 动作，点击后复用现有 `_openSourceEditorFromReader(sourceUrl)` 链路；刷新语义保持“仅保存返回刷新、取消不刷新”，不提前并入 `menu_copy_audio_url/menu_wake_lock/menu_log` 后续序号逻辑，确保按队列串行推进。
- `2026-02-22` 决策：`P3-seq69` 以 legado `ReadBookActivity.addBookmark()` 为准，统一采用“打开书签编辑弹窗并确认后新增”语义，不在该入口保留“已存在即删除”扩展分支；同时在目录书签跳转链路接入 `chapterPos` 进度恢复，确保添加与回跳语义闭环。
- `2026-02-21` 决策 1：执行粒度下沉到单项（seq），避免模块级“完成但漏项”。
- `2026-02-21` 决策 2：执行方式固定串行（不并行），优先稳定推进与可追溯。
- `2026-02-21` 决策 3：基于需求“挨个处理所有功能”，全功能域纳入计划，不再仅限核心链路。
- `2026-02-21` 决策 4：主入口底栏项按 `seq` 串行收敛，`P1-seq257/258` 分别对齐 legado 的 `300ms` 双击触发阈值语义，不跨越到未到序号的业务菜单实现。
- `2026-02-21` 决策 5：主入口底栏文案以 legado 中文业务语义为准，`P1-seq259` 将 `RSS` 明确收敛为“订阅”。
- `2026-02-21` 决策 6：`P1-seq261` 保持书架搜索入口为顶栏一级动作（非折叠菜单项），并以“点击即进搜索页”作为与 legado 的同义标准。
- `2026-02-21` 决策 7：`P1-seq262` 保持“更新目录”在书架更多菜单层级，空数据场景优先提供可观测提示而非静默返回。
- `2026-02-21` 决策 8：`P1-seq263` 菜单文案以 legado 字符串语义为准，将“本机导入”统一为“添加本地”，并保持本地导入触发链路不变。
- `2026-02-21` 决策 9：`P1-seq264` 先收敛入口语义（文案 + 页面导航），远程书籍页内菜单与数据行为保留到后续对应序号逐项迁移，避免跨序号并项。
- `2026-02-21` 决策 10：`P1-seq265` 网址加书链路按 legado 口径优先复刻“`baseUrl` 精确匹配 + `bookUrlPattern` 回退匹配”，并复用现有 `BookAddService` 完成详情与目录入库，避免重复实现数据写入逻辑。
- `2026-02-21` 决策 11：`P1-seq266` 先收敛“入口可达”语义，书架管理页内批量操作（删除/允许更新/批量换源等）保持后续序号分步迁移，不与当前序号并项实现。
- `2026-02-21` 决策 12：`P1-seq267` 按同一策略先收敛“缓存/导出”入口语义（文案 + 页面导航），`CacheActivity` 页内下载/导出/分组/日志菜单保留到 P6 对应序号迁移，避免跨序号并项实现。
- `2026-02-21` 决策 13：`P1-seq268` 对齐 legado 的弹窗层级语义，先将“分组管理”从提示文案收敛为对话框承载入口；分组新增/编辑/排序等复杂行为保留到后续对应序号逐项迁移，避免跨序号并项实现。
- `2026-02-21` 决策 14：`P1-seq269` 采用“入口先完整收敛 + 配置字段同步落盘”的策略：以 `bookshelfLayoutIndex/bookshelfSortIndex` 作为 legado 索引语义主字段，同时回写 `bookshelfViewMode/bookshelfSortMode` 兼容现有页面，避免一次性改动冲击已迁移链路。
- `2026-02-21` 决策 15：`P1-seq270` 维持现有文件保存实现（`FilePicker.saveFile`）不引入中间临时文件，但补齐 legado 同义的成功弹窗路径复制语义与错误文案口径，避免跨序号扩展导出基础设施。
- `2026-02-21` 决策 16：`P1-seq271` 复用现有书单导入执行器（按书名/作者搜索入库）但将入口交互与输入解析严格收敛到 legado 语义（`url/json` 输入 + 选择文件 + `http/https 或 JSON 数组`），避免在同一序号跨入后续批量导入策略重构。
- `2026-02-21` 决策 17：`P1-seq272` 采用“日志入口弹层先收敛”的实现策略，复用既有日志数据服务但将入口触发层级与文案统一到 legado `AppLogDialog` 语义，避免在当前序号引入额外日志管线重构。
- `2026-02-21` 决策 18：`P1-seq273` 将发现页分组入口从通用选单收敛为“动态分组动作列表直达筛选”的 legado 同义语义，并同步收敛分组排序（`cnCompare`）与 `group:` 逗号边界匹配规则，避免出现“入口同义但筛选语义偏差”。
- `2026-02-21` 决策 19：`P1-seq274` 采用“同源资产直读 + 弹层承载”策略，直接引入 legado `appHelp.md` 到 Flutter 资产并由“我的”页顶栏触发，优先保证帮助文档内容与入口语义同义，不在当前序号扩展 Markdown 渲染器替换链路。
- `2026-02-21` 决策 20：`P1-seq275` 先收敛 RSS 顶栏“收藏”入口触发与页面标题语义，并将收藏页内部菜单（分组/删除）保留到 `P7-seq307~309`，避免跨序号并项实现。
- `2026-02-21` 决策 21：`P1-seq276` 将订阅页“分组”入口从通用选项面板收敛为 legado 同义“动态分组菜单”，并移除“全部”扩展项；为保证回归稳定性，新增基于内存仓库的页面级测试用例，不在该序号引入数据库写入链路重构。
- `2026-02-21` 决策 22：`P1-seq277` 不新增业务实现，仅通过补充“设置入口直达订阅源管理页”的定向回归用例闭环证据，以保持 `menu_rss_config -> RssSourceActivity` 入口语义与现有 Flutter 路由实现同义。
- `2026-02-21` 决策 23：`P2-seq30` 在保持现有实现不变的前提下，以“页面级测试 + 手工路径”补齐迁移证据，优先闭环 `menu_edit` 同义性验证，不在该序号提前并入 `menu_share_it/menu_refresh` 等后续动作。
- `2026-02-21` 决策 24：`P2-seq31` 采用“直接系统分享 + 载荷纯对齐”策略：移除详情页分享中间预览页，分享文本固定为 `bookUrl#bookJson` 并仅输出二维码图片；二维码生成失败统一提示“文字太多，生成二维码失败”。
- `2026-02-21` 决策 25：`P2-seq32` 采用“菜单语义先收敛 + 远程标记延续既有映射”的策略：入口文案与 `sure_upload` 弹窗文案严格对齐 legado，同时保留现有 `book_remote_upload_url_map` 作为“已存在远程链接”判定来源，避免在该序号提前重构本地书籍数据模型。
- `2026-02-21` 决策 26：`P2-seq33` 采用“刷新分流同义化”策略：`_triggerRefresh` 在书架内按本地/网络类型分流；本地链路新增 `SearchBookInfoRefreshHelper` 复用 TXT/EPUB 解析能力并回写章节与书籍元数据，网络链路保留既有目录刷新逻辑，避免跨序号改动登录/置顶等后续菜单动作。
- `2026-02-21` 决策 27：`P2-seq34` 采用“实现不扩展、证据先闭环”策略：保持现有登录入口实现不引入额外扩展逻辑，仅补齐 `menu_login` 的可见性与触发分支页面级回归用例，并回填 tracker/计划文档。
- `2026-02-21` 决策 28：`P2-seq35` 采用“触发语义先收敛”策略：移除详情页置顶的前置拦截提示，收敛为 legado 同义“点击即写库”，并新增 helper + 页面级回归用例闭环置顶证据。
- `2026-02-21` 决策 29：`P2-seq36` 采用“边界语义优先收敛”策略：源变量存储对齐 legado `setVariable/getVariable`（空串保留、仅 `null` 删除），并移除保存后的扩展成功提示，确保 `menu_set_source_variable` 仅保留 legado 定义的状态流转与文案语义。
- `2026-02-21` 决策 30：`P2-seq37` 延续变量边界收敛策略：书籍变量存储对齐 legado `putCustomVariable`（空串保留、仅 `null` 删除），并将错误提示与保存后反馈收敛为 legado 同义最小文案，不新增扩展提示链路。
- `2026-02-21` 决策 31：`P2-seq38` 采用“入口语义 + 边界触发同义化”策略：菜单文案收敛为“拷贝书籍 URL”，复制反馈统一为“复制完成”，并按 legado 保留空字符串也执行复制；`menu_copy_toc_url` 保持待下一序号（`P2-seq39`）处理，避免跨序号并项。
- `2026-02-21` 决策 32：`P2-seq39` 采用与 `menu_copy_book_url` 对称的复制策略：菜单文案收敛为“拷贝目录 URL”，复制动作统一走“写入剪贴板 + 复制完成提示”，并移除空值拦截以对齐 legado `sendToClip` 语义。
- `2026-02-21` 决策 33：`P2-seq40` 采用“标题语义固定 + 勾选态表达状态”策略：将 `menu_can_update` 文案收敛为固定“允许更新”，以勾选图标表达开关状态并移除切换成功提示，同时保留“仅书架内持久化”的 legado 边界行为。
- `2026-02-21` 决策 34：`P2-seq41` 采用“解析层参数化 + 详情页即时重解析”策略：为 `TxtParser.reparseFromFile` 增加 `splitLongChapter` 参数并贯穿到 `SearchBookInfoRefreshHelper` 与 `SimpleReaderView`，详情页切换开关后强制触发本地刷新（禁用刷新成功 toast）再统一输出开关提示，确保与 legado “切换即生效”语义同义。
- `2026-02-21` 决策 35：`P2-seq42` 采用与 legado 一致的 checkable 菜单语义：删除提醒标题固定为“删除提醒”并通过勾选态表达状态，切换后不追加“已开启/已关闭”扩展提示；保留现有删除提醒持久化键以避免跨序号改动设置结构。
- `2026-02-21` 决策 36：`P2-seq43` 采用“触发语义统一 + 缓存实体补丁”策略：`menu_clear_cache` 移除书架态前置拦截并统一成功提示为“成功清理缓存”；同时修复 `Chapter.copyWith` 的 `content` 显式置空能力，保证清理缓存后内存态与持久化态同义。
- `2026-02-21` 决策 37：`P2-seq44` 采用“入口不变、触发层级收敛”策略：保留详情页“日志”菜单位置与排序，仅将动作从页面跳转改为 `showAppLogDialog` 弹层，并将日志空态文案统一为“暂无日志”，对齐 legado `menu_log -> AppLogDialog` 语义。
- `2026-02-21` 决策 38：`P2-seq45` 采用“保存语义去扩展”策略：保留编辑页保存入口层级，仅收敛字段提交与反馈口径（作者空白按输入落库、移除成功提示、失败可观测），不在本序号提前扩展 `BookType`/封面文件迁移等非 `menu_save` 核心逻辑。
- `2026-02-21` 决策 39：`P2-seq101` 采用“最小必要链路”策略：先实现 `menu_refresh` 所需的目录重载能力（路径栈、PROPFIND 拉取、失败可观测），排序/服务器配置/帮助/日志菜单严格留待后续 `seq102~107`，避免跨序号并项。
- `2026-02-21` 决策 40：`P2-seq102` 采用“入口先同义、行为后续拆分”策略：本序号仅补齐顶栏排序入口与 `名称排序/更新时间排序` 子菜单承载，具体排序执行逻辑严格留待 `seq103/104` 逐项实现。
- `2026-02-21` 决策 41：`P2-seq103` 采用“名称排序单序号收敛”策略：仅实现 `menu_sort_name` 的状态切换与目录重载，并在 Flutter 端补齐 legado `AlphanumComparator` 等价比较；`menu_sort_time` 保留到 `seq104`，不跨序号并项。
- `2026-02-21` 决策 42：`P2-seq104` 采用“时间排序独立收敛”策略：在不改动 `seq103` 名称排序链路的前提下，仅补齐 `menu_sort_time` 的 `sortCheck(Default)` 状态切换与重载触发，并新增页面级回归验证“首次切换升序 + 再次点击降序”。
- `2026-02-21` 决策 43：`P2-seq105` 采用“入口同层级 + 配置关闭即刷新”策略：在远程书籍页补齐 `menu_server_config` 更多菜单入口，配置承载页复用现有 WebDav 设置字段（地址/账号/密码/目录），并在返回远程页时强制触发目录重载，对齐 legado `onDialogDismiss -> initData -> upPath` 语义。
- `2026-02-21` 决策 44：`P2-seq106` 采用“同源资产直读 + 入口单项收敛”策略：在不提前实现 `menu_log` 的前提下，仅补齐“帮助”动作并直接加载 legado `webDavBookHelp.md` 文档，同时保留加载失败可观测提示，确保序号边界与迁移语义同时满足。
- `2026-02-21` 决策 45：`P2-seq107` 采用“复用通用日志弹层”策略：在远程书籍页仅补齐 `menu_log` 入口并复用现有 `showAppLogDialog`，确保与 legado `AppLogDialog` 触发语义同义，同时避免跨序号改动日志存储管线。
- `2026-02-21` 决策 46：`P2-seq108` 采用“展示层 checkable 收敛 + 触发链统一重提交流程”策略：将“精准搜索”改为勾选态表达，并在切换后统一调用 `_search()` 对齐 legado `setQuery(..., true)` 语义，避免空输入分支与非空分支行为漂移。
- `2026-02-21` 决策 47：`P2-seq109` 采用“入口语义保持 + 运行时惰性降级”策略：`menu_source_manage` 继续直接跳转书源管理页，不引入额外确认流程；针对 Linux/测试环境 QuickJS 缺库场景，将 `createJsRuntime()` 收敛为首次 evaluate 时初始化，失败则降级为空运行时以保证入口稳定可用。
- `2026-02-21` 决策 48：`P2-seq110` 采用“去扩展流程、直达 legacy 入口”策略：搜索设置中的该项固定为“多分组/书源”，点击后直接进入范围选择页；移除 quick sheet 二级跳转与“无书源阻断”扩展分支，保持范围变更后自动重搜边界不变。
- `2026-02-21` 决策 49：`P2-seq111` 采用“统一日志入口承载”策略：搜索设置“日志”动作与书架/详情/远程页保持同一 `showAppLogDialog` 弹层链路，不再跳转 `ExceptionLogsView`，以确保 `menu_log` 在各入口层级语义一致并避免扩展文案偏差。
- `2026-02-21` 决策 50：`P2-seq112` 采用“菜单位同义优先”策略：保留现有筛选算法不变，仅收敛筛选入口承载到导航栏 trailing 并维持“分组隐藏/书源显示”的状态机，以最小改动达成 `menu_screen` 交互层级同义。
- `2026-02-21` 决策 51：`P2-seq113` 采用“父级入口单项收敛”策略：仅修正 `action_sort` 父级标题文案并补齐入口触发回归，不提前并入 `menu_sort_desc/menu_sort_manual/...` 子项行为改动，确保严格按 tracker 序号串行推进。
- `2026-02-21` 决策 52：`P2-seq114` 采用“反序子项单项收敛”策略：仅将排序菜单动态切换文案收敛为固定“反序”checkable 语义并补齐勾选态回归，不提前并入 `menu_sort_manual/menu_sort_auto/...` 排序模式改造，确保严格按 tracker 序号串行推进。
- `2026-02-21` 决策 53：`P2-seq115` 采用“证据闭环优先”策略：保持现有 `menu_sort_manual` 业务实现不扩展，仅新增定向回归固化“从其它排序切回手动排序后手动项独占勾选”的 legado 语义，确保序号边界清晰且可复现。
- `2026-02-21` 决策 54：`P2-seq116` 采用“文案同义先收敛 + 行为不扩展”策略：仅将排序子项展示由“权重”改为“智能排序”并补齐勾选态定向回归，排序比较逻辑继续复用既有 `_SourceSortMode.weight`，避免跨入后续 `seq117+` 子项实现。
- `2026-02-21` 决策 55：`P2-seq117` 采用“文案同义先收敛 + 行为不扩展”策略：仅将排序子项展示由“名称”改为“名称排序”并补齐勾选态定向回归，排序比较逻辑继续复用既有 `_SourceSortMode.name` 与 `cnCompare` 等价比较，避免跨入后续 `seq118+` 子项实现。
- `2026-02-21` 决策 56：`P2-seq118` 采用“文案同义先收敛 + 行为不扩展”策略：仅将排序子项展示由“地址”改为“地址排序”并补齐勾选态定向回归，排序比较逻辑继续复用既有 `_SourceSortMode.url`，避免跨入后续 `seq119+` 子项实现。
- `2026-02-21` 决策 57：`P2-seq119` 采用“文案同义先收敛 + 行为不扩展”策略：仅将排序子项展示由“更新时间”改为“更新时间排序”并补齐勾选态与反序联动定向回归，排序比较逻辑继续复用既有 `_SourceSortMode.update` 与 `_sortAscending` 状态机，避免跨入后续 `seq120+` 子项实现。
- `2026-02-21` 决策 58：`P2-seq120` 采用“文案同义先收敛 + 行为不扩展”策略：仅将排序子项展示由“响应时间”改为“响应时间排序”并补齐勾选态定向回归，排序比较逻辑继续复用既有 `_SourceSortMode.respond`，避免跨入后续 `seq121+` 子项实现。
- `2026-02-21` 决策 59：`P2-seq121` 采用“文案同义 + 边界语义修正”策略：将 `menu_sort_enable` 展示文案收敛为“是否启用”，并单独处理 `enabled` 排序反序逻辑（仅反转启用分组，不反转同组名称），以精确复刻 legado `BookSourceSort.Enable` 的升降序语义。
- `2026-02-21` 决策 60：`P2-seq122` 采用“入口语义最小收敛 + 证据闭环”策略：本序号仅收敛 `menu_group` 顶栏入口图标为分组语义并补齐“入口触发 + 动态 `group:` 筛选”回归，不提前并入 `seq123~129` 的分组子菜单文案/行为改造，保持严格串行。
- `2026-02-21` 决策 61：`P2-seq123` 采用“入口语义 + 弹层层级同义优先”策略：本序号聚焦 `menu_group_manage` 的一级触发路径、弹层文案与操作入口层级收敛；分组筛选子项（`seq124~129`）继续按序列单独推进，不跨序号并项。
- `2026-02-21` 决策 62：`P2-seq124` 采用“单项语义收敛 + 旧词兼容”策略：本序号仅收敛 `menu_enabled_group` 的展示文案与查询词为“已启用”，并在过滤逻辑保留“启用”兼容分支，确保 legacy 同义链路生效且不破坏既有用户输入。
- `2026-02-21` 决策 63：`P2-seq125` 延续“单项语义收敛 + 旧词兼容”策略：本序号仅收敛 `menu_disabled_group` 的展示文案与查询词为“已禁用”，并在过滤逻辑保留“禁用”兼容分支，确保 legacy 同义链路生效且不破坏既有用户输入。
- `2026-02-21` 决策 64：`P2-seq126` 延续“单项语义收敛 + 旧词兼容”策略：本序号仅收敛 `menu_group_login` 的展示文案与查询词为“需要登录”，并在过滤逻辑保留“需登录”兼容分支，确保 legacy 同义链路生效且不破坏既有用户输入。
- `2026-02-21` 决策 65：`P2-seq127` 延续“单项语义收敛 + 旧词兼容”策略：本序号仅收敛 `menu_group_null` 的展示文案与查询词为“未分组”，并在过滤逻辑保留“无分组”兼容分支，确保 legacy 同义链路生效且不破坏既有用户输入。
- `2026-02-21` 决策 66：`P2-seq128` 延续“单项语义收敛 + 旧词兼容”策略：本序号仅收敛 `menu_enabled_explore_group` 的展示文案与查询词为“已启用发现”，并在过滤逻辑保留“启用发现”兼容分支，确保 legacy 同义链路生效且不破坏既有用户输入。
- `2026-02-21` 决策 67：`P2-seq129` 延续“单项语义收敛 + 旧词兼容”策略：本序号仅收敛 `menu_disabled_explore_group` 的展示文案与查询词为“已禁用发现”，并在过滤逻辑保留“禁用发现”兼容分支，确保 legacy 同义链路生效且不破坏既有用户输入。
- `2026-02-21` 决策 68：`P2-seq130` 采用“实现保持 + 证据闭环”策略：保持现有“更多 -> 新建书源 -> 书源编辑页”链路不扩展，仅新增定向回归验证入口触发与默认状态（自动保存Cookie 开启），并回填 tracker/计划文档确保单项可追溯完成。
- `2026-02-21` 决策 69：`P2-seq131` 采用“入口文案同义 + 异常提示口径同源”策略：本序号仅收敛 `menu_import_local` 的菜单文案为“本地导入”并同步修正文案相关提示，不提前并入 `menu_import_onLine/menu_import_qr` 的入口与流程改造，保持严格按序推进。
- `2026-02-21` 决策 70：`P2-seq132` 采用“入口文案 + 弹层文案 + 提示口径”同步收敛策略：本序号仅聚焦 `menu_import_onLine` 的用户可见语义统一，不提前并入 `menu_import_qr` 扫码链路和导入算法重构，保持严格按序推进。
- `2026-02-21` 决策 71：`P2-seq133` 采用“入口文案同义 + 触发链路去扩展”策略：将 `menu_import_qr` 文案收敛为“二维码导入”，并统一扫码结果进入 `importFromText` 解析链路，移除扫码 URL 写入网络导入历史的扩展行为，确保与 legado“扫码结果直达导入处理”语义同义。
- `2026-02-21` 决策 72：`P2-seq134` 采用“固定文案 + 勾选态表达状态”策略：将“按域名分组/关闭按域名分组”动态文案收敛为固定“按域名分组显示”，并以勾选态表达开关状态；保留既有按域名排序与分组头展示逻辑，不扩展持久化配置。
- `2026-02-21` 决策 73：`P2-seq136` 采用“文案同义收敛 + 可测触发注入”策略：扫码入口标题固定收敛为“扫描二维码”，并在 `SourceDebugLegacyView` 增加可注入扫码启动器，仅用于稳定验证 `menu_scan` 触发语义，不改动真实扫码与调试解析主链路。
- `2026-02-21` 决策 74：`P2-seq137` 采用“触发路径同义优先”策略：`menu_search_src` 点击后直接进入源码承载页并将标题收敛为 `html`，源码为空时不追加“暂无搜索源码”扩展提示，以对齐 legado `TextDialog("html", searchSrc)` 的状态流转边界。
- `2026-02-21` 决策 75：`P2-seq138` 采用“同链路对称收敛”策略：`menu_book_src` 点击后与 `menu_search_src` 保持一致，直接打开 `html` 标题源码承载页并移除空源码拦截；仅收敛当前子项，不提前并入 `menu_toc_src/menu_content_src`，确保严格按序推进。
- `2026-02-21` 决策 76：`P2-seq139` 采用“同链路对称收敛”策略：`menu_toc_src` 点击后与 `menu_search_src/menu_book_src` 保持一致，直接打开 `html` 标题源码承载页并移除空源码拦截；仅收敛当前子项，不提前并入 `menu_content_src`，确保严格按序推进。
- `2026-02-21` 决策 77：`P2-seq140` 延续“同链路对称收敛”策略：`menu_content_src` 点击后与 `menu_search_src/menu_book_src/menu_toc_src` 保持一致，直接打开 `html` 标题源码承载页并移除空源码拦截；仅收敛当前子项，不提前并入 `menu_refresh_explore`，确保严格按序推进。
- `2026-02-21` 决策 78：`P2-seq141` 采用“行为不变 + 可测注入最小化”策略：保留 `menu_refresh_explore` 现有用户链路，只新增 `exploreKindsLoader/clearExploreKindsCache` 可选注入回调用于测试；默认仍走 `SourceExploreKindsService`，避免把测试设施扩散到运行时语义。
- `2026-02-21` 决策 79：`P2-seq142` 采用“同源文档优先 + 统一帮助承载”策略：移除调试页内置 `SourceHelpTexts.debug` 提示弹窗，改为读取 `assets/web/help/md/debugHelp.md` 并复用 `showAppHelpDialog` 展示，失败分支保留“帮助文档加载失败”可观测提示，确保与 legado `showHelp("debugHelp")` 语义同义。
- `2026-02-22` 决策 80：`P2-seq143` 采用“行为不变 + 触发证据可注入”策略：运行时继续使用 `_moveSourcesToTopBottom` 的既有写库链路，仅新增可选 `moveSourcesHandler` 注入点用于稳定验证 `menu_top` 触发来源与 `toTop` 分流语义；同时将条目更多按钮补充稳定 key 以消除测试中导航栏同图标歧义，不改变用户可见交互。
- `2026-02-22` 决策 81：`P2-seq144` 采用“实现保持 + 证据闭环”策略：不改动 `_toBottom` 与 `_moveSourcesToTopBottom` 运行时写库实现，仅补齐 `menu_bottom` 的升序/反序分流回归（`toTop=false/true`）与台账证据，确保严格按序号完成 legado 同义验证。
- `2026-02-22` 决策 82：`P2-seq145` 采用“入口语义 + URL 回查边界”策略：菜单项继续按 `loginUrl` 非空控制可见性；点击“登录”时按 `bookSourceUrl` 回查最新书源后再触发登录链路，缺失时统一提示“未找到书源”；回归仅保留稳定的“入口显隐 + 登录跳转”断言，避免引入不稳定时序用例。
- `2026-02-22` 决策 83：`P2-seq146` 采用“快照 scope 先写入 + 页面无阻塞跳转”策略：菜单点击“搜索”后先按当前条目构造并写入 `SearchScope.fromSource(source)`（异步落盘不阻塞导航），再打开搜索页；避免继续依赖 `SearchView.scoped` 的二次查库生成 scope，确保与 legado `SearchScope(bookSource)` 快照语义同义。
- `2026-02-22` 决策 84：`P2-seq147` 采用“快照直达调试页”策略：`menu_debug_source` 点击后直接按当前条目快照打开 `SourceDebugLegacyView`，不再复用 `_openEditor(initialTab:3)` 的入口前二次查库拦截；仅收敛当前子项触发语义，不提前并入 `menu_del/menu_enable_explore` 后续序号。
- `2026-02-22` 决策 85：`P2-seq148` 采用“确认文案收敛 + 删除触发内聚”策略：将删除确认标题收敛为 legado `draw` 同义“提醒”，并将删除执行绑定到确认按钮回调（确认即删、取消不删）；测试侧保留“取消路径 + 确认删除”两条页面级证据，并用 Drift 直查落库结果规避仓库静态缓存时序抖动。
- `2026-02-22` 决策 86：`P2-seq163` 采用“入口同义 + 规则透传最小闭环”策略：目录页仅在本地 TXT 展示 `menu_toc_regex`，规则选择结果落到书籍级 `SettingsService` 映射并透传至 `TxtParser/SearchBookInfoRefreshHelper/阅读器重解析`；自动化证据优先使用 parser/refresh/settings 定向测试，页面级触发通过手工路径补齐，避免引入 Drift 阻塞型假阴性。
- `2026-02-22` 决策 87：`P2-seq165` 采用“菜单层级同义优先”策略：保留既有 `_reversed` 的“过滤后倒序”实现与数据结构不变，仅将入口从页面内按钮迁移到目录“更多”菜单并固定文案“反转目录”；非本地 TXT 场景同样保留该入口，本地 TXT 场景与 `menu_toc_regex` 并列展示。
- `2026-02-22` 决策 88：`P2-seq168` 采用“菜单单项收敛 + 可观测导出链路”策略：目录页“更多”菜单仅补齐 `menu_export_bookmark` 的固定文案“导出”与 JSON 导出触发，不提前并入 `menu_export_md`；导出成功统一提示“导出成功”，取消不提示，失败记录 `ExceptionLogService` 并给出可观测反馈。为稳定回归证据，新增可选 `bookmarkExportService` 注入点，仅用于测试替换导出服务，默认运行时行为保持不变。
- `2026-02-22` 决策 89：`P2-seq169` 采用“同组菜单并列收敛”策略：在保持 `menu_export_bookmark` 已收敛行为不变的前提下，单独补齐 `menu_export_md` 的固定文案“导出(MD)”与 Markdown 导出触发链路，不复用 JSON 参数；导出成功统一提示“导出成功”，取消不提示，失败继续记录 `ExceptionLogService`，并新增定向回归验证 `.md` 扩展名与动作入口。
- `2026-02-22` 决策 90：`P2-seq64` 采用“入口层级同义优先 + 默认触发对齐”策略：将阅读页换源从“更多菜单二级入口”收敛为顶栏一级动作，并将点击默认行为改为整书换源；章节/整书分支菜单保留在换源按钮长按手势，避免新增扩展入口导致与 legado 触发语义漂移。
- `2026-02-22` 决策 91：`P2-seq65` 采用“顶栏一级入口 + 点击默认当前章节刷新”策略：将刷新动作从“阅读操作”二级菜单收敛为顶栏一级按钮，默认点击执行当前章节刷新，并将长按分支对齐 legado `book_read_refresh` 三分支菜单；同时从更多菜单移除刷新项，避免同一动作双入口导致层级偏差。
- `2026-02-22` 决策 92：`P2-seq66` 采用“顶栏一级入口 + 范围缓存主链路”策略：将离线缓存动作从“阅读操作”二级菜单收敛为顶栏一级按钮，点击后弹出章节范围输入并按范围执行正文缓存；保留在线/本地显隐边界并将章节抓取失败写入异常日志，确保 `menu_download` 触发链路、状态流转与可观测语义对齐 legado。
- `2026-02-22` 决策 93：`P2-seq67` 采用“确认式提交优先”策略：阅读页 `menu_toc_regex` 保持顶栏一级入口不变，将规则选择从“点选即提交”收敛为“取消不生效、确定统一提交”，并移除扩展成功提示；确定后继续沿用既有 TXT 重解析链路，确保 `menu_toc_regex -> onTocRegexDialogResult -> loadChapterList` 状态流转同义。
- `2026-02-22` 决策 94：`P2-seq68` 采用“顶栏一级入口 + 输入式提交 + 本地统一重载”策略：`menu_set_charset` 从“阅读操作”菜单移至本地书籍顶栏一级动作，交互由固定枚举改为自由输入 `charset` 对话框；确认后先持久化编码再统一触发本地目录重载（TXT/非 TXT），取消不生效且不追加扩展成功提示。
- `2026-02-22` 决策 95：`P2-seq83` 采用“本地/在线同义刷新 + 失败口径收敛”策略：阅读页 `menu_update_toc` 不再拦截本地书籍，统一进入目录重载链路；本地失败收敛为 `LoadTocError:*`、在线失败收敛为“加载目录失败”，并移除成功扩展提示，仅保留加载态与日志可观测输出。对 EPUB 场景在刷新前清理章节缓存，等价 legado 的“先清缓存再更新目录”语义。
- `2026-02-22` 决策 96：`P3-seq94` 采用“默认动作单点收敛”策略：通过 `ReaderLegacyMenuHelper.defaultRefreshAction()` 固化 `menu_refresh=menu_refresh_dur(current)` 语义，并让顶栏刷新点击与阅读菜单刷新共用同一默认执行链路；长按分支菜单保持仅承担“选择当前/之后/全部刷新”入口职责，不再承载默认动作判定。
- `2026-02-22` 决策 97：`P3-seq95` 采用“范围计算抽离 + 行为保持”策略：将“刷新之后章节”的范围计算与缓存清理提炼为 `ReaderRefreshScopeHelper`，由 `selectionFromLegacyAction(after)` 固化 `startIndex=current, clearFollowing=true`，并新增独立单测覆盖“前序章节不清理”边界；页面触发链路保持不变，避免跨序号改动 `menu_refresh_all` 分支。
- `2026-02-22` 决策 98：`P3-seq96` 采用“行为保持 + 证据独立闭环”策略：运行时继续复用既有 `selectionFromLegacyAction(all) -> clearCachedRange(start=0, clearFollowing=true)` 链路，不新增分支实现；仅补齐 `menu_refresh_all` 的动作映射与全量清缓存单测，并回填台账证据，确保后续序号改动不破坏全量刷新边界。
- `2026-02-22` 决策 99：`P3-seq97` 采用“URL 回查优先”策略：阅读页 `menu_login` 点击后不再直接使用 action sheet 打开时的书源快照，而是按 `bookSourceUrl` 回查当前书源后再触发登录；缺失时提示“未找到书源”，以对齐 legado `SourceLoginActivity(key=bookSourceUrl)` 的实时状态边界并避免过期快照误触发。
- `2026-02-22` 决策 100：`P3-seq98` 采用“显隐边界收敛 + 日志优先可观测”策略：`menu_chapter_pay` 显隐严格收敛为 `loginUrl && isVip && !isPay`，确认后按 `bookSourceUrl` 回查当前书源执行 `payAction`；结果分流对齐 legado `isAbsUrl / isTrue` 语义，异常统一写日志 `执行购买操作出错`，不追加扩展 toast。
- `2026-02-22` 决策 101：`P3-seq99` 采用“实时回查 + 保存后刷新”策略：`menu_edit_source` 点击后不再使用弹层快照直接打开编辑页，而是按 `bookSourceUrl` 回查当前书源后再触发；仅在编辑页保存返回时刷新阅读页书源显示，取消返回不刷新，以对齐 legado `RESULT_OK -> upBookSource/upMenuView` 回调边界。
- `2026-02-22` 决策 102：`P3-seq100` 采用“直接执行同义化 + 回查防重建”策略：移除禁用确认弹窗与成功 toast，动作收敛为点击即按 `bookSourceUrl` 回查当前书源并写库 `enabled=false`；回查缺失时仅提示“未找到书源”，避免使用弹层快照触发 upsert 重建已删除书源。
- `2026-02-22` 决策 103：`P2-seq164` 采用“目录页 checkable 入口补齐 + 即时重建复用”策略：在目录页“更多”菜单补齐 `menu_split_long_chapter`，标题固定“拆分超长章节”并以勾选态表达状态；点击后复用本地 TXT 重建目录链路，保持“切换即生效”而不新增并行刷新实现。
- `2026-02-22` 决策 104：`P2-seq166` 采用“全局目录开关持久化 + 展示层即时重算”策略：目录页“更多”菜单补齐 `menu_use_replace` 固定文案与勾选态，点击后仅切换全局 `tocUiUseReplace` 并立即重算目录展示标题，不追加成功提示；标题处理链路收敛为 `tocUiUseReplace && 书籍启用替换规则`，以对齐 legado 的目录展示边界。
- `2026-02-22` 决策 105：`P2-seq167` 采用“开关语义优先 + 现有数据渐进承载”策略：先补齐 `menu_load_word_count` 的 checkable 入口、全局持久化默认值（`true`）与目录即时刷新，再基于现有章节缓存内容补齐字数展示（`xx字/xx万字`）；不引入章节表结构变更，避免在当前序号扩大到跨层数据迁移。
- `2026-02-22` 决策 106：`P3-seq70` 采用“异常兜底优先 + 加载态交互锁定”策略：保持 `menu_edit_content` 入口与保存链路不变，仅将正文抓取异常收敛为“记录日志并回退当前显示内容”以避免中断菜单流程；同时在编辑页 `reset` 期间增加全屏遮罩与整页禁用，贴齐 legado `loadState` 的不可交互语义。
- `2026-02-22` 决策 107：`P3-seq71` 采用“双层状态拆分”策略：`menu_page_anim` 收敛为书籍级单选覆盖（默认/覆盖/滑动/仿真/滚动/无）且不写全局；样式面板改翻页动画继续走全局设置并同步清理书籍覆盖，以对齐 legado `book.pageAnim` 与 `ReadBookConfig.pageAnim` 的职责边界。
- `2026-02-22` 决策 108：`P3-seq72` 采用“静默同步优先 + 越界保护”策略：`menu_get_progress` 在无配置/空目录/云端无数据时保持静默返回，不追加扩展 toast；仅在云端章节索引合法时应用同步，云端进度落后本地时保留 legado 同义确认框，拉取失败统一写 `reader.menu.get_progress.failed` 日志。
- `2026-02-22` 决策 109：`P3-seq73` 采用“静默守卫 + 文案收敛 + 失败可观测”策略：`menu_cover_progress` 在开关关闭/无配置/空目录时静默返回；成功提示收敛为 legado 同义“上传成功”；失败链路统一记录 `reader.menu.cover_progress.failed` 日志并保留失败提示，避免只提示不落日志的可观测缺口。
- `2026-02-22` 决策 110：`P3-seq74` 采用“算法同义优先 + 扩展行为回收”策略：`menu_reverse_content` 从“按行倒序 + 正文兜底拉取 + 缺失提示”收敛为 legado `reverseContent` 同义“按字符倒序 + 仅处理当前缓存正文 + 缺失静默返回”；同时将菜单文案统一为“反转内容”。
- `2026-02-22` 决策 111：`P3-seq75` 采用“边界先行收敛”策略：先对齐 legado `simulatedTotalChapterNum` 计算口径（含 `Period.days + 1` 语义），再把可读章节上限贯穿到目录、底部章节导航、自动翻页、朗读切章、进度分母与越界保护，避免仅修菜单入口导致会话边界漂移。
- `2026-02-22` 决策 112：`P3-seq76` 采用“文案与反馈同义化”策略：`menu_enable_replace` 菜单文案收敛为“替换净化”，并移除切换后的扩展 toast；保留“点击即切换书籍级开关并刷新正文”的主链路，不扩大到替换规则引擎实现层改动。
- `2026-02-22` 决策 113：`P3-seq77` 采用“实际结果驱动状态 + Legacy 翻转语义”策略：`menu_same_title_removed` 勾选态按当前章节实际移除结果表达，不再直接映射章节配置；点击动作按 `!sameTitleRemoved` 写回章节级开关并重载当前章节，且仅在“未移除且已启用”时提示“未找到可移除的重复标题”，其余边界保持静默。
- `2026-02-22` 决策 114：`P3-seq78` 采用“开关持久化后同章重载 + 位点先保存”策略：`menu_re_segment` 点击后仅切换书籍级 `reSegment` 并重载当前章节，不新增扩展提示；为对齐 legado `loadContent(false)` 的位置保持语义，重载前先执行进度保存，再以 `restoreOffset` 恢复当前阅读位点。
- `2026-02-22` 决策 115：`P3-seq79` 采用“隐藏入口结构化保留”策略：菜单模型补齐 `menu_enable_review` 占位与 legacy 文案，但默认 `showReviewAction=false` 且事件分发 no-op，严格对齐 legado 当前“默认隐藏且不可触发”的运行时语义，不提前扩展段评主流程。
- `2026-02-22` 决策 116：`P3-seq80` 采用“清理边界同义 + 全量刷新回归”策略：菜单文案固定收敛为“删除ruby标签”；正文清理规则收敛为仅删除 `rt/rp`，不移除 `ruby` 包裹标签；切换后刷新链路改为全量清缓存并重载当前章节，贴齐 legado `refreshContentAll` 语义。
- `2026-02-22` 决策 117：`P3-seq81` 采用“节点级清理同义 + 文案收敛”策略：`menu_del_h_tag` 菜单文案固定收敛为“删除h标签”；正文清理规则由“仅移除 `h1~h6` 标签”收敛为“移除 `h1~h6` 整段节点内容（含标题文本）”，并继续复用全量清缓存重载链路，贴齐 legado `select("h1, h2, h3, h4, h5, h6").remove()` 语义。
- `2026-02-22` 决策 118：`P3-seq82` 采用“书籍级联动优先”策略：`menu_image_style` 选择 `SINGLE` 时不再改全局 `ReadingSettings.pageTurnMode`，统一复用本书翻页动画覆盖链路写入 `book_page_anim_map(0=覆盖)`；保持“样式切换后立即重载当前章节”语义不变，确保与 legado `book.setPageAnim(0) + ReadBook.loadContent(false)` 同义。
- `2026-02-22` 决策 119：`P3-seq84` 采用“命中规则可见性优先 + 编辑后统一重载”策略：`menu_effective_replaces` 从规则总列表跳转收敛为“当前章节起效规则弹层”；规则项来源改为正文实际命中列表，并在简繁转换开启时追加“繁简转换”项；发生规则编辑或简繁切换后统一清理替换阶段缓存并重载当前章节，以对齐 legado `onDismiss -> replaceRuleChanged` 闭环。
- `2026-02-22` 决策 120：`P2-seq348` 采用“单控件提交优先”策略：搜索入口收敛为单一输入控件内提交（控件内搜索图标 + 键盘 `search`），移除外置独立搜索按钮；同时占位文案收敛为 legado `search_book_key` 同义“搜索书名、作者”，不改动搜索算法、缓存键与范围状态机。
- `2026-02-22` 决策 121：`P3-seq5` 采用“先补入口语义、复用既有换源主链路”策略：将“朗读长按”占位提示收敛为 `audio_play` 播放菜单并补齐“换源”动作；点击后直接复用现有整书换源候选流程，不提前并入 `menu_login/menu_edit_source/menu_wake_lock/menu_log` 后续序号逻辑，确保严格按序推进。
- `2026-02-22` 决策 122：`P3-seq6` 采用“显隐边界先行 + 触发链路复用”策略：在播放菜单仅新增 `menu_login` 单项，显隐严格收敛到 `loginUrl` 非空；点击后复用现有 `_openSourceLoginFromReader(bookSourceUrl)` 登录链路，不提前并入 `menu_copy_audio_url/menu_edit_source/menu_wake_lock/menu_log` 后续序号逻辑，确保按队列串行推进。
- `2026-02-22` 决策 123：`P3-seq239` 采用“目录重选动作优先”策略：先补齐 `menu_other` 的“重选字体目录 -> 刷新候选列表”主语义与路径持久化，再在现有字体弹层中承载目录字体选择；不提前并入 `menu_default`（`seq238`）的系统字体菜单改造，避免跨序号并项。
- `2026-02-22` 决策 128：`P3-seq374` 采用“候选预览优先 + 默认选择新增/更新”策略：`menu_import_local` 点击后先执行 `txt/json` 本地选档，再进入“导入朗读引擎”候选弹层；候选状态按 `id + lastUpdateTime` 收敛为“新增/更新/已有”，默认仅勾选新增/更新并支持全选切换；确认后仅提交勾选项并即时刷新列表，不提前并入 `menu_import_onLine/menu_export` 后续序号能力。
- `2026-02-22` 决策 129：`P3-seq375` 采用“URL 输入与历史同义优先 + 候选导入复用”策略：`menu_import_onLine` 点击后先弹“网络导入”输入层并持久化 `ttsUrlKey` 历史（支持点选回填与删除），确认后复用既有“导入朗读引擎”候选弹层完成勾选导入；不提前并入 `menu_export`（`seq376`）后续序号能力，保持按序推进。
- `2026-02-22` 决策 130：`P3-seq376` 采用“导出器同义优先 + 路径可观测闭环”策略：在“朗读引擎”更多菜单补齐 `menu_export` 并固定导出文件名 `httpTts.json`、内容为当前 HTTP 朗读引擎 JSON 数组；导出成功后提供路径展示与复制路径动作，不提前并入 `speak_engine_edit.xml`（`seq377+`）后续序号能力，保持按序推进。
- `2026-02-22` 决策 131：`P3-seq378` 采用“编辑态保存优先 + 登录分流复用”策略：先补齐 `speak_engine_edit` 承载页，再在“更多”菜单新增 `menu_login`；点击后先按当前编辑表单回写 HTTP 朗读规则，再按 `loginUi` 分流到表单登录或网页登录，并保留 legado 同义空值拦截“登录url不能为空”；不提前并入 `menu_save/menu_show_login_header/menu_del_login_header` 后续序号能力，保持按序推进。
- `2026-02-22` 决策 132：`P3-seq379` 采用“只读展示优先”策略：在 `speak_engine_edit` 仅新增 `menu_show_login_header` 单项并复用登录态缓存键 `httpTts:<id>` 读取当前规则登录头；展示层严格收敛为“标题为登录头的只读弹窗”，无缓存时不追加占位文案，不提前并入 `menu_del_login_header`（`seq380`）删除链路，保持按序推进。
- `2026-02-22` 决策 133：`P3-seq380` 采用“缓存键直删优先”策略：在 `speak_engine_edit` 仅新增 `menu_del_login_header` 单项并按 `httpTts:<id>` 删除登录头缓存；删除动作保持 legado 同义静默语义（无保存、无成功提示），不提前并入 `menu_save/menu_paste_source`（`seq377/382`）后续序号能力，保持按序推进。
- `2026-02-22` 决策 134：`P3-seq9` 采用“checkable 入口先收敛 + 全局键同名持久化”策略：在播放菜单仅新增 `menu_wake_lock` 单项并用勾选态表达开关状态；点击后仅翻转并落盘 legado 同名键 `audioPlayWakeLock`，不提前并入 `menu_copy_audio_url/menu_log` 后续序号能力，确保按优先级队列串行推进。
- `2026-02-22` 决策 135：`P3-seq93` 采用“入口同义优先 + 进度链路不破坏”策略：先补齐“阅读记录页更多菜单 -> 开启记录”checkable 入口与 `enableReadRecord` 同名持久化；为避免破坏主阅读链路，阅读进度仍按原路径保存，仅在开关关闭时停止刷新 `lastReadTime`，用现有数据结构承接 legado 阅读记录开关语义。
- `2026-02-22` 决策 136：`P3-seq201` 采用“空正文边界优先”策略：编辑正文保存链路对齐 legado `BookHelp.saveText(content.isEmpty -> return)`，仅在正文非空时覆盖章节缓存并标记已下载；空正文场景保持静默且不改写现有正文，避免把缓存正文污染为空串。
- `2026-02-22` 决策 137：`P3-seq202` 采用“重置来源同义 + 失败静默回收”策略：重置链路统一收敛为“清缓存 -> 回源读取 -> 回填编辑框 -> 刷新当前章节”；网络书禁用 `_currentContent` 回退并改为失败抛错记录日志，本地书改为按本地文件回读章节正文；编辑页失败分支移除“重置失败”弹窗，保持 legado 同义静默边界。
- `2026-02-22` 决策 138：`P3-seq204` 采用“搜索态开关独立优先”策略：在全文搜索面板仅新增 `content_search/menu_enable_replace` 单项并以勾选态表达状态；点击动作仅翻转搜索态开关，不自动重跑搜索；执行搜索时按“搜索替换开关 && 书籍替换净化开关”共同决定是否应用替换规则，以对齐 legado `replaceEnabled` 与 `book.getUseReplaceRule()` 组合边界。
- `2026-02-22` 决策 142：`P3-seq208` 采用“双模式分流优先 + 同名键持久化”策略：文本操作菜单补齐 `menu_aloud` 后，点击动作按 `contentSelectSpeakMod` 分流为“朗读选中文本（mode=0）/从选择处开始持续朗读（mode=1）”；长按文本操作菜单项统一切换模式并持久化到同名键，不提前并入 `menu_dict/menu_browser/menu_share_str` 后续序号能力，保持按序推进。
- `2026-02-22` 决策 143：`P3-seq209` 采用“词典弹层闭环优先 + 默认规则同源”策略：文本操作菜单补齐 `menu_dict` 后，点击动作统一进入词典弹层，按 `enabled + sortNumber` 加载并排序规则，默认首项自动查询；规则默认资产对齐 legado `defaultData/dictRules.json`，并在弹层内支持规则切换重查，不提前并入 `menu_browser/menu_share_str` 后续序号能力，保持按序推进。
- `2026-02-22` 决策 144：`P3-seq211` 采用“绝对网址直开优先 + 非网址搜索回退”策略：文本操作菜单补齐 `menu_browser` 后，点击动作按 `isAbsUrl` 语义分流为“外部浏览器打开 / 网页搜索关键词”；失败口径收敛为“异常优先显示错误消息，空消息回退 `ERROR`”，不提前并入 `menu_share_str`（`seq212`）后续序号能力，保持按序推进。
- `2026-02-22` 决策 145：`P3-seq212` 采用“系统分享直连 + 异常静默吞错”策略：文本操作菜单补齐 `menu_share_str` 后，点击动作直接调用系统文本分享并透传 `selectedText`；失败边界按 legado `Context.share` 保持静默，不追加成功或失败提示；不提前并入 `menu_default`（`seq238`）后续序号能力，保持按序推进。
- `2026-02-22` 决策 147：`P3-seq256` 采用“编辑工具承载优先 + serialNo 同义持久化”策略：在 Flutter 端先将“辅助按键配置”挂到 `SourceEditLegacyView` 的“编辑工具”动作面板，进入配置弹层后补齐顶部“添加”入口；新增动作严格按 legado `editKey(null)` 语义使用 `key/value` 双输入框，并以 `serialNo=max+1` 追加持久化，保证新增项可立即回流到编辑工具用于插入 `value`。
- `2026-02-22` 决策 150：`P3-seq382` 采用“剪贴板解析优先 + 仅回填不落库”策略：编辑页“更多”菜单仅新增 `menu_paste_source` 单项，点击后按 legado 同义规则读取剪贴板文本并只接受 JSON 对象/数组（数组取首项）回填表单；成功后不自动保存、不跳转、不追加成功提示，不提前并入 `menu_copy_source/menu_log/menu_help` 后续序号能力，保持按序推进。
- `2026-02-22` 决策 151：`P4-seq158` 采用“仅收敛导出文件名与取消边界”策略：保持现有“导出所选”入口层级与导出集合计算规则不变，仅将文件导出默认名调整为 legado 同义 `bookSource.json`，并将取消分支改为静默返回；不提前并入 `menu_enable_selection/menu_disable_selection/menu_share_source/menu_check_source`（`seq150~151/159~160`）后续序号能力，确保一项一处理。

## Outcomes & Retrospective

- `2026-02-22`：完成 `P4-seq366`（`menu_del_login_header`）迁移闭环，已补齐“登录表单页更多菜单删除登录头入口 + 删除 `loginHeader_<sourceKey>` + 清理书源 URL 作用域 Cookie + 全流程静默无提示”的同义证据；队列推进到下一项 `seq368(source_picker/menu_change_source_delay)`（`seq367` 后置）。
- `2026-02-22`：完成 `P4-seq365`（`menu_show_login_header`）迁移闭环，已补齐“登录表单页更多菜单查看登录头入口 + 读取 `loginHeader_<sourceKey>` 缓存 + 弹窗标题‘登录头’ + 有缓存时可复制文本”的同义证据；队列推进到下一项 `seq366(source_login/menu_del_login_header)`。
- `2026-02-22`：完成 `P4-seq360`（`menu_qr_code_camera`）迁移闭环，已补齐“书源编辑页更多菜单‘二维码导入’文案 + 扫码页标题‘扫描二维码’ + 扫码成功仅回填表单且不重置已保存快照 + 无扩展成功提示”的同义证据；队列推进到下一项 `seq365(source_login/menu_show_login_header)`。
- `2026-02-22`：完成 `P4-seq354`（`menu_search`）迁移闭环，已补齐“书源编辑页更多菜单搜索入口 + 点击先保存 + 入口侧显式写入 `searchScope=SearchScope.fromSource(saved)` + 进入搜索页范围锁定当前书源”的同义证据；队列推进到下一项 `seq360(source_edit/menu_qr_code_camera)`。
- `2026-02-22`：完成 `P4-seq192`（`menu_load_toc`）迁移闭环，已补齐“换源候选弹层 checkable 加载目录入口 + 全局键 `changeSourceLoadToc` 持久化 + 点击仅切换不刷新 + 刷新候选按开关决定是否预加载目录”同义证据；队列推进到下一项 `seq353(source_edit/menu_login)`。
- `2026-02-22`：完成 `P4-seq188`（`menu_refresh_list`）迁移闭环，已补齐“整书换源候选弹层刷新列表入口 + 基于当前候选来源集合重拉结果 + 刷新中动作防并发 + 失败静默保留列表”同义证据；队列推进到下一项 `seq192(menu_load_toc)`。
- `2026-02-22`：完成 `P4-seq187`（`menu_source_manage`）迁移闭环，已补齐“换源候选弹层书源管理入口 + 点击后打开书源管理页 + 返回后候选弹层继续保留”的同义证据；队列推进到下一项 `seq188(menu_refresh_list)`。
- `2026-02-22`：完成 `P4-seq158`（`menu_export_selection`）迁移闭环，已补齐“导出所选默认文件名 `bookSource.json` + 取消导出静默返回 + 成功路径可复制”的同义证据；队列推进到下一项 `seq150(menu_enable_selection)`。
- `2026-02-22`：完成 `P3-seq382`（`menu_paste_source`）迁移闭环，已补齐“编辑页更多菜单粘贴源入口 + 剪贴板 JSON 对象/数组解析 + 数组取首项回填 + 成功不自动保存”的同义证据；队列推进到下一项 `seq158(menu_export_selection)`。
- `2026-02-22`：完成 `P3-seq377`（`menu_save`）迁移闭环，已补齐“朗读引擎编辑页顶栏一级保存入口 + 点击后按当前表单落库 + 成功提示‘保存成功’ + 保存后停留编辑页”同义证据；队列推进到下一项 `seq382(menu_paste_source)`。
- `2026-02-22`：完成 `P3-seq372`（`menu_add`）迁移闭环，已补齐“语音管理页顶栏一级添加入口 + 空白草稿编辑页跳转 + 未保存不落库”同义证据；队列推进到下一项 `seq377(menu_save)`。
- `2026-02-22`：完成 `P3-seq256`（`menu_add`）迁移闭环，已补齐“编辑工具 -> 辅助按键配置”入口、配置弹层顶部添加动作、`key/value` 双输入框与 `serialNo=max+1` 持久化链路，并回流到编辑工具支持直接插入新增项 `value`；队列推进到下一项 `seq372(menu_add)`。
- `2026-02-22`：完成 `P3-seq238`（`menu_default`）迁移闭环，已补齐“字体弹层默认字体入口 + 系统内置字体样式三选项 + 选择后清空自定义字体并即时生效 + 关闭弹层”同义证据；队列推进到下一项 `seq256(menu_add)`。
- `2026-02-22`：完成 `P3-seq212`（`menu_share_str`）迁移闭环，已补齐“翻页阅读长按文本操作菜单分享入口 + 选中文本系统分享 + 异常静默吞错”同义证据；队列推进到下一项 `seq238(menu_default)`。
- `2026-02-22`：完成 `P3-seq211`（`menu_browser`）迁移闭环，已补齐“翻页阅读长按文本操作菜单浏览器入口 + URL 文本外部浏览器直开 + 非 URL 文本网页搜索 + 失败提示口径”同义证据；队列推进到下一项 `seq212(menu_share_str)`。
- `2026-02-22`：完成 `P3-seq209`（`menu_dict`）迁移闭环，已补齐“翻页阅读长按文本操作菜单字典入口 + 点击后弹出词典面板 + 默认规则自动查询 + 规则切换重查”同义证据；队列推进到下一项 `seq211(menu_browser)`。
- `2026-02-22`：完成 `P3-seq208`（`menu_aloud`）迁移闭环，已补齐“翻页阅读长按文本操作菜单朗读入口 + 点击按 `contentSelectSpeakMod` 执行双模式分流 + 长按菜单项切换模式并持久化”的同义证据；队列推进到下一项 `seq209(menu_dict)`。
- `2026-02-22`：完成 `P3-seq207`（`menu_bookmark`）迁移闭环，已补齐“翻页阅读长按文本操作菜单书签入口 + 选中文本预填书签编辑弹窗 + 取消不落库 + 确定后新增书签并刷新状态”的同义证据；队列推进到下一项 `seq208(menu_aloud)`。
- `2026-02-22`：完成 `P3-seq205`（`menu_replace`）迁移闭环，已补齐“翻页阅读长按文本动作入口 + selectedText 逐行 trim 预填 pattern + scope 预填 bookName;bookSourceUrl + 保存后刷新当前章节”的同义证据；ExecPlan 从 `blocked` 恢复为 `active`，队列推进到下一项 `seq207(menu_bookmark)`。
- `2026-02-22`：推进 `P3-seq205`（`menu_replace`）时发现阅读页缺少选中文本基础设施，无法等价复刻 legado `selectedText` 触发链路；已按迁移例外流程将 ExecPlan 标记为 `blocked`，并回填“原因/影响范围/替代方案/回补计划”，等待需求方确认解除阻塞。
- `2026-02-22`：完成 `P3-seq204`（`menu_enable_replace`）迁移闭环，已补齐“全文搜索菜单 checkable 替换入口 + 开关仅影响搜索链路且不自动重跑 + 搜索替换开关与书籍替换净化总开关组合生效”的同义证据；队列推进到下一项 `seq205(menu_replace)`。
- `2026-02-22`：完成 `P3-seq202`（`menu_reset`）迁移闭环，已补齐“重置先清缓存、网络书按书源重拉、本地书按本地文件回读、失败静默保留编辑内容并记录日志”的同义证据；队列推进到下一项 `seq204(menu_enable_replace)`。
- `2026-02-22`：完成 `P3-seq201`（`menu_save`）迁移闭环，已补齐“编辑正文保存仅在正文非空时覆盖章节缓存、空正文不落库且不污染现有正文”同义证据；队列推进到下一项 `seq202(menu_reset)`。
- `2026-02-22`：完成 `P3-seq93`（`menu_enable_record`）迁移闭环，已补齐“阅读记录页更多菜单 checkable 入口 + `enableReadRecord` 同名键持久化 + 关闭开关后不刷新 `lastReadTime`”同义证据；队列推进到下一项 `seq201(menu_save)`。
- `2026-02-22`：完成 `P3-seq9`（`menu_wake_lock`）迁移闭环，已补齐“播放菜单 checkable 入口 + `audioPlayWakeLock` 同名键持久化 + 重进菜单勾选态保持”同义证据；队列推进到下一项 `seq93(menu_enable_record)`。
- `2026-02-22`：完成 `P3-seq380`（`menu_del_login_header`）迁移闭环，已补齐“编辑页更多菜单删除登录头入口 + 按 `httpTts:<id>` 删除登录头缓存 + 删除动作静默无提示”同义证据；队列推进到下一项 `seq9(menu_wake_lock)`。
- `2026-02-22`：完成 `P3-seq379`（`menu_show_login_header`）迁移闭环，已补齐“编辑页更多菜单查看登录头入口 + 按 `httpTts:<id>` 读取缓存 + 标题为登录头的只读弹窗（无缓存仅标题）”同义证据；队列推进到下一项 `seq380(menu_del_login_header)`。
- `2026-02-22`：完成 `P3-seq378`（`menu_login`）迁移闭环，已补齐“HTTP 朗读引擎编辑承载页 + 更多菜单登录入口 + 登录前保存编辑输入 + 空 `loginUrl` 提示”同义证据；队列推进到下一项 `seq379(menu_show_login_header)`。
- `2026-02-22`：完成 `P3-seq376`（`menu_export`）迁移闭环，已补齐“导出入口 + 默认文件名 `httpTts.json` + JSON 数组落盘 + 成功路径展示与复制路径”同义证据；队列推进到下一项 `seq378(menu_login)`。
- `2026-02-22`：完成 `P3-seq375`（`menu_import_onLine`）迁移闭环，已补齐“网络导入入口 + URL 输入与历史管理 + 候选状态对比（新增/更新/已有）+ 默认勾选新增/更新 + 仅提交勾选项”同义证据；队列推进到下一项 `seq376(menu_export)`。
- `2026-02-22`：完成 `P3-seq374`（`menu_import_local`）迁移闭环，已补齐“本地导入入口 + txt/json 选档 + 候选状态对比（新增/更新/已有）+ 默认勾选新增/更新 + 仅提交勾选项”同义证据；队列推进到下一项 `seq375(menu_import_onLine)`。
- `2026-02-22`：完成 `P3-seq373`（`menu_default`）迁移闭环，已补齐“语音管理入口承载 + 导入默认规则菜单动作 + 默认规则资产同源 + `id<0` 默认规则重置边界”同义证据；队列推进到下一项 `seq374(menu_import_local)`。
- `2026-02-22`：完成 `P3-seq239`（`menu_other`）迁移闭环，已补齐“字体弹层其它目录入口 + 目录路径持久化 + `ttf/otf` 候选刷新 + 目录字体即时应用”的同义证据；队列推进到下一项 `seq373(menu_default)`。
- `2026-02-22`：完成 `P3-seq210`（`menu_search_content`）迁移闭环，已补齐“跨章节全文命中列表 + 在线缓存边界 + 跨章节跳转定位 + 搜索任务并发收敛”同义证据；队列推进到下一项 `seq239(menu_other)`。
- `2026-02-22`：完成 `P3-seq88`（`menu_book_change_source`）迁移闭环，已补齐“分支菜单文案收敛为整书换源 + 成功静默无 toast + 与顶栏点击换源同链路触发”的同义证据；队列推进到下一项 `seq210(menu_search_content)`。
- `2026-02-22`：完成 `P3-seq87`（`menu_chapter_change_source`）迁移闭环，已补齐“候选书源选择后手动选章、仅替换当前章节正文、成功静默无 toast”的同义证据；队列推进到下一项 `seq88(menu_book_change_source)`。
- `2026-02-22`：完成 `P3-seq8`（`audio_play/menu_edit_source`）迁移闭环，已补齐“播放菜单编辑书源入口 + 打开编辑页 + 仅保存返回刷新”的同义证据；队列推进到下一项 `seq87(menu_chapter_change_source)`。
- `2026-02-22`：完成 `P3-seq6`（`audio_play/menu_login`）迁移闭环，已补齐“登录入口显隐（`loginUrl` 非空）+ 登录触发路径”同义证据；队列推进到下一项 `seq8(menu_edit_source)`。
- `2026-02-22`：完成 `P3-seq5`（`audio_play/menu_change_source`）迁移闭环，已补齐“朗读长按播放菜单 + 换源入口触发 + 整书换源链路复用”的同义证据；队列推进到下一项 `seq6(menu_login)`。
- `2026-02-22`：完成 `P2-seq348`（`menu_search`）迁移闭环，已补齐“单一搜索控件内提交动作 + 占位文案收敛 + 输入变更停止搜索边界”的同义证据；队列推进到下一项 `seq5(menu_change_source)`。
- `2026-02-22`：完成 `P3-seq84`（`menu_effective_replaces`）迁移闭环，已补齐“当前章节命中规则弹层 + 简繁转换同层级入口 + 编辑后统一重载当前章节”的同义证据；队列推进到下一项 `seq348(menu_search)`。
- `2026-02-22`：完成 `P3-seq82`（`menu_image_style`）迁移闭环，已补齐“图片样式四档书籍级持久化 + `SINGLE` 仅当前书籍强制覆盖翻页 + 切换后即时重载正文”的同义证据；队列推进到下一项 `seq84(menu_effective_replaces)`。
- `2026-02-22`：完成 `P3-seq81`（`menu_del_h_tag`）迁移闭环，已补齐“文案收敛、`h1~h6` 整段节点内容清理、全量清缓存后重载当前章节”的同义证据；队列推进到下一项 `seq82(menu_image_style)`。
- `2026-02-22`：完成 `P3-seq80`（`menu_del_ruby_tag`）迁移闭环，已补齐“文案收敛、`rt/rp` 清理边界、全量清缓存后重载当前章节”的同义证据；队列推进到下一项 `seq81(menu_del_h_tag)`。
- `2026-02-22`：完成 `P3-seq79`（`menu_enable_review`）迁移闭环，已补齐“隐藏入口结构保留 + 默认不展示 + 默认不可触发”的同义证据；队列推进到下一项 `seq80(menu_del_ruby_tag)`。
- `2026-02-22`：完成 `P3-seq78`（`menu_re_segment`）迁移闭环，已补齐“固定 checkable 文案 + 书籍级开关持久化 + 重载前保存进度避免位点漂移 + 无扩展提示”的同义证据；队列推进到下一项 `seq79(menu_enable_review)`。
- `2026-02-22`：完成 `P3-seq77`（`menu_same_title_removed`）迁移闭环，已补齐“文案收敛 + 勾选态按实际移除结果 + `!sameTitleRemoved` 翻转语义 + 提示边界收敛”的同义证据；队列推进到下一项 `seq78(menu_re_segment)`。
- `2026-02-22`：完成 `P3-seq76`（`menu_enable_replace`）迁移闭环，已补齐“替换净化文案收敛 + 去除扩展 toast + 点击即切换并刷新正文”的同义证据；队列推进到下一项 `seq77(menu_same_title_removed)`。
- `2026-02-22`：完成 `P3-seq75`（`menu_simulated_reading`）迁移闭环，已补齐“配置弹窗落盘 + 可读章节上限收敛 + `Period.days + 1` 口径对齐”的同义证据；队列推进到下一项 `seq76(menu_enable_replace)`。
- `2026-02-22`：完成 `P3-seq74`（`menu_reverse_content`）迁移闭环，已补齐“字符级倒序、仅缓存正文、缺失静默返回”的同义证据；队列推进到下一项 `seq75(menu_simulated_reading)`。
- `2026-02-22`：完成 `P3-seq73`（`menu_cover_progress`）迁移闭环，已补齐“静默守卫、成功文案收敛、失败日志+提示”的同义证据；队列推进到下一项 `seq74(menu_reverse_content)`。
- `2026-02-22`：完成 `P3-seq72`（`menu_get_progress`）迁移闭环，已补齐“静默同步、落后确认、越界不覆盖、失败仅日志”的同义证据；队列推进到下一项 `seq73(menu_cover_progress)`。
- `2026-02-22`：完成 `P3-seq71`（`menu_page_anim`）迁移闭环，已补齐“本书级翻页动画覆盖 + 样式面板改全局时清覆盖”的同义证据；队列推进到下一项 `seq72(menu_get_progress)`。
- `2026-02-22`：完成 `P3-seq70`（`menu_edit_content`）迁移闭环，已补齐正文抓取失败的可观测兜底（日志 + 回退 + 提示）以及编辑页重置期间全屏加载锁定；队列推进到下一项 `seq71(menu_page_anim)`。
- `2026-02-22`：完成 `P3-seq69`（`menu_add_bookmark`）迁移闭环，阅读菜单与九宫格动作均收敛为“弹窗确认后新增”同义语义，并补齐目录书签按 `chapterPos` 恢复进度；队列推进到下一项 `seq70(menu_edit_content)`。
- `2026-02-21`：完成 P1（主入口与导航）`21/21` 项逐项迁移与验收，全部为 `done`，无 `blocked` 项；阶段内所有入口均补齐了可复现验证证据。
- `2026-02-22`：完成 `P3-seq95`（`menu_refresh_after`）迁移闭环，已补齐差异清单、逐项对照与可复现验证证据；队列推进到下一项 `seq96(menu_refresh_all)`。
- `2026-02-22`：完成 `P3-seq96`（`menu_refresh_all`）迁移闭环，已补齐“首章起全量清缓存 + 无书源回落当前章节重载”的独立验证证据；队列推进到下一项 `seq97(menu_login)`。
- `2026-02-22`：完成 `P3-seq97`（`menu_login`）迁移闭环，已补齐“按 `bookSourceUrl` 回查当前书源后触发登录”的实时状态边界证据；队列推进到下一项 `seq98(menu_chapter_pay)`。
- `2026-02-22`：完成 `P3-seq98`（`menu_chapter_pay`）迁移闭环，已补齐“显隐条件、`isTrue` 判定与异常日志可观测”的同义证据；队列推进到下一项 `seq99(menu_edit_source)`。
- `2026-02-22`：完成 `P3-seq99`（`menu_edit_source`）迁移闭环，已补齐“按 `bookSourceUrl` 实时回查再编辑 + 仅保存返回刷新”的同义证据；队列推进到下一项 `seq100(menu_disable_source)`。
- `2026-02-22`：完成 `P3-seq100`（`menu_disable_source`）迁移闭环，已补齐“点击即禁用、无确认弹窗/无成功提示 + 按 `bookSourceUrl` 回查防止快照重建”的同义证据；队列推进到下一项 `seq164(menu_split_long_chapter)`。
- `2026-02-22`：完成 `P2-seq164`（`menu_split_long_chapter`）迁移闭环，已补齐目录页 `checkable` 入口、仅本地 TXT 显示与切换后即时重建目录的同义证据；队列推进到下一项 `seq166(menu_use_replace)`。
- `2026-02-22`：完成 `P2-seq166`（`menu_use_replace`）迁移闭环，已补齐目录页“使用替换”checkable 入口、全局持久化与目录标题即时重算的同义证据；队列推进到下一项 `seq167(menu_load_word_count)`。
- `2026-02-22`：完成 `P2-seq167`（`menu_load_word_count`）迁移闭环，已补齐目录页“加载字数”checkable 入口、全局持久化默认值与目录即时刷新链路，并在已缓存章节上补齐字数显隐（`xx字/xx万字`）证据；队列推进到下一项 `seq69(menu_add_bookmark)`。
